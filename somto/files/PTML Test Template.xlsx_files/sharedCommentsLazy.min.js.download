(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[37],{2171:function(e,t,n){"use strict";n.r(t),n.d(t,"ExtensionAwareCommentPane",(function(){return $t}));var r=n(1),o=n.n(r),i=n(150),a=n(185),s=a.useSelector,l=n(454),c=n(112),p=n(95),u=n(97),d=n(35),f=n(23),h=n(388),m=n(64),y=n(760),b=n(3),g=n(9),v=n(1569),C=n(333),T=n(8),O=n(691),x=n(1388),S=n(397),k=n(1020),P=n(789),E=n(1581),j=n(92),I=n(401),w=n(260),A=n(1212),R=n(76),D=n(193),_=n(248),N=n(2116),M=n(348),B=n(239),L=n(2979),F=function(){function e(){this.valueStruct={hasValue:!1},this.callbacks=[]}return e.prototype.set=function(e){this.valueStruct={value:e,hasValue:!0},this.callbacks.forEach((function(t){t(e)})),this.callbacks=[]},e.prototype.getValue=function(e){var t=this;if(this.valueStruct.hasValue)try{return Promise.resolve(e(this.valueStruct.value))}catch(e){return Promise.reject(e)}return new Promise((function(n,r){t.callbacks.push((function(t){try{n(e(t))}catch(e){r(e)}}))}))},e}(),H=n(2464),U=n(427),z=n(162),K=n(250),V=n(1116),W=n(138),q=n(90),Q=n(1272),G=n(47),Y=n(86),J=n(648),$=n(24),X=n(647),Z=n(87),ee=n(340),te=n(2687),ne=n(2600),re=n(504),oe=n(275),ie=n(42),ae=n(535),se=n(1209),le=n(313),ce=n(1273),pe=n(1274),ue=n(2631),de=n(136),fe=n(505),he=n(2575),me=n(2657),ye=n(154),be=n(130),ge=n(2658);function ve(e){if(e.topVisibleThread&&e.componentTree.componentTreeId.renderContextType!==ie.a.HalfPane&&!e.selectedComment)return e.topVisibleThread.cardId}var Ce=function(e){function t(n){var r,o,i,a,s=e.call(this,n)||this;s.memoGetActionBarItems=Object(L.a)(ge.a,20,(function(){Object(T.k)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875362)})),s.memoGetCardContextualMenuItems=Object(L.a)(ge.c,20,(function(){Object(T.k)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875363)})),s.initialAtMentionCapability=new F,s.onCommentInterruptableCommand=function(e){switch(e.type){case"DiscardDraft":var t=void 0;if(e.mode===V.a.Dialog){var n=Object(ce.a)(s.props.draftState,s.props.componentTree.componentTreeId.renderContextType);t=s.getOnWillDiscardCallback(n);var r=Object(fe.b)(!0,s.props.componentTree.componentTreeId.renderContextType,s.props.draftState,s.props.selectedComment,s.props.selectedThreadIdBeforeCommentSession);return s.props.discardDraftAsync({renderContextType:s.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:s.props.telemetryVisitor,trackback:g.d.reserveTag(587605836)},Y.a.Canvas,r,t)}return Promise.resolve(D.a.Unhandled);case"BringThreadIntoView":return s.props.componentTree.componentTreeId.renderContextType!==ie.a.FullPane?Promise.resolve(D.a.Unhandled):s.scrollToThreadById(e.threadId)?Promise.resolve(D.a.Handled):Promise.resolve(D.a.Failed);default:return Object(T.k)().assertConditionTag(!1,"Unknown type of CommentInterruptableCommand",593826210),Promise.resolve(D.a.Unhandled)}},s.onCardPost=function(e,n){var r=e.getId(),o=t.getPaneSingleCreateDraftId(s.props)===e.getId()?{type:"CREATE"}:{type:"REPLY",parentId:r};le.c({trackback:g.d.reserveTag(593622435),commentCardRef:e,draftState:s.props.draftState,areMentionsEnabled:s.props.modelCapabilities.atMention===R.b.Enabled,session:o,componentTree:s.props.componentTree,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,commitSource:n}).catch(Object(q.a)(g.d.reserveTag(593622464)))},s.cardOnCollapseCallback=function(e){le.b({trackback:g.d.reserveTag(562918286),commentCardRef:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnSelectCallback=function(e){le.n({trackback:g.d.reserveTag(571281794),commentCardRef:e,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,options:{selectActionType:G.SelectActionType.SelectCard}})},s.cardOnSelectExpandCallback=function(e,t,n){var r=Object(se.a)(e.getId(),s.props.componentTree.componentTreeId.renderContextType,s.props.draftState);le.n({trackback:g.d.reserveTag(571281793),commentCardRef:e,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,options:{selectActionType:G.SelectActionType.ExpandCard,relativeDraftingState:r,draftState:s.props.draftState,shouldFocusAfter:n,selectRootPost:t}})},s.cardOnFocusCallback=function(e){le.i({trackback:g.d.reserveTag(571340119),commentCardRef:e,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,options:{selectActionType:G.SelectActionType.Polite},focusManager:s.props.focusManager,isDraftThread:t.getPaneSingleCreateDraftId(s.props)===e.getId()})},s.cardOnBeginReplyCallback=function(e){le.a({trackback:g.d.reserveTag(593826249),threadId:e.getId(),renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnResolveThread=function(e){le.m({componentTree:s.props.componentTree,focusManager:s.props.focusManager,trackback:g.d.reserveTag(593826250),id:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,isTask:!!s.props.tasks[e]})},s.cardOnReopenThread=function(e){le.l({trackback:g.d.reserveTag(593826251),id:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,isTask:!!s.props.tasks[e]})},s.cardOnDelete=function(e){le.d({trackback:g.d.reserveTag(593826252),id:e,data:s.props.dataItems,selectedComment:s.props.selectedComment,componentTree:s.props.componentTree,invokeModalDialog:s.invokeModalDialog,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,focusManager:s.props.focusManager,isTask:!!s.props.tasks[e],threadIndex:be.f(s.state.allRenderableItemThreads,e),shouldCheckForLowFidelity:s.shouldCheckForLowFidelityOnCardDelete()})},s.cardOnDraftingInputSizeChange=function(e,n){var r=t.getPaneSingleCreateDraftId(s.props);le.f({trackback:g.d.reserveTag(593826253),focusManager:s.props.focusManager,componentTree:s.props.componentTree,cardId:e.getId(),isCardLie:e.getId()===r,newHeight:n,renderContextType:s.props.componentTree.componentTreeId.renderContextType,selectedComment:s.props.selectedComment,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnDraftEmptinessChanged=function(e,t){le.q({trackback:g.d.reserveTag(592213848),contentId:e.getId(),isEmpty:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.cardIdToDraftIdMap,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnEditorFocusLost=function(e){le.g({trackback:g.d.reserveTag(592065735),id:e.getId(),draftState:s.props.draftState,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.cardOnSaveDraft=function(e,t){le.x({trackback:g.d.reserveTag(593826255),id:e,editor:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.cardIdToDraftIdMap,draftMap:s.props.draftState.drafts,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onCardCancel=function(e){var t=Object(fe.b)(!0,s.props.componentTree.componentTreeId.renderContextType,s.props.draftState,s.props.selectedComment,s.props.selectedThreadIdBeforeCommentSession);le.e({trackback:g.d.reserveTag(592840780),showDiscardDialog:!1,invokeModalDialog:s.invokeModalDialog,componentTree:s.props.componentTree,dispatchProps:s.props,closeOnDiscard:t,cardId:e.getId(),draftState:s.props.draftState,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,focusManager:s.props.focusManager,lieIndex:be.f(s.state.allRenderableItemThreads,e.getId())})},s.onTaskTopperCheckboxPressed=function(e){var t=s.props.tasks[e];t&&le.o({componentTree:s.props.componentTree,focusManager:s.props.focusManager,trackback:g.d.reserveTag(593826258),id:t.commentId,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI})},s.cardOnHighlight=function(e,t){le.j({trackback:g.d.reserveTag(593826259),commentCardRef:e,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,shouldHighlightCard:t})},s.onPostDelete=function(e){le.D({trackback:g.d.reserveTag(593826312),id:e,data:s.props.dataItems,selectedComment:s.props.selectedComment,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI})},s.onPostEdit=function(e){le.E({trackback:g.d.reserveTag(593826316),id:e,data:s.props.dataItems,selectedComment:s.props.selectedComment,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onPostReactionUpdated=function(e,t,n){le.w(g.d.reserveTag(587994051),e,t,s.props.componentTree.componentTreeId.renderContextType,s.props,s.props.telemetryVisitor,n)},s.onPostCommit=function(e,t){le.C({trackback:g.d.reserveTag(593826260),id:e.getId(),data:s.props.dataItems,draftState:s.props.draftState,contentPromise:e.getContentsAsync(),atMentionsEnabled:s.props.modelCapabilities.atMention===R.b.Enabled,componentTree:s.props.componentTree,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI,commitSource:t}).catch(Object(q.a)(g.d.reserveTag(593826261)))},s.onPostCancel=function(e){var t=Object(fe.b)(!0,s.props.componentTree.componentTreeId.renderContextType,s.props.draftState,s.props.selectedComment,s.props.selectedThreadIdBeforeCommentSession);le.z({trackback:g.d.reserveTag(593826263),commentId:e.getId(),setContents:e.setContents.bind(e),data:s.props.dataItems,draftState:s.props.draftState,shouldClosePaneAfterDiscardDraft:t,onWillDiscardCallback:void 0,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,localizationAPI:s.props.localizationAPI})},s.onPostDraftEmptinessChanged=function(e,t){le.q({trackback:g.d.reserveTag(592041678),contentId:e.getId(),isEmpty:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.postIdToDraftIdMap,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onPostSaveDraft=function(e,t){le.x({trackback:g.d.reserveTag(592720405),id:e,editor:t,renderContextType:s.props.componentTree.componentTreeId.renderContextType,draftIdMap:s.props.draftState.postIdToDraftIdMap,draftMap:s.props.draftState.drafts,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onPresentLinkToComment=function(e){le.v(g.d.reserveTag(578852484),e,s.props.componentTree.componentTreeId.renderContextType,s.props,s.props.telemetryVisitor)},s.onRenderableItemSelect=function(e,t){var n=s.getRenderableItemFromRef(e);n?le.J({trackback:g.d.reserveTag(593826266),renderableItem:n,selectedComment:s.props.selectedComment,cardCollapsedState:Object(ae.a)(be.i(n),s.props.expandedComments,s.props.componentTree.componentTreeId.renderContextType),dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,componentTree:s.props.componentTree,shouldFocusAfter:t,draftState_deprecated:s.props.draftState}).catch(Object(q.a)(g.d.reserveTag(590123737))):Object(T.k)().assertConditionTag(!1,"Selection coming from an unknown post?",593826265)},s.onPostCollapseParent=function(e){var t=s.getRenderableItemFromRef(e);t?le.B(g.d.reserveTag(589940445),t,s.props,s.props.telemetryVisitor,s.props.componentTree):Object(T.k)().assertConditionTag(!1,"Collapse from an unknown post?",589940444)},s.onPostFocusParent=function(e){var t=s.getRenderableItemFromRef(e);t?le.H(t,s.props.componentTree,s.props.focusManager,s.props.draftState):Object(T.k)().assertConditionTag(!1,"Focus parent from unknown post?",545867681)},s.getContentFilterProps=function(){var e;return{currentFilter:null!==(e=s.props.currentFilter)&&void 0!==e?e:X.a,createOrUpdateFilter:s.props.createOrUpdateFilter,preventDefaultKeyDownBehavior:s.getContentsPreventDefaultKeyDownBehavior(),personaIconPropertiesMap:s.props.personaIconPropertiesMap,localizationAPI:s.props.localizationAPI,filterItemCount:d.K()?s.props.filterItemCount:void 0,collaborators:s.props.collaborators}},s.getThreadedRenderableIds=Object(v.b)((function(e){return e.map((function(e){return e.map(be.e)}))}),(function(){return[s.state.allRenderableItemThreads]})),s.getThreadPostOrHistoryRecordStates=(r=[],o={},i=[],a=function(e,t,n){if(void 0===n&&(n=function(e,t,n){return n[t]}),e===r&&t===o)return i;var a=e.map((function(e,a){return e===r[a]&&e.every((function(r){return n(e[0],r,t)===n(e[0],r,o)}))?i[a]:e.map((function(r){return n(e[0],r,t)}))}));return r=e,o=t,i=a,a},function(){return a(s.getThreadedRenderableIds(),Object(b.__assign)(Object(b.__assign)({},s.props.postViewStates),s.props.historyRecordViewStates))}),s.getListItemKey=function(e){var t=be.h(e).commentId,n=s.props.cardViewStates[t];return n&&n.alternateId||t},s.getHostableComponentInstanceId=function(e,t,n){return"cardInPane_".concat(Object(de.i)({id:e,renderContextType:t},n))},s.onSelectedTaskAssigneeUpdated=function(e){le.y({trackback:g.d.reserveTag(593826304),renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor,selectedAssignee:e})},s.getRenderableItemActionBarItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!s.renderableItemActionBarItems||void 0===s.memoGetActionBarItems)throw new g.c("Function should not be called when DeleteRestricted gate is off.",g.d.reserveTag(557601691));return s.memoGetActionBarItems.apply(s,Object(b.__spreadArray)([s.renderableItemActionBarItems],Object(b.__read)(e),!1))},s.getCardContextualMenuItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!s.cardContextMenuItems||void 0===s.memoGetCardContextualMenuItems)throw new g.c("Function should not be called when DeleteRestricted gate is off.",g.d.reserveTag(557601692));return s.memoGetCardContextualMenuItems.apply(s,Object(b.__spreadArray)([s.cardContextMenuItems],Object(b.__read)(e),!1))},s.onCardMounted=function(e){le.k({cardProps:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.onCardEditorMounted=function(e){le.h({cardId:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.onPostMounted=function(e){le.I({postId:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.onPostEditorMounted=function(e){le.F({postId:e,componentTree:s.props.componentTree,focusManager:s.props.focusManager})},s.notifyRenderedOnce=Object(H.a)((function(){s.props.onInitialRender({renderContextType:s.props.componentTree.componentTreeId.renderContextType})})),s.onPostError=function(e){le.G({trackback:g.d.reserveTag(593764372),id:e.getId(),data:s.props.dataItems,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onClearPostError=function(e){le.A({trackback:g.d.reserveTag(593764373),id:e.getId(),data:s.props.dataItems,renderContextType:s.props.componentTree.componentTreeId.renderContextType,actionDispatchers:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onLowFidelityWarningCancel=function(){le.r({selectedState:s.props.selectedComment,renderContextType:s.props.componentTree.componentTreeId.renderContextType,dispatchProps:s.props,telemetryVisitor:s.props.telemetryVisitor})},s.onLowFidelityWarningConfirm=function(){le.s({selectedState:s.props.selectedComment,onCardDelete:s.cardOnDelete,onPostDelete:s.onPostDelete,onPostEdit:s.onPostEdit})},s.commentEditorOnKeyDown=function(e){s.commentEditorKeyDownHandler.onKeyDown(e)},s.startNewCommentSession=function(){s.props.discardDraftAndStartNewCommentSession({renderContextType:s.props.componentTree.componentTreeId.renderContextType,trackback:g.d.reserveTag(593826323),telemetryVisitor:s.props.telemetryVisitor})},s.closePane=s.closePane.bind(s),s.onCommentUIAction=s.onCommentUIAction.bind(s),s.onMentionCreated=s.onMentionCreated.bind(s),s.onMentioneesStillInDraftUpdated=s.onMentioneesStillInDraftUpdated.bind(s),s.renderCommentThread=s.renderCommentThread.bind(s),s.onGhostCommentClicked=s.onGhostCommentClicked.bind(s),s.invokeModalDialog=s.invokeModalDialog.bind(s),s.deleteThreadConfirmCallback=s.deleteThreadConfirmCallback.bind(s),s.getOnWillDiscardCallback=s.getOnWillDiscardCallback.bind(s),s.isReadyToRender=s.isReadyToRender.bind(s),s.commentPostCallbackProps={onDelete:s.onPostDelete,onEdit:s.onPostEdit,onCommit:s.onPostCommit,onCancel:s.onPostCancel,onSelect:s.onRenderableItemSelect,onDraftEmptinessChanged:s.onPostDraftEmptinessChanged,onSaveDraft:s.onPostSaveDraft,onLowFidelityWarningConfirm:s.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:s.onLowFidelityWarningCancel,onPostMounted:s.onPostMounted,onPostEditorMounted:s.onPostEditorMounted,onError:s.onPostError,onClearError:s.onClearPostError,commentEditorAdditionalKeyDownHandler:s.commentEditorOnKeyDown,onCollapseParent:s.onPostCollapseParent,onFocusParent:s.onPostFocusParent,onReactionUpdated:s.onPostReactionUpdated,onPresentLinkToComment:s.onPresentLinkToComment,onClickableTextClicked:s.props.onClickableTextClicked},s.commentCardCallbackProps={onEditorPress:s.cardOnBeginReplyCallback,onCardCollapse:s.cardOnCollapseCallback,onCardSelect:s.cardOnSelectCallback,onCardSelectExpand:s.cardOnSelectExpandCallback,onCardFocus:s.cardOnFocusCallback,onCardHighlightChange:s.cardOnHighlight,onDraftingInputSizeChange:s.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:s.cardOnDraftEmptinessChanged,onEditorBlur:s.cardOnEditorFocusLost,onCancel:s.onCardCancel,onPost:s.onCardPost,onSaveDraft:s.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:s.onSelectedTaskAssigneeUpdated,onCardMounted:s.onCardMounted,onCardEditorMounted:s.onCardEditorMounted,onCardRendered:s.notifyRenderedOnce,onLowFidelityWarningCancel:s.onLowFidelityWarningCancel,onLowFidelityWarningConfirm:s.onLowFidelityWarningConfirm,onTaskTopperCheckboxPressed:s.onTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:s.commentEditorOnKeyDown,onReactionUpdated:s.onPostReactionUpdated,onEditRootPost:s.onPostEdit},s.cardContextualMenuCallbackProps={onReopenThread:s.cardOnReopenThread,onResolveThread:s.cardOnResolveThread,onDeleteThread:s.cardOnDelete,onEditRootPost:s.onPostEdit,onPresentLinkToComment:s.onPresentLinkToComment},s.renderableItemActionBarItems=ge.d(s.props.localizationAPI,s.commentPostCallbackProps),s.cardContextMenuItems=ge.b(s.props.localizationAPI,s.cardContextualMenuCallbackProps),s.paneContainerKeyDownHandler=s.props.focusManager.paneContainerKeyDown((function(){return s.props.componentTree})),s.commentContentsKeyDownHandler=s.props.focusManager.commentContentsKeyDown((function(){return s.props.componentTree}),(function(){return s.props.dataItems})),s.commentEditorKeyDownHandler=s.props.focusManager.commentEditorKeyDown((function(){return s.props.componentTree}));var l=Object(T.k)().createActivityObject("BaseCommentPaneConstruction",s.props.telemetryVisitor,Object(T.j)());return l.addDataField("PaneCorrelationId",s.props.correlationId,T.d.SystemMetadata),g.a||l.addDataField("SharedCommentsVersion",Q.a,T.d.SystemMetadata),l.addDataField("RenderContextType",s.props.componentTree.componentTreeId.renderContextType,T.d.SystemMetadata),l.successTag(593826206),s}return Object(b.__extends)(t,e),t.prototype.onCommentUIAction=function(e){return e.actionType===K.a.BackKeyPressed?(Object(T.k)().assertConditionTag(Object(W.d)(e.actionBehavior),"This action type does not support toggled/enabled status",593826207),Object(W.d)(e.actionBehavior)&&this.onBackKeyPressed(),W.a.Success):W.a.NotHandled},t.prototype.getOnWillDiscardCallback=function(e){var t=this;return Object($.n)(this.props.draftState)===oe.a.CannotAutoDiscard?function(n,r){return t.invokeModalDialog(e,n,r)}:void 0},t.prototype.updateDraftRenderLocks=function(e){0!==Object(Z.e)(this.props.draftState)&&this.props.updateRenderLocksForAllDrafts({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:g.d.reserveTag(593826211),telemetryVisitor:this.props.telemetryVisitor},e)},t.prototype.componentDidMount=function(){var e,t;null===(t=(e=this.props).componentRef)||void 0===t||t.call(e,this),this.props.registerComponentUIActionListener(this.onCommentUIAction),this.props.registerComponentInterruptableCommandListener(this.onCommentInterruptableCommand),this.props.modelCapabilities.atMention!==R.b.Unknown&&this.processAtMentionCapabilityState(),this.updateDraftRenderLocks(!0),d.s()&&this.props.lastContextChangeIncrement>0&&this.onContextChanged()},t.prototype.componentWillUnmount=function(){this.props.unregisterComponentUIActionListener(this.onCommentUIAction),this.props.unregisterComponentInterruptableCommandListener(this.onCommentInterruptableCommand)},t.prototype.componentDidUpdate=function(e,t){var n,r;if(this.props.lastContextChangeIncrement!==e.lastContextChangeIncrement&&this.onContextChanged(),this.props.modelCapabilities.atMention!==e.modelCapabilities.atMention&&this.processAtMentionCapabilityState(),this.sendReadyToRenderNotification(e),this.props.draftState!==e.draftState)try{for(var o=Object(b.__values)(Object(Z.f)(this.props.draftState)),i=o.next();!i.done;i=o.next()){var a=i.value;if(this.props.draftState.drafts[a].renderContextType!==this.props.componentTree.componentTreeId.renderContextType&&(void 0===e.draftState.drafts[a]||e.draftState.drafts[a].renderContextType!==this.props.draftState.drafts[a].renderContextType)){this.updateDraftRenderLocks(!0);break}}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}this.props.focusManager.commentPanePropsUpdated(this.props.componentTree,e,this.props)},t.prototype.focus=function(){this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},t.prototype.getInstanceId=function(){var e;return null!==(e=this.props.componentInstanceId)&&void 0!==e?e:"CommentPane"},t.prototype.getRenderableItemFromRef=function(e){var n=e.getId();return d.T()?this.props.dataItems.find((function(e){return be.e(e)===n})):n===t.getPaneSingleCreateDraftId(this.props)?this.props.createdCommentLie&&{commentModel:this.props.createdCommentLie.newComment_deprecated}:this.props.dataItems.find((function(e){return be.e(e)===n}))},t.prototype.closePane=function(){le.p({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.renderCommentThread=function(e,n,o){var i,a;void 0===o&&(o=ue.e);var s=be.h(n),l=s.commentId===t.getPaneSingleCreateDraftId(this.props);if(d.Q())return r.createElement(te.a,{commentAPI:this.props.commentAPI,componentTree:this.props.componentTree,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:{id:s.commentId},getDiscardDraftCallback:this.getOnWillDiscardCallback,telemetryVisitor:this.props.telemetryVisitor,accessibilityPositionInSet:e+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,onInitialRender:this.props.onInitialRender,correlationId:this.props.correlationId,lppManager:this.props.lppManager,componentInstanceId:this.getHostableComponentInstanceId(s.commentId,this.props.componentTree.componentTreeId.renderContextType,l)});var c=d.U()?this.state.allRenderableItemThreads.length>0&&be.h(this.state.allRenderableItemThreads[0]).commentId===s.commentId:0===this.props.dataItems.length||be.h(this.props.dataItems).commentId===s.commentId,p=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.suggestionsDetails),u=s.commentId,f=Object(Z.d)(this.props.draftState),h=f||this.props.readOnly?ne.a.None:ne.a.Any,m=null===(i=this.props.tasks[u])||void 0===i?void 0:i.currentState,y=this.props.componentTree.componentTreeId.renderContextType===ie.a.HalfPane&&!!Object($.J)(this.props.draftState),b=this.props.highlightedCommentId||ve(this.props),g=this.getPinnedCardIndex_deprecated(),v=this.getThreadPostOrHistoryRecordStates()[g&&!d.z()?g:e],C=(null===(a=this.props.selectedComment)||void 0===a?void 0:a.selectedCardId)===u?this.props.selectedComment:void 0,T=Object(ae.a)(s.commentId,this.props.expandedComments,this.props.componentTree.componentTreeId.renderContextType);return o({thread:n,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardViewStates[u],postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:p,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:C,isolationEdit:y,isAtMentionEnabled:!!p,isTaskCreationEnabled:Object($.c)(this.props.modelCapabilities),isDraftThread:l,foldableLayoutState:this.props.foldableLayoutState,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:T,cardRelativeDraftingState:Object(se.a)(s.commentId,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState),accessibilityPositionInSet:e+1,accessibilitySetSize:this.state.allRenderableItemThreads.length,maximumDimensions:void 0,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:p,availableScreenHeight:this.getAvailableScreenHeight(),extraPaddingLeft:this.getContentExtraPaddingLeft(),extraPaddingRight:this.getContentExtraPaddingRight(),preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:b===u,contentBackgroundColor:this.getContentBackgroundColor(n.length>1,y),maxDraftHeight:this.getMaxDraftHeight(),restrictActionControls_deprecated:f,allowedDraftingSession:h,taskState:m,cardStyle:this.getCommentCardStyle(),onCardLayout:this.onCardLayout,isCardTabbable:ue.b(this.getKeyboardingOptions().cardTabbingMode,u,c,T,d.L()?this.props.renderableSelectedComment:this.props.selectedComment),postOrHistoryRecordStates:v,richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:U.b.Unspecified})},t.prototype.onMentionCreated=function(e){le.t({failTag:g.d.reserveTag(593826271),successTag:g.d.reserveTag(593826272),person:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:g.d.reserveTag(593826273)})},t.prototype.onMentioneesStillInDraftUpdated=function(e){le.u({trackback:g.d.reserveTag(593826275),emailsStillInDraft:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.onBackKeyPressed=function(){if(Object(Z.c)(this.props.draftState)){var e=Object(ce.a)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),t=Object(fe.b)(!0,this.props.componentTree.componentTreeId.renderContextType,this.props.draftState,this.props.selectedComment,this.props.selectedThreadIdBeforeCommentSession),n=Object($.I)(this.props.draftState),r=Object($.J)(this.props.draftState);if(n){var o=Object($.n)(this.props.draftState)===oe.a.CannotAutoDiscard;le.e({trackback:g.d.reserveTag(592840781),showDiscardDialog:o,invokeModalDialog:this.invokeModalDialog,componentTree:this.props.componentTree,dispatchProps:this.props,closeOnDiscard:t,cardId:n,draftState:this.props.draftState,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI,focusManager:this.props.focusManager,lieIndex:be.f(this.state.allRenderableItemThreads,n)})}else r&&le.z({trackback:g.d.reserveTag(592487364),commentId:r,setContents:void 0,data:this.props.dataItems,draftState:this.props.draftState,shouldClosePaneAfterDiscardDraft:t,onWillDiscardCallback:this.getOnWillDiscardCallback(e),renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,localizationAPI:this.props.localizationAPI})}else this.props.componentTree.componentTreeId.renderContextType===ie.a.HalfPane&&le.p({ownProps:this.props,dispatchProps:this.props,componentTree:this.props.componentTree,draftState:this.props.draftState,invokeModalDialog:this.invokeModalDialog})},t.prototype.sendReadyToRenderNotification=function(e){this.props.initializationStatus===re.a.Initialized&&(this.props.componentTree.componentTreeId.renderContextType===e.componentTree.componentTreeId.renderContextType&&this.props.initializationStatus===e.initializationStatus||this.props.readyToRender({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:g.d.reserveTag(593826313)}))},t.prototype.deleteThreadConfirmCallback=function(){return this.props.selectedComment?(this.props.requestDeleteThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:g.d.reserveTag(593826314)},this.props.selectedComment.selectedCardId),D.a.Handled):(Object(T.k)().assertConditionTag(!1,"Selected Comment should not be undefined for DeleteThread",593826315),D.a.Unhandled)},t.prototype.processAtMentionCapabilityState=function(){var e=this.props.modelCapabilities.atMention;e!==R.b.Unknown&&this.initialAtMentionCapability.set(e)},t.getPaneSingleCreateDraftId=function(e){return Object($.G)(e.draftState,!0,e.componentTree.componentTreeId.renderContextType)},t.prototype.getUpdatedItemThreads=function(e){if(!this.isReadyToRenderWithProps(e))return[];var t=!!this.props.currentFilter||Object(pe.a)(this.props.draftState,this.props.componentTree.componentTreeId.renderContextType),n=!!e.currentFilter||Object(pe.a)(e.draftState,e.componentTree.componentTreeId.renderContextType);return this.props.dataItems===e.dataItems&&this.props.cardViewStates===e.cardViewStates&&this.props.componentTree.componentTreeId.renderContextType===e.componentTree.componentTreeId.renderContextType&&this.props.personaIconPropertiesMap===e.personaIconPropertiesMap&&(d.T()||this.props.createdCommentLie===e.createdCommentLie&&t===n)?this.state.allRenderableItemThreads:be.c(e.dataItems,e.cardViewStates,e.createdCommentLie,e.componentTree.componentTreeId.renderContextType!==ie.a.HalfPane,n)},t.prototype.getInitialState=function(e){var t=!!e.currentFilter||Object(pe.a)(e.draftState,e.componentTree.componentTreeId.renderContextType);return{allRenderableItemThreads:this.isReadyToRenderWithProps(e)?be.c(e.dataItems,e.cardViewStates,e.createdCommentLie,e.componentTree.componentTreeId.renderContextType!==ie.a.HalfPane,t):[],atMentionState:void 0}},t.prototype.onRequestLoadThreads=function(e){this.props.modelCapabilities.virtualized?this.props.queueLoadThreads({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:g.d.reserveTag(593826320)},e):Object(T.k)().assertConditionTag(!1,"onRequestLoadThreads called for non-virtualized store",593826321)},t.prototype.shouldShowGhostComment=function(){return this.props.componentTree.componentTreeId.renderContextType===ie.a.FullPane&&this.props.nextPopulatedContextDetails!==_.a.Unknown&&this.props.nextPopulatedContextDetails!==_.a.NoComments&&this.props.nextPopulatedContextDetails!==_.a.OnlyCommentsInCurrent},t.prototype.onGhostCommentClicked=function(){var e=this,t=d.q(),n=t&&!d.U()||!t&&"web"!==Object(ye.a)();this.props.discardDraftIfEmpty({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:g.d.reserveTag(590955266)},Y.a.SharedComments,n?ee.a.GhostCard:void 0).then((function(t){n&&t.draftDiscardBehavior!==oe.a.NoDraft&&t.draftDiscardResult!==D.a.Handled||e.props.selectionManager.selectAcrossContexts(z.d.Next,e.props.componentTree.componentTreeId.renderContextType)})).catch(Object(q.a)(g.d.reserveTag(590955267)))},t.prototype.isReadyToRender=function(){return this.isReadyToRenderWithProps(this.props)},t.prototype.isReadyToRenderWithProps=function(e){return Object(J.a)(e.pendingCommentLoad,e.modelCapabilities.virtualized,e.DoNotUse_isFilteringEnabled)},t.prototype.canCardDelete=function(e){return!0},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.render=function(){return r.createElement(me.a.Provider,{value:this.props.lppManager},r.createElement(he.a.Provider,{value:this.props.componentTree.componentTreeId},this.renderInner()))},t}(r.Component),Te=n(5),Oe=n(17),xe=n(641),Se=n(67),ke=n(1036),Pe=n(246),Ee=Object(Te.eb)({height:"100%"}),je=Object(Oe.c)((function(e,t){var n;return Object(Te.eb)({fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',width:"".concat(t+32,"px"),display:"flex",flexDirection:"column",alignItems:"stretch",height:"100%",overflowX:"hidden",overflowY:"hidden",backgroundColor:d.G()?void 0:null!==(n=null==e?void 0:e.PaneBackground)&&void 0!==n?n:Se.a.GRAY_30,selectors:{":focus":{color:"#333333",outline:"thin dotted"}}})})),Ie=Object(Te.eb)({display:"flex",flexDirection:"column",flex:"1 1 auto",overflowY:"auto",overflowX:"hidden",justifyContent:"space-between",height:"100%",selectors:{":focus":{outline:"none"},"::-webkit-scrollbar-button:start:increment":{display:"none"},"::-webkit-scrollbar-button:end:decrement":{display:"none"}}}),we=Object(Te.eb)({display:"flex",flex:"1 0 auto",marginTop:"3px"}),Ae=Object(Te.eb)({padding:"16px",paddingLeft:"8px",height:"54px",boxSizing:"border-box",display:"flex",flexDirection:"row"}),Re=Object(Te.eb)({display:"flex",flex:2,flexDirection:"row",paddingLeft:"10px",height:"32px"}),De=function(e){return Object(Te.eb)({display:"flex",flexDirection:"row",width:e+11,marginTop:d.J()?"2px":void 0})};function _e(e){var t;return Object(Te.eb)({height:"22px",fontWeight:600,fontSize:"16px",fontFamily:"".concat(Pe.h,",").concat(Pe.g,",").concat(Pe.i,", Arial, Verdana, sans-serif"),color:null!==(t=null==e?void 0:e.NewCommentButtonLabel)&&void 0!==t?t:"#252423",display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",flexGrow:1,overflow:"hidden",margin:"0px !important"})}var Ne=function(e){var t,n,r,o;return{root:{padding:0,border:"1px solid transparent",margin:0,width:"22px",minWidth:"22px",height:"22px",alignContent:"center",marginLeft:"0px",selectors:{".ms-Fabric--isFocusVisible &:focus::after":Pe.m,".ms-Button-flexContainer":{position:"relative"}}},icon:{color:null!==(t=null==e?void 0:e.ClosePaneButtonIcon)&&void 0!==t?t:Se.a.GRAY_F,margin:0,width:"20px",height:"20px"},iconHovered:{color:null!==(n=null==e?void 0:e.ClosePaneButtonIconHovered)&&void 0!==n?n:Se.a.GRAY_J},iconPressed:{color:null!==(r=null==e?void 0:e.ClosePaneButtonIconPressed)&&void 0!==r?r:Se.a.GRAY_J},rootPressed:{backgroundColor:null==e?void 0:e.ClosePaneButtonPressed},rootHovered:Object(Te.eb)({backgroundColor:null==e?void 0:e.ClosePaneButtonHovered},Pe.l),rootFocused:Object(Te.eb)({color:null!==(o=null==e?void 0:e.ClosePaneButtonFocused)&&void 0!==o?o:"#333333",outline:"none",border:"1px solid"},Pe.k)}},Me=function(e){var t;return Object(Te.eb)({color:null!==(t=null==e?void 0:e.Text)&&void 0!==t?t:Se.a.ACTIVE_COMMENT_TEXT,fontWeight:"normal",fontFamily:"inherit",fontSize:"12px",outline:"none",border:"1px solid transparent",marginLeft:"16px",marginRight:"9px",marginTop:"8px",selectors:{":focus":{color:"#333333",outline:"none",border:"1px dotted"}}})},Be={selectors:{"& .ms-Spinner-circle":{borderColor:ke.a,borderTopColor:ke.b}}},Le=Object(v.c)({},(function(e,t){return{paneContainer:je(e,t),listContainer:Ie,commentList:we,paneHeader:Ae,paneTitle:_e(e),iconClosePane:Ne(e),emptyPaneMessage:Me(e),spinnerStyles:Be,focusTrapZone:Ee,topWrapper:De(t),filterRegion:Re}}),(function(){return[Object(xe.a)()]})),Fe=n(181),He=n(407),Ue=n(295),ze=n(2409),Ke=n(498),Ve=n(1393),We=n(27),qe=n(290),Qe=n(61),Ge=n(2057),Ye=n(1070);var Je=n(559);const $e=r.forwardRef((e,t)=>{const n=((e,t)=>{const n=Object(Ke.c)(e=>e.toggleCheckbox),{name:o,value:i}=e,a=Object(Ke.c)(e=>{var t;return-1!==((null===(t=e.checkedValues)||void 0===t?void 0:t[o])||[]).indexOf(i)});return{...Object(Ve.a)({role:"menuitemcheckbox",persistOnClick:!0,...e,"aria-checked":a,checkmark:Ue.a.optional(e.checkmark,{defaultProps:{children:r.createElement(ze.d,null)},renderByDefault:!0,elementType:"span"}),onClick:t=>{var r;null==n||n(t,o,i,a),null===(r=e.onClick)||void 0===r||r.call(e,t)}},t),name:o,value:i,checked:a}})(e,t);return(e=>{e.root.className=Object(Qe.a)("fui-MenuItemCheckbox",e.root.className),e.content&&(e.content.className=Object(Qe.a)("fui-MenuItemCheckbox__content",e.content.className)),e.secondaryContent&&(e.secondaryContent.className=Object(Qe.a)("fui-MenuItemCheckbox__secondaryContent",e.secondaryContent.className)),e.icon&&(e.icon.className=Object(Qe.a)("fui-MenuItemCheckbox__icon",e.icon.className)),e.checkmark&&(e.checkmark.className=Object(Qe.a)("fui-MenuItemCheckbox__checkmark",e.checkmark.className)),Object(Ye.a)(e),Object(Ge.a)(e)})(n),Object(Je.c)("useMenuItemCheckboxStyles_unstable")(n),(e=>(Object(qe.a)(e),Object(We.b)(e.root,{children:[e.checkmark&&Object(We.a)(e.checkmark,{}),e.icon&&Object(We.a)(e.icon,{}),e.content&&Object(We.a)(e.content,{}),e.secondaryContent&&Object(We.a)(e.secondaryContent,{})]})))(n)});$e.displayName="MenuItemCheckbox";var Xe=n(2427),Ze=n(2506),et=n(2518),tt=n(2505),nt=n(2515),rt=n(2514),ot=n(2365),it=n(2530),at=n(2396),st=n(2394),lt=n(2395),ct=n(1141),pt=n(2449),ut=n(324),dt=n(528),ft=n(2655),ht=n(2621),mt=n(49),yt=r.createContext(void 0);function bt(){return r.useContext(yt)}var gt=n(167),vt=Object(gt.a)({menuTriggerButton:{minWidth:"60px",marginTop:"1px"},filterCountLabel:{fontSize:"12px",marginInlineEnd:"6px"},menu:{minWidth:"224px"},menuItem:{height:"24px",fontSize:"12px",paddingInlineStart:"4px"},resetAll:{justifyContent:"flex-start"},resetAllIcon:{marginInlineEnd:"4px"},subMenuEntryPoint:{fontSize:"12px","& > :first-child":{width:"16px"}},subMenu:{width:"224px"},subMenuItem:{paddingTop:"2px",paddingBottom:"2px","& > :first-child":{display:"none"},"& > :nth-child(2)":{height:"28px"},"& > :nth-child(3)":{paddingLeft:"0px",paddingRight:"0px",width:"172px",display:"flex"}},collaboratorName:{fontSize:"12px",marginLeft:"4px",lineHeight:"28px"}}),Ct=function(e){var t,n,r=[];if(e)try{for(var o=Object(b.__values)(e),i=o.next();!i.done;i=o.next()){var a=i.value;a.DisplayName&&r.push(a.UserId)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r},Tt=r.memo((function(e){var t,n,o,i=e.collaborators,a=e.currentFilter,s=e.localizationAPI,l=e.personaIconPropertiesMap,c=function(e){var t=e.currentFilter,n=e.createOrUpdateFilter,o=bt();Object(T.k)().assertConditionTag(!!o,"FilterCapabilities should be defined in order for ContentFilter to render. Falling back to default.",527443842);var i=r.useMemo((function(){return null!=o?o:{supportedContentTypes:mt.b.CommentThread}}),[o]),a=r.useCallback((function(){return i.supportsMentionToMeFilter?t.mentionsToCurrentUser:void 0}),[t,i]),s=r.useCallback((function(){var e,n;return null!==(n=null===(e=t.CommentThread)||void 0===e?void 0:e.resolutionStatus)&&void 0!==n?n:Fe.a.All}),[t]),l=Object(b.__read)(r.useState(a()),2),c=l[0],p=l[1],u=Object(b.__read)(r.useState(s()),2),f=u[0],h=u[1],m=Object(b.__read)(r.useState(Object(ut.b)(t,i)),2),y=m[0],g=m[1];return r.useEffect((function(){d.h()||(p(a()),h(s()),g(Object(ut.b)(t,i)))}),[a,s,t,i]),r.useEffect((function(){d.h()||n({mentionsToCurrentUser:!!c,CommentThread:{resolutionStatus:f}})}),[c,n,f]),{filterCapabilities:i,atMentionToMe:c,setAtMentionToMe:p,resolutionStatus:f,setResolutionStatus:h,areAllFiltersReset:y,resetAll:function(){y||(p(X.a.mentionsToCurrentUser),h(X.a.CommentThread.resolutionStatus))},getNumberOfFiltersApplied:function(){var e;if(y)return 0;var n=0;return t.mentionsToCurrentUser!==X.a.mentionsToCurrentUser&&n++,void 0!==(null===(e=t.CommentThread)||void 0===e?void 0:e.resolutionStatus)&&t.CommentThread.resolutionStatus!==X.a.CommentThread.resolutionStatus&&n++,n}}}(e),p=c.atMentionToMe,u=c.setAtMentionToMe,f=c.resolutionStatus,h=c.setResolutionStatus,m=c.areAllFiltersReset,y=c.resetAll,v=c.getNumberOfFiltersApplied,C=function(e){var t,n,o=e.currentFilter,i=e.createOrUpdateFilter,a=e.collaborators,s=bt();Object(T.k)().assertConditionTag(!!s,"FilterCapabilities should be defined in order for ContentFilter to render. Falling back to default.",507258371);var l=r.useMemo((function(){return null!=s?s:{supportedContentTypes:mt.b.CommentThread}}),[s]),c=l.supportsMentionToMeFilter?o.mentionsToCurrentUser:void 0,p=null!==(n=null===(t=o.CommentThread)||void 0===t?void 0:t.resolutionStatus)&&void 0!==n?n:Fe.a.All,u=Object(ut.b)(o,l);return{filterCapabilities:l,atMentionToMe:c,setAtMentionToMe:function(e){i(Object(b.__assign)(Object(b.__assign)({},o),{mentionsToCurrentUser:e}))},resolutionStatus:p,setResolutionStatus:function(e){i(Object(b.__assign)(Object(b.__assign)({},o),{CommentThread:{resolutionStatus:e}}))},resetCollaboratorFilter:function(){i(Object(b.__assign)(Object(b.__assign)({},o),{userFilter:[]}))},collaboratorFilter:o.userFilter,addCollaboratorToFilter:function(e){void 0===o.userFilter||o.userFilter.includes(e)||i(Object(b.__assign)(Object(b.__assign)({},o),{userFilter:Object(b.__spreadArray)(Object(b.__spreadArray)([],Object(b.__read)(o.userFilter),!1),[e],!1)}))},removeCollaboratorFromFilter:function(e){if(void 0!==o.userFilter&&o.userFilter.includes(e)){var t=o.userFilter.filter((function(t){return t.UserId!==e.UserId}));i(Object(b.__assign)(Object(b.__assign)({},o),{userFilter:t}))}},areAllFiltersReset:u,resetAll:function(){i({mentionsToCurrentUser:X.a.mentionsToCurrentUser,CommentThread:{resolutionStatus:X.a.CommentThread.resolutionStatus},userFilter:l.supportsFilterByUser?[]:void 0})},getNumberOfFiltersApplied:function(){var e;if(u)return 0;var t=0;return o.mentionsToCurrentUser!==X.a.mentionsToCurrentUser&&t++,void 0!==(null===(e=o.CommentThread)||void 0===e?void 0:e.resolutionStatus)&&o.CommentThread.resolutionStatus!==X.a.CommentThread.resolutionStatus&&t++,void 0!==a&&void 0!==o.userFilter&&o.userFilter.length&&t++,t}}}(e),O=C.atMentionToMe,x=C.setAtMentionToMe,S=C.resolutionStatus,k=C.setResolutionStatus,P=C.areAllFiltersReset,E=C.resetAll,j=C.getNumberOfFiltersApplied,I=C.resetCollaboratorFilter,A=C.addCollaboratorToFilter,R=C.removeCollaboratorFromFilter,D=d.h()?O:p,_=d.h()?x:u,N=d.h()?S:f,M=d.h()?k:h,B=d.h()?P:m,L=d.h()?E:y,F=d.h()?j:v,H=Object(b.__read)(r.useState(((t={}).atMention=D?[s.getString(249)]:[],t.resolutionStatus=N===Fe.a.All?[]:[Object(dt.o)(s,N)],t)),2),U=H[0],z=H[1],K=((n={}).atMention=D?[s.getString(249)]:[],n.resolutionStatus=N===Fe.a.All?[]:[Object(dt.o)(s,N)],n),V=Ct(i).length,W=Ct(a.userFilter),q=((o={}).collaborator=W,o),Q=Object(b.__read)(r.useState(!1),2),G=Q[0],Y=Q[1];r.useEffect((function(){var e;d.h()||z(((e={}).atMention=D?[s.getString(249)]:[],e.resolutionStatus=N===Fe.a.All?[]:[Object(dt.o)(s,N)],e))}),[D,s,N]);var J=vt(),$=Object(ht.b)(),Z=Object(He.b)().dir,ee=function(e,t,n){return function(r){e(),void 0===t&&void 0===n||function(e,t){var n=Object(T.k)().createActivityObject("ContentFilterChanged",Object(T.l)(T.g.Todo,8268978),Object(T.j)());void 0!==e&&n.addDataField("ResolutionState",e,T.d.SystemMetadata),void 0!==t&&n.addDataField("AtMentionsMe",t,T.d.SystemMetadata),n.successTag(g.d.reserveTag(508151255))}(t,n)}},te=r.useCallback((function(){d.h()||z({}),L()}),[L]),ne=r.useCallback((function(e,t){var n;d.g()||Y(t.open),t.open&&((n=Object(T.k)().createActivityObject("ContentFilterMenuDisplayed",Object(T.l)(T.g.ReviewedAsNotNecessary),Object(T.j)())).addDataField("ContentFilterMenuDisplayed",!0,T.d.SystemMetadata),n.successTag(g.d.reserveTag(508061576)))}),[]),re=r.useCallback((function(e){if(Object(w.f)(e.key)===w.b.Escape){if(!d.g())return Y(!1),e.stopPropagation(),void e.preventDefault();e.stopPropagation()}}),[]),oe=function(e,t,n){return r.createElement($e,{"aria-label":t,className:J.menuItem,key:t,name:e,onClick:n,value:t},t)},ie=function(){var e=s.getString(249),t=!D;return oe("atMention",e,ee((function(){return _(t)}),void 0,t))},ae=function(){return ut.e.map((function(e){var t=Object(dt.o)(s,e),n=N===e?Fe.a.All:e;return oe("resolutionStatus",t,ee((function(){return M(n)}),n,void 0))}))},se=F(),le=Object(dt.a)(se),ce=d.O()?r.createElement(tt.a,null,r.createElement(nt.a,{className:J.menuItem},s.getString(261)),ie(),r.createElement(rt.a,null),r.createElement(tt.a,null,ae()),i&&r.createElement(r.Fragment,null,r.createElement(rt.a,null),r.createElement(tt.a,null,r.createElement(ot.a,{positioning:"before-top",persistOnItemClick:!0},r.createElement(it.a,null,r.createElement(at.a,{className:J.subMenuEntryPoint,icon:"rtl"===Z?r.createElement(ze.j,null):r.createElement(ze.i,null),role:"menuitem",submenuIndicator:null},Object(dt.d)(s,W.length))),r.createElement(st.a,{className:J.subMenu},r.createElement(lt.a,{checkedValues:q},r.createElement(at.a,{"aria-label":s.getString(270),className:J.menuItem,disabled:0===W.length,onClick:I},r.createElement(pt.d,{className:J.resetAllIcon}),s.getString(270)),i.length>0&&r.createElement(r.Fragment,null,r.createElement(rt.a,null),function(){if(!i)return null;var e=[];return i.forEach((function(t){if(t.DisplayName){var n=t.UserId,o=t.DisplayName,i={personaInfo:{identifiers:{Smtp:t.Email,PersonaType:"User"},displayName:o},behavior:{onCardOpen:void 0,onCardClose:void 0,disableHover:!1},tabIndex:$?0:-1,clientScenario:"SharedComments"},a=d.x()&&window.LivePersonaCardHoverTargetV2?r.createElement(window.LivePersonaCardHoverTargetV2,{cardParameters:i}):null,s={name:t.DisplayName,size:28,"aria-hidden":!0};if(l){var c=l[n];c&&(s.color="colorful",s.idForColor=c.authorID,s.image={src:c.authorImageURL})}var p=!!W.includes(t.UserId);e.push(Object(ft.a)(r.createElement($e,{onClick:ee((function(){p?R(t):W.length+1===V?I():A(t)})),key:t.UserId,name:"collaborator",value:t.UserId,className:Object(Qe.a)(J.menuItem,J.subMenuItem),icon:p?r.createElement(ze.a,null):r.createElement(ze.b,null)},r.createElement(Xe.a,Object(b.__assign)({},s)),r.createElement(Ze.a,{content:o,relationship:"inaccessible",showDelay:750},r.createElement(et.a,{block:!0,truncate:!0,wrap:!1,className:J.collaboratorName},o))),a))}else Object(T.k)().assertConditionTag(!1,"DisplayName missing from collaborator",507275265)})),e}()))))))):r.createElement(r.Fragment,null,r.createElement(tt.a,null,r.createElement(nt.a,{className:J.menuItem},s.getString(261)),ie()),r.createElement(rt.a,null),r.createElement(tt.a,null,ae()));return r.createElement(ot.a,{persistOnItemClick:!0,onOpenChange:ne,open:d.g()?void 0:G},r.createElement(it.a,null,r.createElement(ct.a,{"aria-label":Object(dt.i)(s,se),className:J.menuTriggerButton,icon:r.createElement(pt.c,null),id:Object(de.z)(),tabIndex:0},le&&r.createElement("span",{className:J.filterCountLabel},"(".concat(le,")")),r.createElement(ze.g,null))),r.createElement(st.a,{className:J.menu,onKeyDown:re},r.createElement(lt.a,{checkedValues:d.h()?K:U},r.createElement(at.a,{"aria-label":s.getString(262),className:Object(Qe.a)(J.menuItem,J.resetAll),disabled:B,onClick:te},r.createElement(pt.d,{className:J.resetAllIcon}),s.getString(262)),r.createElement(rt.a,null),ce)))})),Ot=n(1108),xt=n(740),St={itemCount:Object(Te.eb)({margin:"9px auto",width:"35%"})},kt=o.a.memo((function(e){var t=Object(xt.b)();return o.a.createElement(Ot.a,{variant:"small",className:St.itemCount,"aria-live":"polite"},Object(dt.j)(t,e.itemCount))})),Pt=n(143),Et=Object(v.c)({},Object(Oe.c)((function(e,t){return{labelContainer:Object(Te.eb)({display:"flex",color:Se.a.GRAY_E,opacity:"100%",fontFamily:"inherit",fontSize:"12px",lineHeight:"1.3",justifyContent:"center",width:t,marginTop:"7px",marginBottom:"10px",minHeight:"20px",forcedColorAdjust:"auto"}),cardContainer:Object(Te.eb)({display:"flex",flexDirection:"column",width:t,cursor:"pointer",marginTop:"20px",marginRight:"8px",marginLeft:"8px",backgroundColor:"transparent",flexGrow:0,transition:"ease-in-out",transitionProperty:"margin-top,max-height,min-height",transitionDuration:"0.20s",minHeight:"70px",maxHeight:"70px",border:"1px solid transparent",selectors:{":hover":Object(Te.eb)({marginTop:"5px",minHeight:"85px",maxHeight:"85px"},Pe.l),":focus":Object(Te.eb)({color:"#333333",outline:"none",border:"1px dotted"},Pe.k)}}),ghostCardContainer:Object(Te.eb)({width:t,overflow:"hidden"}),svgStyle:Object(Te.eb)({width:t},e&&{transform:"scaleX(-1)"})}})),(function(){return[Object(xe.a)()]})),jt=function(e){function t(t){var n=e.call(this,t)||this;return n.invokeHandler=n.invokeHandler.bind(n),n.keyDownHandler=n.keyDownHandler.bind(n),n}return Object(b.__extends)(t,e),t.prototype.invokeHandler=function(e){var t,n;null===(n=(t=this.props).onClick)||void 0===n||n.call(t),e.stopPropagation()},t.prototype.keyDownHandler=function(e){Object(w.f)(e.key)!==w.b.Enter&&Object(w.f)(e.key)!==w.b.Space||this.invokeHandler(e)},t.prototype.render=function(){var e=n(2744),t=Object(Pt.a)(),o=Et(t);return r.createElement("div",{"aria-label":this.props.accessibilityLabel,id:de.B(),className:o.cardContainer,role:"button",onClick:this.invokeHandler,onKeyDown:this.keyDownHandler,tabIndex:0},r.createElement("span",{className:o.labelContainer},this.props.ghostCommentString),r.createElement("span",{className:o.ghostCardContainer},r.createElement(e,{className:o.svgStyle})))},t}(r.PureComponent),It=n(1114),wt={position:"relative",minWidth:"0px",paddingTop:"5px",paddingBottom:"6px",paddingLeft:"12px",paddingRight:"12px"};function At(e){var t,n,r,o;return Object(Te.eb)(((t={".OfficeIconColors_mCommentMarginEntrypointCenter":{fill:null!==(n=null==e?void 0:e.NewCommentButtonIconFill)&&void 0!==n?n:"#FAFAFA"},".OfficeIconColors_mCommentMarginEntrypointBorder":{fill:null!==(r=null==e?void 0:e.NewCommentButtonIconBorder)&&void 0!==r?r:"#242424"},".OfficeIconColors_mCommentMarginEntrypointStamp":{fill:null!==(o=null==e?void 0:e.NewCommentButtonIconPlusSign)&&void 0!==o?o:"#639D54"},":hover .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":hover:active .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"}})[Te.m]={".OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},".OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"ButtonText"},".OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"ButtonText"},":focus .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":focus .OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"ButtonText"},":focus .OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"ButtonText"},":hover .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":hover .OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"Highlight"},":hover .OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"Highlight"},":hover:active .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":hover:active .OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"Highlight"},":hover:active .OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"Highlight"}},t))}function Rt(e){var t,n;return Object(Te.eb)({".OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},".OfficeIconColors_mCommentMarginEntrypointBorder":{fill:null!==(t=null==e?void 0:e.NewCommentButtonIconBorderDisabled)&&void 0!==t?t:"#8B8B8B"},".OfficeIconColors_mCommentMarginEntrypointStamp":{fill:null!==(n=null==e?void 0:e.NewCommentButtonIconPlusSignDisabled)&&void 0!==n?n:"#717171"}})}var Dt=Object(Oe.c)((function(e){return{newCommentButtonRootStyles:Object(Te.eb)({display:"flex",flexDirection:"row",direction:"inherit",flexWrap:"nowrap",minHeight:"30px",marginBottom:"5px",paddingLeft:"13px",paddingBottom:0,backgroundColor:"transparent"}),newCommentButtonStyles:wt,newCommentIconStyles:At(e),newCommentIconStylesDisabled:Rt(e)}})),_t=function(e){var t=Object(N.b)(),n=Dt(null==t?void 0:t.colors);return r.createElement("div",{className:n.newCommentButtonRootStyles},r.createElement(Ze.a,{content:e.localizationAPI.getString(177),relationship:"label",positioning:{position:"before"}},r.createElement(ct.a,{className:"".concat(e.disabled?"".concat(n.newCommentIconStylesDisabled):"".concat(n.newCommentIconStyles)),id:Object(de.E)(),icon:Object(It.a)().icons.NewComment,onClick:e.onClick,onKeyDown:e.onKeyDown,tabIndex:e.disabled?-1:0,"aria-label":e.localizationAPI.getString(177),disabledFocusable:e.disabled,style:n.newCommentButtonStyles},e.localizationAPI.getString(91))))},Nt=n(351),Mt=n(2119),Bt=n(534),Lt=function(e,t){var n,r,o,i,a,s,l,c,p,u,d,f,h,m,y,b,g,v,C,T;return Object(Te.db)({root:{margin:0,padding:0,backgroundColor:null!==(i=null==e?void 0:e.NewCommentButton)&&void 0!==i?i:Se.a.WHITE,border:"1px solid",borderRadius:Pe.c,borderColor:null!==(a=null==e?void 0:e.CommonControlBorder)&&void 0!==a?a:Se.a.GRAY_C,boxShadow:null!==(s=null==t?void 0:t.DefaultButtonBoxShadow)&&void 0!==s?s:"0 2px 4px -.75px rgba(0,0,0,0.1)",selectors:{".ms-Fabric--isFocusVisible &:focus::after":Pe.m,".ms-Button-flexContainer":{position:"relative"}}},icon:(n={".OfficeIconColors_mCommentMarginEntrypointCenter":{fill:null!==(l=null==e?void 0:e.NewCommentButtonIconFill)&&void 0!==l?l:"#FAFAFA"},".OfficeIconColors_mCommentMarginEntrypointBorder":{fill:null!==(c=null==e?void 0:e.NewCommentButtonIconBorder)&&void 0!==c?c:"#242424"},".OfficeIconColors_mCommentMarginEntrypointStamp":{fill:null!==(p=null==e?void 0:e.NewCommentButtonIconPlusSign)&&void 0!==p?p:"#639D54"},":hover .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":hover:active .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"}},n[Te.m]={".OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},".OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"red"},".OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"ButtonText"},":hover .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":hover .OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"Highlight"},":hover .OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"Highlight"},":hover:active .OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},":hover:active .OfficeIconColors_mCommentMarginEntrypointBorder":{fill:"Highlight"},":hover:active .OfficeIconColors_mCommentMarginEntrypointStamp":{fill:"Highlight"}},n.width="16px",n.padding="8px",n.paddingLeft="12px",n.margin=0,n.marginBottom="16px",n.marginTop="16px",n.color=null!==(u=null==e?void 0:e.PrimaryButton)&&void 0!==u?u:Object(Bt.a)().primary,n),iconDisabled:{".OfficeIconColors_mCommentMarginEntrypointCenter":{fill:"transparent"},".OfficeIconColors_mCommentMarginEntrypointBorder":{fill:null!==(d=null==e?void 0:e.NewCommentButtonIconBorderDisabled)&&void 0!==d?d:"#8B8B8B"},".OfficeIconColors_mCommentMarginEntrypointStamp":{fill:null!==(f=null==e?void 0:e.NewCommentButtonIconPlusSignDisabled)&&void 0!==f?f:"#717171"}},label:{color:null==e?void 0:e.DefaultButtonIcon,fontSize:"14px",textAlign:"right",fontFamily:"inherit",padding:"8px",paddingRight:"12px",paddingLeft:0,margin:0,marginBottom:"16px",marginTop:"16px"},rootHovered:Object(Te.eb)({backgroundColor:null==e?void 0:e.NewCommentButtonHovered},Pe.l),rootPressed:{backgroundColor:null==e?void 0:e.NewCommentButtonPressed},rootFocused:Object(Te.eb)({boxShadow:null!==(h=null==t?void 0:t.FocusedButtonBoxShadow)&&void 0!==h?h:"inset 0px 0px 0px 1px white",backgroundColor:null!==(m=null==e?void 0:e.DefaultButton)&&void 0!==m?m:Pe.b.BUTTON_SELECT,borderColor:null!==(y=null==e?void 0:e.NewCommentButtonBorderFocused)&&void 0!==y?y:Se.a.BLACK,selectors:(r={},r[Te.m]={" .ms-Button-label":{color:"HighlightText"}},r)},Pe.k),rootDisabled:{boxShadow:null!==(b=null==t?void 0:t.DisabledButtonBoxShadow)&&void 0!==b?b:"inset 0px 0px 0px 1px #F3F2F1",backgroundColor:null!==(g=null==e?void 0:e.NewCommentButtonDisabled)&&void 0!==g?g:Pe.b.BUTTON_DISABLED},iconHovered:{color:null!==(v=null==e?void 0:e.NewCommentButtonIconHoveredPressed)&&void 0!==v?v:Se.a.GRAY_J},iconPressed:{color:null!==(C=null==e?void 0:e.NewCommentButtonIconHoveredPressed)&&void 0!==C?C:Se.a.GRAY_J},labelHovered:{color:null!==(T=null==e?void 0:e.DefaultButtonIcon)&&void 0!==T?T:Se.a.GRAY_J,selectors:(o={},o[Te.m]={color:"HighlightText"},o)}})},Ft=Object(Oe.c)((function(e,t,n){return{newCommentButtonContainer:(r=n,Object(Te.eb)({display:"flex",flexDirection:"row",direction:"inherit",flexWrap:"nowrap",width:r,flex:"1",minHeight:"41px",marginBottom:"5px",paddingLeft:"13px",paddingBottom:0,backgroundColor:"transparent",outline:"none"})),newCommentButton:Lt(e,t)};var r})),Ht=Object(v.c)({},(function(e,t,n){return Ft(e,t,n)}),(function(){return[Object(xe.a)()]})),Ut={iconName:"NewComment"},zt=r.memo((function(e){var t=Object(N.b)(),n=Ht(null==t?void 0:t.colors,null==t?void 0:t.styles);return r.createElement("div",{className:n.newCommentButtonContainer},r.createElement(E.a,{content:e.localizationAPI.getString(177),directionalHint:j.a.leftCenter,tooltipProps:Mt.a,id:M.b},r.createElement(Nt.a,{id:Object(de.E)(),styles:n.newCommentButton,text:e.localizationAPI.getString(91),ariaLabel:e.localizationAPI.getString(177),iconProps:Ut,onClick:e.onClick,onKeyDown:e.onKeyDown,disabled:e.disabled,allowDisabledFocus:!0,tabIndex:e.disabled?-1:0})))})),Kt=n(2620),Vt=n(2118),Wt=n(1211),qt=n(265),Qt={cardTabbingMode:Kt.a.ExpandedCardOrFirstCardTabbable,postTabbingMode:Kt.b.ExpandedCardRootPostTabbable},Gt=function(e){function t(t){var n=e.call(this,t)||this;return n.paneRootRef=null,n.onPaneResize=function(e){Object(T.k)().assertConditionTag(e.length<=1,"Unexpected number of elements: ".concat(e.length),592232640),e.forEach((function(e){e.target===n.paneRootRef&&(n.props.selectedComment&&n.prevContentRect&&n.prevContentRect.height!==e.contentRect.height&&n.scrollToThreadById(n.props.selectedComment.selectedCardId),n.prevContentRect=e.contentRect)}))},n.onRenderCell=function(e,t){if(e)return n.renderCommentThread(t||0,e);Object(T.k)().assertConditionTag(!1,"Trying to render non-existent item",577066524)},n.onCardLayout=void 0,n.renderWithContexts=function(e,t){var o=n.paneContainerKeyDownHandler.onKeyDown;n.styles=Le(null==e?void 0:e.colors);var i;i=n.isReadyToRender()?n.isPaneEmpty()?n.renderEmptyPaneMessage():r.createElement("div",{"data-is-scrollable":"true",id:de.p(),className:n.styles.listContainer,onKeyDown:n.commentContentsKeyDownHandler.onKeyDown},r.createElement(k.a,{ref:n.onReceiveListRef,className:n.styles.commentList,items:n.state.allRenderableItemThreads,role:"tree",onRenderPage:n.onRenderPage,onRenderCell:n.onRenderCell,"aria-label":n.props.localizationAPI.getString(32),getKey:n.getListItemKey}),n.shouldShowGhostComment()?r.createElement(jt,Object(b.__assign)({},n.getGhostCommentProps())):void 0):r.createElement(O.a,{delay:Pe.f},r.createElement(x.a,{size:S.a.large,className:n.styles.spinnerStyles}));var a={ref:n.setPaneRootDivRef,id:de.A(),"aria-label":n.props.localizationAPI.getString(31),className:n.styles.paneContainer,onKeyDown:o,tabIndex:-1,onFocus:n.paneFocusHandler,onContextMenu:Wt.a};return d.G()?r.createElement("div",Object(b.__assign)({},a),n.renderContentFilterAndNewCommentButtonWrapper(t),i):r.createElement(P.a,{className:n.styles.focusTrapZone,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0},r.createElement("div",Object(b.__assign)({},a),n.renderCommentPaneHeader_deprecated(),n.renderNewCommentButton(),i))},n.onRenderPage=n.onRenderPage.bind(n),n.scrollToThreadById=n.scrollToThreadById.bind(n),n.closePaneButtonClickHandler_deprecated=n.closePaneButtonClickHandler_deprecated.bind(n),n.closePaneButtonKeyDownHandler_deprecated=n.closePaneButtonKeyDownHandler_deprecated.bind(n),n.onReceiveListRef=n.onReceiveListRef.bind(n),n.paneFocusHandler=n.paneFocusHandler.bind(n),n.setPaneRootDivRef=n.setPaneRootDivRef.bind(n),n.newCommentButtonClickHandler=n.newCommentButtonClickHandler.bind(n),n.newCommentButtonKeyDownHandler=n.newCommentButtonKeyDownHandler.bind(n),n.getMentionableCommentEditorProps=Object(v.a)(n.getMentionableCommentEditorProps.bind(n)),n.getAuthToken=n.getAuthToken.bind(n),n.state=n.getInitialState(t),n.resizeObserver=new A.a(n.onPaneResize),n}return Object(b.__extends)(t,e),t.prototype.onReceiveListRef=function(e){this.listRef=e},t.prototype.isPaneEmpty=function(){var e=this.props.nextPopulatedContextDetails===_.a.NoComments;return e&&Object(T.k)().assertConditionTag(!this.props.dataItems.length,"CommentData length should be 0 if NextPopulatedContextDetails is NoComments.",595182560),e&&!this.props.dataItems.length&&(d.T()||!this.props.createdCommentLie)},t.prototype.scrollToThreadById=function(e){var t=this;if(!this.listRef)return!1;var n=this.state.allRenderableItemThreads,r=Math.max(n.findIndex((function(t){return be.h(t).commentId===e})),0);return this.listRef.scrollToIndex(r,(function(e){return t.getCardScrollHeight(e,n)})),!0},t.prototype.paneFocusHandler=function(e){e.target===this.paneRootRef&&this.props.focusManager.focusCommentPaneCommand(this.props.componentTree)},t.prototype.setPaneRootDivRef=function(e){this.paneRootRef=e},t.prototype.closePaneButtonClickHandler_deprecated=function(e){this.closePane(),e.stopPropagation()},t.prototype.closePaneButtonKeyDownHandler_deprecated=function(e){Object(w.f)(e.key)===w.b.Enter&&(this.closePane(),e.preventDefault(),e.stopPropagation())},t.prototype.newCommentButtonClickHandler=function(e){this.startNewCommentSession(),e.stopPropagation()},t.prototype.newCommentButtonKeyDownHandler=function(e){Object(w.f)(e.key)===w.b.Enter&&(this.startNewCommentSession(),e.stopPropagation(),e.preventDefault())},t.prototype.getGhostCommentProps=function(){var e=dt.k(this.props.localizationAPI,this.props.nextPopulatedContextDetails);return{onClick:this.onGhostCommentClicked,ghostCommentString:e,accessibilityLabel:e}},t.prototype.onContextChanged=function(){},t.prototype.getAuthToken=function(){return this.props.peopleAPI.getAuthToken(C.c.Loki)},t.prototype.renderCommentPaneHeader_deprecated=function(){return r.createElement("div",{className:this.styles.paneHeader},r.createElement("h2",{className:this.styles.paneTitle},this.props.localizationAPI.getString(18)),r.createElement(E.a,{content:this.props.localizationAPI.getString(19),directionalHint:j.a.leftCenter,tooltipProps:Mt.a,id:M.b},this.renderCloseButton_deprecated()))},t.prototype.renderCloseButton_deprecated=function(){return r.createElement(I.a,{id:de.l(),styles:this.styles.iconClosePane,onClick:this.closePaneButtonClickHandler_deprecated,onKeyDown:this.closePaneButtonKeyDownHandler_deprecated,iconProps:{iconName:"CancelGlyph_TaskPane"},title:void 0,ariaLabel:this.props.localizationAPI.getString(19),tabIndex:0})},t.prototype.isNewCommentButtonDisabled=function(){return!this.props.modelCapabilities.newThread||this.props.readOnly},t.prototype.renderContentFilterAndNewCommentButtonWrapper=function(e){return r.createElement("div",{className:this.styles.topWrapper},this.renderNewCommentButton(),e?r.createElement("div",{className:this.styles.filterRegion},r.createElement(kt,{itemCount:this.props.filterItemCount}),r.createElement(Tt,Object(b.__assign)({},this.getContentFilterProps()))):null)},t.prototype.renderNewCommentButton=function(){return d.A()?d.I()?r.createElement(_t,{disabled:this.isNewCommentButtonDisabled(),localizationAPI:this.props.localizationAPI,onClick:this.newCommentButtonClickHandler,onKeyDown:this.newCommentButtonKeyDownHandler}):r.createElement(zt,{disabled:this.isNewCommentButtonDisabled(),localizationAPI:this.props.localizationAPI,onClick:this.newCommentButtonClickHandler,onKeyDown:this.newCommentButtonKeyDownHandler}):null},t.prototype.renderEmptyPaneMessage=function(){return r.createElement("div",{className:this.styles.emptyPaneMessage,"aria-label":this.props.localizationAPI.getString(13)},this.props.localizationAPI.getString(13))},t.prototype.onRenderPage=function(e,t){if((null==e?void 0:e.page.items)&&this.props.modelCapabilities.virtualized){var n=function(e,t){var n,r,o=[];try{for(var i=Object(b.__values)(e),a=i.next();!a.done;a=i.next()){var s=t(a.value);void 0!==s&&o.push(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(e.page.items,(function(e){if(Object(qt.a)(e[0]))return Object(R.j)(e[0].commentModel);Object(T.k)().assertConditionTag(!1,"First item in thread is not a comment model!",595632604)}));n.length&&this.onRequestLoadThreads(n)}return Object(T.k)().assertConditionTag(!!e,"Trying to render with non-existent pageProps!",577066525),t?t(e):null},t.prototype.getCreateCommentInitialHeight=function(){return 0},t.prototype.getKeyboardingOptions=function(){return Qt},t.prototype.componentDidUpdate=function(t,n){var r,o,i=null===(r=t.selectedComment)||void 0===r?void 0:r.selectedCardId,a=null===(o=this.props.selectedComment)||void 0===o?void 0:o.selectedCardId,s=i!==a,l=ve(t),c=ve(this.props);s?a&&this.scrollToThreadById(a):!this.props.selectedComment&&l!==c&&c&&this.scrollToThreadById(c),!this.listRef||this.props.selectedComment===t.selectedComment&&this.props.expandedComments===t.expandedComments&&this.props.cardViewStates===t.cardViewStates&&this.props.postViewStates===t.postViewStates&&this.props.highlightedCommentId===t.highlightedCommentId&&this.props.modelCapabilities===t.modelCapabilities&&this.props.readOnly===t.readOnly&&this.props.draftState===t.draftState||this.listRef.forceUpdate(),e.prototype.componentDidUpdate.call(this,t,n)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.paneRootRef&&this.resizeObserver.observe(this.paneRootRef)},t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this),this.resizeObserver&&this.resizeObserver.disconnect(),this.prevContentRect=void 0},t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.getUpdatedItemThreads(e);this.setState({allRenderableItemThreads:t})},t.prototype.getCardScrollHeight=function(e,t){return Object(T.k)().assertConditionTag(void 0!==t[e],"No comment thread in the given index: '".concat(e,"'. Thread length: '").concat(t.length,"'"),595182561),t[e]&&1===t[e].length?160:t[e]&&2===t[e].length?206:235},t.prototype.invokeModalDialog=function(e,t,n){var r=Object(T.k)().createActivityObject("InvokeModalDialog",this.props.telemetryVisitor,Object(T.j)());switch(r.addDataField("ModalDialogMode",e,T.d.SystemMetadata),e){case B.a.ClosePaneDraft:var o,i=dt.f(this.props.localizationAPI),a=new Promise((function(e){o=e}));return this.props.requestModalConfirmation({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:g.d.reserveTag(595928218),telemetryVisitor:this.props.telemetryVisitor},(function(){return o(t())}),(function(){return o(n())}),i),r.successTag(595182562),a;default:return Object(T.k)().assertConditionTag(!1,"ModalDialogMode ".concat(e," not implemented for web"),595182563),r.failTag(595182592,-2130957557),Promise.resolve(D.a.Unhandled)}},t.prototype.getMentionableCommentEditorProps=function(e,t){if(e===R.b.Enabled)return{onMentionCreated:this.onMentionCreated,onMentioneesStillInDraftUpdated:this.onMentioneesStillInDraftUpdated,getAuthToken:this.getAuthToken,correlationId:this.props.correlationId,suggestionsDetails:t}},t.prototype.getContentsPreventDefaultKeyDownBehavior=function(){},t.prototype.getContentExtraPaddingLeft=function(){},t.prototype.getContentExtraPaddingRight=function(){},t.prototype.getAvailableScreenHeight=function(){},t.prototype.getMaxDraftHeight=function(){},t.prototype.getCommentCardStyle=function(){},t.prototype.getContentBackgroundColor=function(e,t){},t.prototype.getPinnedCardIndex_deprecated=function(){},t.prototype.renderInner=function(){return Object(Vt.a)(this.renderWithContexts,N.a,yt)},t}(Ce),Yt=Object(a.connect)((function(){var e=f.y(),t=f.z(),n=d.N()?p.f(t):t;return function(t){var r=f.f(t),o=p.c(t),i={cardViewStates:f.c(t),dataItems:e(t),tasks:h.b(t),personaIconPropertiesMap:f.r(t),createdCommentLie:f.g(t,!0,o.componentTreeId.renderContextType),nextPopulatedContextDetails:r.nextPopulatedContextDetails,pendingCommentLoad:f.q(t),postViewStates:f.s(t),historyRecordViewStates:h.a(t),componentTree:o,commentThreadCountsContextDetails:r.commentThreadCounts,selectedThreadIdBeforeCommentSession:f.u(t),readOnly:f.o(t),highlightedCommentId:f.n(t),lastContextChangeIncrement:r.lastContextChangeIncrement,initializationStatus:t.paneState.initializationStatus,draftState:f.h(t),modelCapabilities:f.p(t),selectedComment:f.t(t),expandedComments:f.j(t),suggestionsDetails:f.w(t),foldableLayoutState:p.d(t).foldableLayoutState,displayConfigurationState:t.paneState.viewContainerDisplayConfiguration,currentFilter:c.c(t),filterItemCount:c.d(t),collaborators:c.b(t),DoNotUse_isFilteringEnabled:!!c.g(t),renderableSelectedComment:d.L()?n(t):void 0},a=f.x(t);if(a){var s=f.k(t),l=Object(m.f)(s)?s.findIndex((function(e){return e===a})):s.filter(u.a).findIndex((function(e){return e.commentId===a}));l>-1&&(i.topVisibleThread={cardId:a,index:l})}return i}}),y.b,void 0,{forwardRef:!0})(Gt),Jt=n(2659),$t=r.memo((function(e){var t=s((function(t){return Object(l.c)(t,e.extensionRenderMode)})),n=s(p.e)!==i.a.Visible,o=s(c.g);if(t||n)return null;var a=r.createElement(Jt.a,{api:e.themeAPI},r.createElement(Yt,{commentAPI:e.commentAPI,peopleAPI:e.peopleAPI,localizationAPI:e.localizationAPI,focusManager:e.focusManager,selectionManager:e.selectionManager,initializationReason:e.initializationReason,registerComponentUIActionListener:e.registerComponentUIActionListener,unregisterComponentUIActionListener:e.unregisterComponentUIActionListener,registerComponentInterruptableCommandListener:e.registerComponentInterruptableCommandListener,unregisterComponentInterruptableCommandListener:e.unregisterComponentInterruptableCommandListener,resource:e.resource,telemetryVisitor:e.telemetryVisitor,correlationId:e.correlationId,onInitialRender:e.onInitialRender,lppManager:e.lppManager,createOrUpdateFilter:e.createOrUpdateFilter,componentRef:e.componentRef,componentInstanceId:e.componentInstanceId}));return o&&(a=r.createElement(yt.Provider,{value:o},a)),a}))},2177:function(e,t,n){"use strict";n.r(t),n.d(t,"makeMapStateToProps",(function(){return j})),n.d(t,"HostableCommentCardRendererContainer",(function(){return I}));var r=n(9),o=n(8),i=n(49),a=n(185),s=n(23),l=n(454),c=n(2685),p=n(42),u=n(3),d=n(1569),f=n(2085),h=n(1),m=n(2687),y=n(1588),b=function(e){var t=e.textStylePolyester,n=(e.variantFluent,e.colorFluent,Object(u.__rest)(e,["textStylePolyester","variantFluent","colorFluent"]));return h.createElement(y.Text,Object(u.__assign)({},n,{textStyle:t}))};b.displayName="TextWrapper";var g=n(2659),v={dataFieldVisitor:Object(o.l)(o.g.GlobalAPI)};function C(e){return{dataFieldVisitor:e}}var T,O,x,S,k,P=h.createContext(v),E=function(e){function t(t){var n=e.call(this,t)||this;return n.getDiagnosticDataFields=function(){return[Object(o.o)("IsResourceAvailable",n.props.isResourceAvailable,o.d.SystemMetadata),Object(o.o)("IsContentExtensionEnabled",n.props.isExtensionEnabled,o.d.SystemMetadata),Object(o.o)("RenderContextType",n.props.componentTree.componentTreeId.renderContextType,o.d.SystemMetadata)]},n.getUpdatedResource=Object(d.a)((function(e,t){return Object(u.__assign)(Object(u.__assign)({},e),{id:t})})),n.createTelemetryContext=Object(d.a)(C),n.getAccessibilitySetProperties=Object(d.b)((function(e){var t,n,r;return{accessibilityPositionInSet:null===(t=null==e?void 0:e.setItem)||void 0===t?void 0:t.positionInSet,accessibilitySetSize:null===(n=null==e?void 0:e.setItem)||void 0===n?void 0:n.setSize,accessibilityLevel:null===(r=null==e?void 0:e.setItem)||void 0===r?void 0:r.level}}),(function(){return[n.props.accessibilityMetadata]})),n.state={keyIter_deprecated:0},n}return Object(u.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t,n;e.isResourceAvailable!==this.props.isResourceAvailable&&(null===(n=(t=Object(o.k)()).logDiagnosticTrace)||void 0===n||n.call.apply(n,Object(u.__spreadArray)([t,Object(f.a)(T||(T=Object(u.__makeTemplateObject)(["HostableComponentResourceAvailabilityUpdated"],["HostableComponentResourceAvailabilityUpdated"]))),r.d.reserveTag(554717322),o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor],Object(u.__read)(this.getDiagnosticDataFields()),!1)))},t.prototype.componentDidMount=function(){var e,t;null===(t=(e=Object(o.k)()).logDiagnosticTrace)||void 0===t||t.call.apply(t,Object(u.__spreadArray)([e,Object(f.a)(O||(O=Object(u.__makeTemplateObject)(["HostableComponentMount"],["HostableComponentMount"]))),r.d.reserveTag(554717323),o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor],Object(u.__read)(this.getDiagnosticDataFields()),!1))},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=Object(o.k)()).logDiagnosticTrace)||void 0===t||t.call.apply(t,Object(u.__spreadArray)([e,Object(f.a)(x||(x=Object(u.__makeTemplateObject)(["HostableComponentUnmount"],["HostableComponentUnmount"]))),r.d.reserveTag(554717324),o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor],Object(u.__read)(this.getDiagnosticDataFields()),!1))},t.prototype.render=function(){var e,t,n,i;if(!this.props.isResourceAvailable||!this.props.resource||!this.props.threadId)return null===(t=(e=Object(o.k)()).logDiagnosticTrace)||void 0===t||t.call.apply(t,Object(u.__spreadArray)([e,Object(f.a)(S||(S=Object(u.__makeTemplateObject)(["HostableComponentRenderFailed"],["HostableComponentRenderFailed"]))),r.d.reserveTag(524100997),o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor],Object(u.__read)(this.getDiagnosticDataFields()),!1)),null;if(!this.props.isExtensionEnabled)return r.a?h.createElement(b,{textStylePolyester:"MediumBold"},"Debug Error: This comment card's extension is disabled."):(null===(i=(n=Object(o.k)()).logDiagnosticTrace)||void 0===i||i.call.apply(i,Object(u.__spreadArray)([n,Object(f.a)(k||(k=Object(u.__makeTemplateObject)(["HostableComponentRenderFailedExtensionDisabled"],["HostableComponentRenderFailedExtensionDisabled"]))),r.d.reserveTag(524100998),o.h.Info,o.c.ProductServiceUsage,this.props.telemetryVisitor],Object(u.__read)(this.getDiagnosticDataFields()),!1)),null);var a=this.getUpdatedResource(this.props.resource,this.props.threadId),s=this.getAccessibilitySetProperties(),l=h.createElement(g.a,{api:this.props.themeAPI},h.createElement(m.a,Object(u.__assign)({commentAPI:this.props.commentAPI,focusManager:this.props.focusManager,localizationAPI:this.props.localizationAPI,peopleAPI:this.props.peopleAPI,resource:a,telemetryVisitor:this.props.telemetryVisitor,componentRef:this.props.componentRef,componentTree:this.props.componentTree,maximumDimensions:this.props.maximumDimensions,onInitialRender:this.props.onInitialRender,setComponentRef:this.props.setComponentRef,isVirtualized:this.props.isVirtualized,componentInstanceId:this.props.componentInstanceId,correlationId:this.props.correlationId,lppManager:this.props.lppManager,accessibilityMetadata:this.props.accessibilityMetadata},s)));return h.createElement(P.Provider,{value:this.createTelemetryContext(this.props.telemetryVisitor)},l)},t}(h.PureComponent),j=function(){var e=c.e(),t=c.c(),n=c.m((function(e){return s.g(e,!0)}),(function(e){return s.i(e,!0)}),e,t),a=c.a(),u=c.g(),d=c.d(n,a),f=c.n(d);return function(e,t){var a,c=n(e,t),d=c.thread.length?c.thread[0].commentId:null===(a=t.resource)||void 0===a?void 0:a.id,h=t.componentTree.componentTreeId.renderContextType,m=void 0;switch(h){case p.a.FullPane:m={renderMode:i.e.TaskPaneItem};break;case p.a.DiscreteIntegrated:m={renderMode:i.e.Integrated};break;case p.a.DiscreteIsolated:d&&(m={renderMode:i.e.Isolated,threadId:d});break;case p.a.HalfPane:case p.a.None:Object(o.k)().assertConditionTag(!1,"Invalid RenderContextType for HostableComponent received.",593822914);break;default:Object(r.m)(h)}var y=l.d(e,m);return{isResourceAvailable:f(e,t),modelCapabilities:s.p(e),isDraftThread:u(e,t),isExtensionEnabled:y,threadId:d}}},I=Object(a.connect)(j)(E)},2574:function(e,t,n){"use strict";var r=n(2652),o="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||o||Function("return this")();t.a=i},2575:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1),o=r.createContext(new Proxy({},{get:function(){throw new Error("ComponentTreeIdContext undefined. Did you forget to render a ComponentTreeIdContext context provider?")}}));function i(){return r.useContext(o)}},2581:function(e,t,n){"use strict";var r;!function(e){e[e.New_nonFluent=0]="New_nonFluent",e[e.Normal=1]="Normal",e[e.Editing=2]="Editing",e[e.PendingDraft=3]="PendingDraft",e[e.PendingEdit=4]="PendingEdit",e[e.EditPreCommitPending=5]="EditPreCommitPending",e[e.Resolved=6]="Resolved",e[e.LowFidelityWarningEdit=7]="LowFidelityWarningEdit",e[e.LowFidelityWarningDelete=8]="LowFidelityWarningDelete",e[e.Error=9]="Error"}(r||(r={})),t.a=r},2600:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.MetadataOnly=1]="MetadataOnly",e[e.Any=2]="Any"}(r||(r={}))},2620:function(e,t,n){"use strict";var r,o;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.AllCardsTabbable=0]="AllCardsTabbable",e[e.ExpandedCardTabbable=1]="ExpandedCardTabbable",e[e.ExpandedCardOrFirstCardTabbable=2]="ExpandedCardOrFirstCardTabbable",e[e.SelectedCardTabbable=3]="SelectedCardTabbable"}(r||(r={})),function(e){e[e.AllPostsTabbable=0]="AllPostsTabbable",e[e.ExpandedCardPostsTabbable=1]="ExpandedCardPostsTabbable",e[e.ExpandedCardRootPostTabbable=2]="ExpandedCardRootPostTabbable",e[e.SelectedPostTabbable=3]="SelectedPostTabbable"}(o||(o={}))},2621:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(1),o=r.createContext(void 0);function i(){return r.useContext(o)}},2631:function(e,t,n){"use strict";n.d(t,"d",(function(){return ho})),n.d(t,"a",(function(){return mo})),n.d(t,"b",(function(){return bo})),n.d(t,"e",(function(){return xo})),n.d(t,"c",(function(){return So}));var r,o=n(3),i=n(9),a=n(8),s=n(1),l=n.n(s),c=n(272),p=n(170),u=n(84),d=n(35),f=n(791),h=n(24),m=n(183),y=n(87),b=n(291),g=n(74),v=n(2600),C=n(426),T=n(1023),O=n(325),x=n(2581),S=n(42);!function(e){e[e.Default=0]="Default",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"}(r||(r={}));var k,P=r,E=n(17),j=n(789),I=n(92),w=n(691),A=n(1388),R=n(397),D=n(427),_=n(260),N=n(1196),M=n(2116),B=n(189),L=n(1029);!function(e){e[e.Editing=0]="Editing",e[e.Disabled=1]="Disabled",e[e.ReadOnly=2]="ReadOnly"}(k||(k={}));var F,H=k;!function(e){e[e.CardContextMenuItem=0]="CardContextMenuItem",e[e.ActionBarItem=1]="ActionBarItem"}(F||(F={}));var U,z=n(1569),K=n(2464),V=n(2085);!function(e){e[e.Post=0]="Post",e[e.Card=1]="Card"}(U||(U={}));var W=n(5),q=n(67),Q=Object(E.c)((function(e){var t;return{cardTopperContainerRoot:Object(W.eb)({borderBottom:"1px solid",borderColor:null!==(t=null==e?void 0:e.CardTopperContainerBorder)&&void 0!==t?t:q.a.GRAY_B}),cardTopperContainerFlexWrapper:Object(W.eb)({display:"flex",alignItems:"center"}),cardTopperContainerLeftElement:Object(W.eb)({flex:1})}})),G=l.a.memo((function(e){var t,n=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,r=Q(n);return l.a.createElement("div",{onClick:e.onPress,className:r.cardTopperContainerRoot},l.a.createElement("div",{className:r.cardTopperContainerFlexWrapper},l.a.createElement("div",{className:r.cardTopperContainerLeftElement},e.leftElement),e.rightElement))}));G.displayName="CardTopperContainer";var Y,J=n(1581),$=n(1387),X=n(348),Z=n(528),ee=n(136),te=n(2118),ne=n(2575),re=/{([^{}]+)}|[^{}]+/g,oe=n(287),ie=n(2119),ae=n(1202),se=n(1119),le=function(e){function t(t){var n=e.call(this,t)||this;return n.renderWithContexts=function(e,t){var r,o,i=e.renderContextType,a=ae.c(n.props.completion),l=ee.j({id:n.props.id,renderContextType:i}),c=!1;n.props.assignees.length>0?(c=Object(p.c)(n.props.assignees),r=Object(Z.r)(n.props.assignees,n.props.localizationAPI),o=Object(Z.s)(n.props.assignees,a,n.props.localizationAPI)):(r=Object(Z.v)(n.props.localizationAPI),o=Object(Z.u)(a,n.props.localizationAPI));var u=Object(se.c)(c,n.hasNonInteractiveDisplayMode(),null==t?void 0:t.colors);return s.createElement("div",{className:u.taskTopperContainer,id:ee.k({id:n.props.id,renderContextType:i})},s.createElement(J.a,{content:Object(Z.p)(ae.c(n.props.completion),n.props.localizationAPI),tooltipProps:ie.a,id:X.b},n.renderTaskTopper(l,u,a,o)),n.getStyledHeaderText(r,u))},n.onClick=n.onClick.bind(n),n}return Object(o.__extends)(t,e),t.prototype.hasNonInteractiveDisplayMode=function(){return this.props.displayMode===P.ReadOnly||this.props.displayMode===P.Disabled},t.prototype.hasReadOnlyDisplayMode=function(){return this.props.displayMode===P.ReadOnly},t.prototype.onClick=function(){this.props.onResolveTaskCheckboxPressed&&this.props.onResolveTaskCheckboxPressed(this.props.id)},t.prototype.getStyledHeaderText=function(e,t){var n=Object(p.c)(this.props.assignees)||!this.props.assignees||0===this.props.assignees.length?this.renderAssignedToYouLabel(t,e):this.renderAssignedToPersonLabel(t);return s.createElement(J.a,{content:Object(Z.t)(this.props.assignees,this.props.localizationAPI),tooltipProps:ie.a,id:X.b},n)},t.prototype.renderAssignedToYouLabel=function(e,t){return s.createElement("div",{className:this.hasReadOnlyDisplayMode()?e.readOnlyTaskLabel:e.taskLabel},s.createElement("span",{className:e.taskTopperCheckbox.text},t))},t.prototype.renderAssignedToPersonLabel=function(e){var t,n,r,o=this,i=this.props.localizationAPI.getString(111),a=this.props.assignees.length>1?this.props.localizationAPI.getString(251):(n=function(t,n){return o.renderAssigneeName(Object(p.k)(o.props.assignees[0]),n,e)},r=[],(t=i).replace(re,(function(e,o){var i,a=t+r.length;return(i=void 0!==o?n(0,a):e)&&r.push(i),""})),r);return s.createElement("div",{className:this.hasReadOnlyDisplayMode()?e.readOnlyTaskLabel:e.taskLabel},s.createElement("span",{className:e.taskTopperCheckbox.text},a))},t.prototype.renderAssigneeName=function(e,t,n){return s.createElement("span",{key:t,className:n.taskAssignee},e)},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,ne.a,M.a)},t.prototype.renderTaskTopper=function(e,t,n,r){return this.hasReadOnlyDisplayMode()?null:s.createElement($.a,{id:e,componentRef:this.props.taskTopperCheckboxRef,styles:t.taskTopperCheckbox,checked:n,"data-item-id":this.props.id,onChange:this.onClick,checkmarkIconProps:Object(oe.d)().CHECKMARK_ICON_TOPPER,disabled:this.hasNonInteractiveDisplayMode(),ariaLabel:r})},t}(s.PureComponent),ce=n(2084),pe=n(2125),ue={display:"flex",overflow:"hidden",marginBottom:"5px",flexDirection:"row",flexShrink:0,fontSize:"11px",outline:"none",wordBreak:"break-word"},de=Object(E.c)((function(e){var t,n,r,o;return{card:Object(W.eb)(ue,{marginLeft:pe.c+10,marginRight:pe.c+10,color:null!==(t=null==e?void 0:e.DraftWarning)&&void 0!==t?t:ce.c.red10}),post:Object(W.eb)(ue,{marginLeft:"3px",marginRight:"3px",color:null!==(n=null==e?void 0:e.DraftWarning)&&void 0!==n?n:ce.c.red10}),newcard:Object(W.eb)(ue,{marginLeft:"3px",marginRight:"3px",color:null!==(r=null==e?void 0:e.DraftWarning)&&void 0!==r?r:ce.c.red10}),postingtip:Object(W.eb)(ue,{marginLeft:"3px",marginRight:"3px",color:null!==(o=null==e?void 0:e.CtrlEnterTip)&&void 0!==o?o:q.a.GRAY_E})}})),fe=s.memo((function(e){var t,n,r=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,o=de(r),i=d.n(),a="";if(e.draftWarningState)a=Z.g(e.localizationAPI,e.draftWarningState.type),n=e.target===U.Card?i?o.newcard:o.card:o.post;else{if(!i||!e.defaultToPostingTip)return null;a=e.localizationAPI.getString(233),n=o.postingtip}return s.createElement("div",{"aria-label":a,className:n,id:e.id},a)})),he=n(351),me=n(534);!function(e){e[e.RootPost=1]="RootPost",e[e.ReplyPost=2]="ReplyPost",e[e.ViewMoreRepliesButton=3]="ViewMoreRepliesButton"}(Y||(Y={}));var ye,be=Y,ge=n(246),ve=Object(E.c)((function(e){var t,n,r;return{container:Object(W.eb)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap",margin:0,border:0,position:"relative"}),body:Object(W.eb)({fontFamily:"inherit",color:null!==(n=null==e?void 0:e.TaskBorder)&&void 0!==n?n:oe.b.TASK_BORDER,fontWeight:"normal",fontSize:"12px",lineHeight:16,marginLeft:"3px",userSelect:"text",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),icon:Object(W.eb)((t={color:null!==(r=null==e?void 0:e.TaskBorder)&&void 0!==r?r:oe.b.TASK_BORDER,fontSize:"12px",lineHeight:16,marginLeft:"3px",marginRight:"3px",height:16,width:12,minWidth:12},t[W.m]={color:"ButtonText"},t))}})),Ce=Object(W.eb)(ge.l,{selectors:(ye={},ye[W.m]={backgroundColor:"WindowText"},ye)}),Te=Object(E.c)((function(e,t){var n=function(e){var t,n;return Object(W.eb)({backgroundColor:null!==(t=null==e?void 0:e.BlueDot)&&void 0!==t?t:"#006BFF",borderRadius:"50%",borderWidth:2,borderColor:null!==(n=null==e?void 0:e.CardBackground)&&void 0!==n?n:"white",height:6,width:6,position:"absolute"},Ce)}(t);return{blueDotOnReply:Object(W.eb)(n,{left:27,top:36+16*e}),blueDotOnRoot:Object(W.eb)(n,{left:6,top:9+16*e}),blueDotOnViewMoreRepliesButton:Object(W.eb)(n,{left:5,top:11})}})),Oe=s.memo((function(e){var t,n=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,r=Te(e.historyItemCount,n),o="";switch(e.dotType){case be.RootPost:o=r.blueDotOnRoot;break;case be.ReplyPost:o=r.blueDotOnReply;break;case be.ViewMoreRepliesButton:o=r.blueDotOnViewMoreRepliesButton;break;default:Object(i.m)(e.dotType)}return s.createElement("span",{className:o})})),xe=function(e){var t;return Object(W.db)({rootFocused:Object(W.eb)({color:null!==(t=null==e?void 0:e.Text)&&void 0!==t?t:q.a.GRAY_H,outline:"none",border:"1px solid transparent",backgroundColor:"transparent"},ge.k)})},Se=Object(E.c)((function(e,t,n){var r,o,i,a,s=null!==(r=null==n?void 0:n.PrimaryButtonHovered)&&void 0!==r?r:q.a.GRAY_H,l=null!==(o=null==n?void 0:n.PrimaryButtonPressed)&&void 0!==o?o:s;return t&&(s=null!==(i=null==n?void 0:n.ExpandButtonTextResolvedHovered)&&void 0!==i?i:q.a.GRAY_H,l=null!==(a=null==n?void 0:n.ExpandButtonTextResolvedPressed)&&void 0!==a?a:s),Object(W.db)({root:Object(W.eb)({overflow:"visible",position:"relative",height:"28px",margin:0,padding:0,border:"1px solid transparent",backgroundColor:"transparent",boxSizing:"border-box",color:e,cursor:"pointer",flexShrink:0,outline:"none",selectors:{".ms-Fabric--isFocusVisible &:focus::after":ge.m}}),rootFocused:Object(W.eb)({color:e,outline:"none",border:"1px dotted",backgroundColor:"transparent"},ge.k),flexContainer:Object(W.eb)({justifyContent:"flex-start"}),textContainer:Object(W.eb)({flexGrow:0,flexShrink:0,margin:0,padding:0,marginLeft:"16px"}),label:Object(W.eb)({margin:0,padding:0,fontWeight:t?void 0:"bold",fontSize:"12px",lineHeight:"16px",fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif'}),rootHovered:Object(W.eb)({color:s,backgroundColor:"transparent"},ge.l),rootPressed:Object(W.eb)({color:l,backgroundColor:"transparent",outline:"none",border:"1px solid transparent"})})})),ke=Object(E.c)((function(e,t,n){var r,o,i=null!==(r=null==n?void 0:n.MoreRepliesColor)&&void 0!==r?r:e;return t&&(i=null!==(o=null==n?void 0:n.ExpandButtonTextResolved)&&void 0!==o?o:q.a.RESOLVED_CARD_TEXT),{moreRepliesContainer:Se(i,t,n),moreRepliesContainerRestrictFocus_deprecated:Object(W.db)(Se(i,t,n),xe(n),{color:i})}})),Pe=s.memo((function(e){var t,n,r=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,o=null!==(n=null==r?void 0:r.PrimaryButton)&&void 0!==n?n:Object(me.a)().primary,i=ke(o,e.isCardResolved,r),a=s.useCallback((function(t){!function(e,t){t(),e.stopPropagation}(t,e.onPress)}),[e.onPress]),l=s.useCallback((function(t){return function(e,t){Object(_.f)(e.key)===_.b.Enter&&(t(),e.stopPropagation())}(t,e.onPress)}),[e.onPress]);return s.createElement(he.a,{"aria-label":e.innerText,styles:!d.U()&&e.restrictControl_deprecated?i.moreRepliesContainerRestrictFocus_deprecated:i.moreRepliesContainer,tabIndex:e.isTabbable?0:-1,onClick:a,onKeyDown:l,id:e.id,text:e.innerText},e.unreadPostHidden?s.createElement(Oe,{dotType:be.ViewMoreRepliesButton,historyItemCount:0,renderContextType:e.renderContextType}):null)})),Ee=n(2120),je=n(401);function Ie(e){var t,n,r,o;return{icon:{color:null!==(r=null==e?void 0:e.DefaultButtonIcon)&&void 0!==r?r:q.a.GRAY_200},iconHovered:(t={},t[W.m]={color:"HighlightText"},t),rootFocused:(n={},n[W.m]={" .ms-Button-icon":{color:"HighlightText"}},n),iconDisabled:{color:null!==(o=null==e?void 0:e.DefaultButtonIconDisabled)&&void 0!==o?o:q.a.GRAY_100},rootDisabled:{backgroundColor:"transparent"},rootHovered:{backgroundColor:null==e?void 0:e.DefaultButtonHovered},rootPressed:{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}var we=Object(E.c)((function(e){return{defaultButton:Object(ge.o)(Ie(e))}})),Ae=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t.onClick=function(e){var n=t.props.onClick;if("function"==typeof n)return n(e)},t.renderWithContexts=function(e){var n=t.props.tooltipText;return n?s.createElement(J.a,{content:n,directionalHint:t.props.tooltipDirection,tooltipProps:ie.a,id:X.b},t.renderIconButton(e)):t.renderIconButton(e)},t}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"disabled",{get:function(){return!!this.props.disabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tabIndex",{get:function(){return this.props.isTabbable&&!this.disabled?0:-1},enumerable:!1,configurable:!0}),t.prototype.renderIconButton=function(e){var t=we(null==e?void 0:e.colors);return s.createElement(je.a,{styles:t.defaultButton,ariaLabel:this.props.accessibilityLabel,disabled:this.disabled,iconProps:{iconName:Object(Ee.b)(this.props.icon),styles:this.props.iconStyles},id:this.props.id,onBlur:this.props.onBlur,onFocus:this.props.onFocus,onKeyDown:this.props.onKeyDown,onClick:this.onClick,tabIndex:this.tabIndex,text:this.props.text})},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(s.PureComponent),Re={root:{width:12,height:16,lineHeight:18}},De=Object(W.db)(Re,{root:{height:14,lineHeight:14}}),_e=Object(W.db)(Re,{root:{width:16}}),Ne=Object(E.c)((function(e){var t,n=null==e?void 0:e.ResolvedCardTitle;return{resolvedCardButtonsDefaultIconContainerStyles:Object(W.eb)({margin:"1px 0px",selectors:{".ms-Button-icon, .ms-font-m":{color:n}}}),resolvedCardButtonsLastIconContainerStyles:Object(W.eb)({margin:"1px 4px 1px 0px",selectors:{".ms-Button-icon":{color:n}}}),resolvedCardButtonIconStyles:(t={},t[3]=Object(ge.j)(Re),t[16]=Object(ge.j)(De),t[25]=Object(ge.j)(_e),t),resolvedCardButtonIconDefaultStyles:Re}})),Me=l.a.memo((function(e){var t,n=e.actions,r=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,o=Ne(r),i=n.map((function(e,t){var r,i=t===n.length-1;return l.a.createElement("div",{key:"".concat(t+1,"-").concat(e.text),className:i?o.resolvedCardButtonsLastIconContainerStyles:o.resolvedCardButtonsDefaultIconContainerStyles},l.a.createElement(Ae,{accessibilityLabel:e.accessibilityLabel,disabled:e.disabled,icon:e.icon,iconStyles:null!==(r=o.resolvedCardButtonIconStyles[e.icon])&&void 0!==r?r:o.resolvedCardButtonIconDefaultStyles,id:e.id,isTabbable:e.isTabbable,onKeyDown:e.onKeyDown,onClick:e.onClick,text:"",tooltipDirection:e.tooltipDirection,tooltipText:Object(Ee.a)(e)}))}));return l.a.createElement(s.Fragment,null,i)}));Me.displayName="ResolvedCardButtons";var Be=n(175),Le=Object(E.c)((function(e){var t,n,r;return{resolvedCardContainer:Object(W.eb)({display:"flex",flexDirection:"row",alignItems:"center"}),resolvedCardIcon:Object(W.eb)((t={width:8,height:8,color:null!==(n=null==e?void 0:e.ResolvedCardTitle)&&void 0!==n?n:q.a.GRAY_160,lineHeight:8,margin:"10px 10px 10px 14px"},t[ge.e]={color:"ButtonText"},t)),resolvedCardLabel:Object(W.eb)({fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',fontWeight:W.l.semibold,color:null!==(r=null==e?void 0:e.ResolvedCardTitle)&&void 0!==r?r:q.a.GRAY_160,lineHeight:14})}})),Fe=s.memo((function(e){var t,n=Object(Ee.b)(20),r=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,o=Le(r),i=e.taskCompleter?e.localizationAPI.getStringOrUndefined(202):e.localizationAPI.getStringOrUndefined(197);return s.createElement("div",{className:o.resolvedCardContainer},n&&s.createElement(Be.a,{iconName:n,className:o.resolvedCardIcon}),s.createElement("div",{className:o.resolvedCardLabel},i))}));function He(e){return d.l()&&(e.postDisplayMode===x.a.Normal||e.postDisplayMode===x.a.Resolved)&&e.isNew}Fe.displayName="ResolvedCardLabel";var Ue,ze,Ke,Ve=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.getNewCandidateTaskAssignees=Object(z.a)((function(e,t){var n=Object(p.d)(e);return t&&Object(p.m)(n,t),n})),r.onEditorFocus=function(){!r.isActiveDraft()&&!r.isActiveReply()||r.isSelectionWithinCard()||(Object(a.k)().assertConditionTag(d.U(),"Should have selection in card with draft if NewSelectionInteractions off",572844239),r.props.onCardSelect(r))},r.notifyRenderedOnce=Object(K.a)((function(){r.props.onCardRendered&&r.props.onCardRendered(r.props)})),r.toggleExpansion=function(){r.props.cardCollapsedState===C.a.Collapsed?r.props.onCardSelectExpand(r,!0,!1):r.props.onCardCollapse(r)},r.renderExpandButton=function(e){var t=s.Children.count(r.props.children),n=r.props.displayMode===T.a.Resolved;if(!(r.props.cardCollapsedState===C.a.Expanded||t<=1||(!n||!d.l())&&t<=2)){var i=!1;if(d.l()&&r.props.children)for(var a=1;a<t;++a){var l=r.props.children[a];if(i||a===t-1&&!n)break;var c=l.props;i=!!l.props.postDisplayMode&&He(c)}var p=r.props.componentTreeId.renderContextType;return s.createElement(Pe,Object(o.__assign)({id:Object(ee.bb)({id:r.props.id,renderContextType:p}),innerText:Z.w(r.props.localizationAPI,t,n)||"",isCardResolved:n,isTabbable:r.props.isTabbable,preventDefaultKeyDownBehavior:r.props.preventDefaultKeyDownBehavior,renderContextType:p,restrictControl_deprecated:!!r.props.restrictActionControls_deprecated,key:"expandButton",unreadPostHidden:i},e))}},r.logCardRenderedOnce=Object(K.a)((function(){var e,t;null===(t=(e=Object(a.k)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(V.a)(Ue||(Ue=Object(o.__makeTemplateObject)(["CommentCardRendered"],["CommentCardRendered"]))),i.d.reserveTag(524100999),a.h.Info,a.c.ProductServiceUsage,Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.o)("RenderContextType",r.props.componentTreeId.renderContextType,a.d.SystemMetadata),Object(a.o)("CardDisplayMode",r.props.displayMode,a.d.SystemMetadata))})),r.getId=r.getId.bind(r),r.onTaskAssigneeUpdated=r.onTaskAssigneeUpdated.bind(r),r.onCardFocus=r.onCardFocus.bind(r),r}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e,t;this.props.onCardMounted(this.props),this.isActiveDraft()&&(null===(t=(e=Object(a.k)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(V.a)(ze||(ze=Object(o.__makeTemplateObject)(["DraftCardMount"],["DraftCardMount"]))),i.d.reserveTag(556827602),a.h.Info,a.c.ProductServiceUsage,Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.o)("RenderContextType",this.props.componentTreeId.renderContextType,a.d.SystemMetadata),Object(a.o)("CardDisplayMode",this.props.displayMode,a.d.SystemMetadata)))},t.prototype.componentWillUnmount=function(){var e,t;this.isActiveDraft()&&(null===(t=(e=Object(a.k)()).logDiagnosticTrace)||void 0===t||t.call(e,Object(V.a)(Ke||(Ke=Object(o.__makeTemplateObject)(["DraftCardUnmount"],["DraftCardUnmount"]))),i.d.reserveTag(556827603),a.h.Info,a.c.ProductServiceUsage,Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.o)("RenderContextType",this.props.componentTreeId.renderContextType,a.d.SystemMetadata),Object(a.o)("CardDisplayMode",this.props.displayMode,a.d.SystemMetadata)))},t.prototype.getId=function(){return this.props.id},t.prototype.isActiveReply=function(){return this.props.displayMode===T.a.Reply||this.props.displayMode===T.a.ReplyPreCommitPending},t.prototype.isActiveDraft=function(){return this.props.displayMode===T.a.Draft||this.props.displayMode===T.a.DraftPreCommitPending},t.prototype.onTaskAssigneeUpdated=function(e){this.props.onSelectedTaskAssigneeUpdated(e)},t.prototype.getTaskAssignerProps=function(){var e;if(this.props.supportsTaskCreation){var t=this.isActiveReply()&&!this.props.taskTopperProps;if((!t||d.c())&&this.props.currentMentionees){var n=t||this.isActiveDraft(),r=Z.q(this.props.localizationAPI,n),o=this.getNewCandidateTaskAssignees(this.props.currentMentionees,null===(e=this.props.taskTopperProps)||void 0===e?void 0:e.assignees),i=this.props.localizationAPI.getString(128);if(o&&0!==Object.keys(o).length)return{renderContextType:this.props.componentTreeId.renderContextType,id:this.props.id,label:r,candidateAssignees:o,isNewThread:this.isActiveDraft(),selectedAssignee:this.props.selectedTaskAssignee,onSelectedTaskAssigneeUpdated:this.onTaskAssigneeUpdated,pickerAriaLabel:i,assignerTooltip:this.props.localizationAPI.getString(182),preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,localizationAPI:this.props.localizationAPI,displayMode:this.props.displayMode,isTaskThread:!!this.props.taskTopperProps}}}},t.prototype.isSelectionWithinCard=function(){return this.props.selected||this.props.hasSelectedChild},t.prototype.renderDraftBoxMessage=function(e){if(!d.B())return null;var t=this.props.draftWarningState;return t||e?s.createElement(fe,{key:"draftBoxMessage",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:U.Card,id:t?Object(ee.u)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Object(ee.M)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:e}):null},t.prototype.onCardSaveDraft=function(e){e&&this.props.draftId&&this.props.onSaveDraft(this.getId(),e)},t.prototype.renderResolvedOrTaskTopperHelper=function(e){var t=this.props.taskTopperProps,n=e.resolvedButtonsProps,r=e.preventDefaultKeyDownBehavior;if(n||t){var i=this.props.componentTreeId.renderContextType,a=n&&n.length>0?s.createElement(Me,{actions:n,renderContextType:i,preventDefaultKeyDownBehavior:r}):void 0,l=t&&this.props.displayMode!==T.a.Resolved?s.createElement(le,Object(o.__assign)({},t,{taskTopperCheckboxRef:e.taskTopperCheckboxRef})):s.createElement(Fe,{localizationAPI:this.props.localizationAPI,renderContextType:i,taskCompleter:(null==t?void 0:t.assignees)&&t.assignees.length>0?t.assignees[0]:void 0});return s.createElement(G,Object(o.__assign)({leftElement:l,rightElement:a,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior},e.cardTopperContainerProps))}},t.prototype.onCardFocus=function(e){this.props.onCardFocus(this)},t.prototype.logCardRendered=function(){this.props.displayMode!==T.a.Loading&&this.logCardRenderedOnce()},t.DisplayName="CommentCard",t}(s.PureComponent),We=n(72),qe=n(1352),Qe=n(1216),Ge=n(645),Ye=n(1201),Je=n(1028),$e=Object(E.c)((function(e){var t,n,r,o,i,a,s,l,c,p,u,d,f;return{reactionButton:Object(W.db)({icon:(t={".LikeEmptyBorder":{fill:null!==(a=null==e?void 0:e.CommentLikeEmptyBorder)&&void 0!==a?a:"#3A3A38"},".LikeSolidBorder":{fill:null!==(s=null==e?void 0:e.CommentLikeSolidBorder)&&void 0!==s?s:"#0063B1"},".LikeSolidCenter":{fill:null!==(l=null==e?void 0:e.CommentLikeSolidCenter)&&void 0!==l?l:"#83BEEC"}},t[W.m]={".LikeEmptyBorder":{fill:"ButtonText"},".LikeSolidBorder":{fill:"ButtonText"},".LikeSolidCenter":{fill:"Highlight"}},t),rootPressed:(n={color:null!==(c=null==e?void 0:e.MenuIcon)&&void 0!==c?c:q.a.GRAY_H,outline:"none",border:"1px solid",boxSizing:"content-box",borderColor:null!==(p=null==e?void 0:e.CommonControlBorder)&&void 0!==p?p:ce.b.gray110,".ms-Fabric--isFocusVisible &:focus::after":ge.m,":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(q.a.FOCUS_BOX)}},n[W.m]={border:"1px solid"},n),root:(r={backgroundColor:"transparent",color:null!==(u=null==e?void 0:e.SubText)&&void 0!==u?u:q.a.GRAY_E,height:"16px",maxHeight:"16px",margin:1,padding:0,border:"1px solid transparent",position:"relative",boxSizing:"content-box",fontSize:"11px",".ms-Fabric--isFocusVisible &:focus::after":ge.m,":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(q.a.FOCUS_BOX)}},r[W.m]={border:"1px solid"},r)}),dropdown:Object(W.db)({root:(o={zIndex:"1",maxWidth:172,maxHeight:200,overflow:"auto",":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(q.a.FOCUS_BOX)},".LikeSolidBorder":{fill:null!==(d=null==e?void 0:e.CommentLikeSolidBorder)&&void 0!==d?d:"#0063B1"},".LikeSolidCenter":{fill:null!==(f=null==e?void 0:e.CommentLikeSolidCenter)&&void 0!==f?f:"#83BEEC"}},o[W.m]={":focus":{boxShadow:"none",outline:"1px solid ".concat(q.a.FOCUS_BOX)},".LikeSolidBorder":{fill:"ButtonText"},".LikeSolidCenter":{fill:"Highlight"}},o),calloutMain:{},beak:{},beakCurtain:{},container:{}}),reactorItem:Object(W.db)({root:(i={margin:"6px",":focus":{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(q.a.FOCUS_BOX)}},i[W.m]={":focus":{boxShadow:"none",outline:"1px solid ".concat(q.a.FOCUS_BOX)}},i),details:{},primaryText:{},secondaryText:{},tertiaryText:{},optionalText:{},textContent:{}})}})),Xe=n(439),Ze=n(744),et=n(1386),tt=n(39),nt=l.a.memo((function(e){return function(e){var t=l.a.useMemo((function(){return function(e){return e.map((function(e,t){return{text:Object(p.k)(e),secondaryText:e.UserId,itemID:t.toString()}}))}(e.userList)}),[e.userList]),n=Object(M.b)(),r=$e(null==n?void 0:n.colors),i=r.reactorItem,a=Object(ee.o)(e.reactionButtonId),s=l.a.useCallback((function(){var t=document.getElementById(e.reactionButtonId);t&&t.focus()}),[e.reactionButtonId]),c=l.a.useCallback((function(n){if(Object(_.f)(n.key)===_.b.ArrowDown){var r=(o=u(n.target))>=t.length-1?0:o+1;(i=document.getElementById(Object(ee.m)(a,r)))&&i.focus()}else if(Object(_.f)(n.key)===_.b.ArrowUp){var o,i,s=(o=u(n.target))<=0?t.length-1:o-1;(i=document.getElementById(Object(ee.m)(a,s)))&&i.focus()}else if(Object(_.f)(n.key)===_.b.Escape){var l=document.getElementById(e.reactionButtonId);l&&l.focus()}n.stopPropagation(),n.preventDefault()}),[t,a,e.reactionButtonId]);function u(e){if(!e)return 0;var t=e.dataset.index;return t?parseInt(t,10):0}var d=l.a.useCallback((function(e){Object(_.f)(e.key)!==_.b.Escape&&Object(_.f)(e.key)!==_.b.Tab||(s(),e.stopPropagation(),e.preventDefault())}),[s]),f=l.a.useCallback((function(e){null!==e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||s()}),[s]);return l.a.createElement(Ze.a,{id:a,target:"#".concat(e.reactionButtonId),isBeakVisible:!1,styles:r.dropdown,onKeyDown:d,onBlur:f,role:"application"},l.a.createElement("div",{style:{display:"flex",padding:"6px",gap:"9px"}},l.a.createElement(Xe.a,{iconName:Object(Ee.b)(23)}),l.a.createElement("span",null,e.reactionLabel)),l.a.createElement("div",{role:"list"},t.map((function(e,t){return l.a.createElement(et.a,Object(o.__assign)({},e,{id:Object(ee.m)(a,t),"data-index":t,key:e.itemID,size:tt.c.size24,styles:i,tabIndex:0,role:"listitem",onKeyDown:c}))}))))}(e)})),rt=function(e){var t,n,r=Object(o.__read)(Object(s.useState)(!1),2),i=r[0],a=r[1],c=Object(o.__read)(Object(s.useState)(!1),2),p=c[0],u=c[1],d=l.a.useCallback((function(){p||a(!0)}),[p]),f=l.a.useCallback((function(){p||a(!1)}),[p]),h=l.a.useCallback((function(){a(!p),u(!1)}),[p]),m=Object(M.b)(),y=$e(null==m?void 0:m.colors),b=function(e,t){if(e){var n=e[t];return n&&n.length>0?n.length.toString():void 0}}(e.usersByReactionType,N.a.Like),g=Object(ee.n)({id:e.commentId,renderContextType:e.renderContextType}),v=Object(ee.o)(g),C=Object(ee.O)(g),T=Object(Ee.b)(function(e,t){if(!e)return!1;var n=e[t];return!!n&&n.some((function(e){return e.IsCurrentUser}))}(e.usersByReactionType,N.a.Like)?23:22),O=l.a.useCallback((function(t){if(!e.preventReacting){var n=T===Object(Ee.b)(23);e.onReactionPressed(e.commentId,!n,N.a.Like),t.stopPropagation(),t.preventDefault()}}),[e,T]),x=l.a.useCallback((function(e){Object(Je.b)(e.key)===Ye.a.ArrowDown&&e.altKey&&(u(!0),e.stopPropagation(),e.preventDefault()),Object(Je.b)(e.key)===Ye.a.Escape&&(f(),e.stopPropagation(),e.preventDefault())}),[f]);return Object(s.useEffect)((function(){if(p){var e=document.getElementById(Object(ee.m)(v,0));e&&e.focus()}}),[v,p]),l.a.createElement(J.a,{content:null===(t=e.buttonStrings)||void 0===t?void 0:t.buttonLabel,directionalHint:I.a.topCenter,tooltipProps:ie.a,id:X.b},l.a.createElement("span",{id:C,hidden:!0},function(t){var n,r,o;if(t){var i=parseInt(t,10);if(0!==i&&!isNaN(i))return"".concat(t," ").concat(i>1?null===(n=e.buttonStrings)||void 0===n?void 0:n.buttonLabelPlural:null===(r=e.buttonStrings)||void 0===r?void 0:r.buttonLabel,". ").concat(null===(o=e.buttonStrings)||void 0===o?void 0:o.buttonA11yDropdownText)}}(b)),l.a.createElement(Ge.a,{toggle:!0,id:g,ariaLabel:null===(n=e.buttonStrings)||void 0===n?void 0:n.buttonLabel,role:"button",styles:y.reactionButton,onClick:O,tabIndex:e.isTabbable?0:-1,onFocus:h,onBlur:f,iconProps:{iconName:T},checked:T===Object(Ee.b)(23),onMouseEnter:d,onMouseLeave:f,onKeyDown:x,"aria-describedby":C},b,function(t){var n,r;if(!i||!e.usersByReactionType)return null;var a=null!==(n=e.usersByReactionType[N.a.Like])&&void 0!==n?n:[];if(0===a.length)return null;var s={userList:a,reactionButtonId:t,reactionLabel:null===(r=e.buttonStrings)||void 0===r?void 0:r.buttonLabel};return l.a.createElement(nt,Object(o.__assign)({},s))}(g)))},ot=l.a.memo((function(e){return Qe.b(d.a,e,rt)})),it=Object(E.c)((function(e,t){var n,r,o,i,a,s,l,c,p;return{iconContextMenuAnchor:{menuIconDisabled:{color:null!==(o=null==e?void 0:e.MenuIconDisabled)&&void 0!==o?o:q.a.GRAY_C},menuIcon:(n={color:null!==(i=null==e?void 0:e.MenuIcon)&&void 0!==i?i:q.a.GRAY_F,margin:0,width:"16px"},n[W.m]={color:"ButtonText"},n),menuIconPressed:{color:null!==(a=null==e?void 0:e.MenuIconHoveredPressed)&&void 0!==a?a:q.a.GRAY_J},menuIconHovered:Object(W.eb)({color:null!==(s=null==e?void 0:e.MenuIconHoveredPressed)&&void 0!==s?s:q.a.GRAY_J},ge.l),rootPressed:{backgroundColor:null==e?void 0:e.DefaultButtonPressed},rootHovered:Object(W.eb)({backgroundColor:null==e?void 0:e.DefaultButtonHovered},ge.l),rootFocused:Object(W.eb)({backgroundColor:null==e?void 0:e.DefaultButton,outline:"none",border:"1px solid",borderColor:null!==(l=null==e?void 0:e.CommonControlBorder)&&void 0!==l?l:ce.b.gray110},ge.k),root:{flexShrink:0,height:"10px",width:"20px",minWidth:"20px",border:"1px solid transparent",padding:0,margin:0,backgroundColor:null==e?void 0:e.DefaultButton,selectors:{".ms-Fabric--isFocusVisible &:focus::after":ge.m,".ms-Button-flexContainer":{position:"relative"}}}},menuItem:Object(W.eb)({overflow:"hidden",margin:0,padding:0,selectors:(r={".ms-Button":{color:null==e?void 0:e.Text,selectors:{":hover":{backgroundColor:null==e?void 0:e.DefaultButtonHovered},":active":{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}},r[W.m]={".ms-Button:hover":{color:"HighlightText",backgroundColor:"Highlight"},".ms-Button:active":{color:"Field",backgroundColor:"FieldText"},".ms-Button":{color:"ButtonText",backgroundColor:"ButtonFace"}},r)}),contextMenu:Object(W.eb)({backgroundColor:null==e?void 0:e.CardBackground,minWidth:30,maxWidth:172,paddingTop:"6px",paddingBottom:"6px",margin:0,overflow:"hidden",selectors:{".ms-FocusZone.ms-ContextualMenu.is-open":Object(W.eb)({display:"flex",alignContent:"flex-end",alignItems:"flex-end",justifyContent:"flex-end",minWidth:30})}}),calloutStyle:{root:{borderColor:null!==(c=null==e?void 0:e.CardBorder)&&void 0!==c?c:q.a.COMMENTS_GRAY,boxShadow:null!==(p=null==t?void 0:t.BoxShadowLevel2)&&void 0!==p?p:ge.a.LEVEL2}}}})),at=Object(E.c)((function(){var e;return{root:(e={margin:"3px",padding:0,paddingLeft:"7px",paddingRight:"7px",border:"1px transparent",color:q.a.GRAY_E,backgroundColor:"transparent",cursor:"pointer",height:"unset",boxSizing:"border-box",textAlign:"left",minWidth:"30px",maxWidth:166,width:"95%"},e[W.m]={color:"ButtonText"},e),rootHovered:ge.l,rootFocused:ge.k,textContainer:{flexGrow:0,flexShrink:0},flexContainer:{justifyContent:"flex-start"},label:{fontSize:"12px",fontWeight:"600",textAlign:"left",fontFamily:"inherit",lineHeight:"20px",maxWidth:122,margin:0,marginLeft:"5px",marginRight:"10px",padding:0,border:0}}}));function st(e){e&&e.focus()}var lt=s.memo((function(e){var t=at();return s.createElement(he.a,{componentRef:e.data?st:void 0,id:e.id,iconProps:{iconName:e.iconName,style:{width:12,height:12,marginTop:"-4px"}},key:e.key,role:"menuitem",ariaLabel:"".concat(e.name),styles:t,"data-is-focusable":!0,onKeyDown:e.onKeyDown,onClick:function(t){e.onClick&&e.onClick(t),e.dismissMenu(t)}},e.name)}));function ct(e,t,n,r,o,i,a){e>0&&i(dt(t,it(null==a?void 0:a.colors,null==a?void 0:a.styles),n,r,o))}var pt=s.memo((function(e){var t=Object(o.__read)(s.useState([]),2),n=t[0],r=t[1],i=Object(M.b)(),a=it(null==i?void 0:i.colors,null==i?void 0:i.styles);return Qe.a(ct,n.length,e.parentId,e.renderContextType,e.itemType,e.menuItems,r,i),s.createElement(J.a,{content:e.title,tooltipProps:ie.a,id:X.b},function(e,t,n,r,o){var i=s.useCallback((function(t,i){return function(e,t,n,r,o,i){var a;r.length<1&&o(dt(n.parentId,it(null==i?void 0:i.colors,null==i?void 0:i.styles),n.renderContextType,n.itemType,n.menuItems)),null===(a=n.onMenuClick)||void 0===a||a.apply(void 0)}(0,0,e,n,r,o)}),[e,n,r,o]),a=s.useCallback((function(e){e.stopPropagation()}),[]);return s.createElement(je.a,{id:e.id,ariaLabel:e.ariaLabel,styles:t.iconContextMenuAnchor,onMenuClick:i,onFocus:a,menuProps:{ariaLabel:e.ariaLabel,className:t.contextMenu,directionalHint:I.a.bottomRightEdge,gapSpace:2,isBeakVisible:!1,shouldFocusOnMount:!1,calloutProps:{styles:t.calloutStyle,finalHeight:1},items:n},menuIconProps:{iconName:Object(Ee.b)(7),style:{width:16}},tabIndex:e.tabIndex})}(e,a,n,r,i))}));function ut(e,t,n){t.onClick(e),n&&n.stopPropagation()}function dt(e,t,n,r,o){return r===F.CardContextMenuItem&&o&&o.length>0?o.map((function(r,i){return{id:ee.r({id:e,renderContextType:n},r.id||r.text),key:r.id||r.text,iconName:Object(Ee.b)(r.icon),name:r.text,data:0===i,className:t.menuItem,onClick:function(t){return ut(e,r,t)},onKeyDown:function(t){return function(e,t,n,r,o,i){if(Object(Je.b)(i.key)===Ye.a.ArrowDown&&0===o){var a=n.id||n.text||"MissingKey",s=document.getElementById(ee.r({id:e,renderContextType:r},a));if(i.target===s&&t&&t.length>1){var l=t[1].id||t[1].text,c=document.getElementById(ee.r({id:e,renderContextType:r},l));c&&(c.focus(),i.preventDefault(),i.stopPropagation())}}else Object(Je.b)(i.key)===Ye.a.Tab&&(i.preventDefault(),i.stopPropagation())}(e,o,r,n,i,t)},onRender:yt}})):r===F.ActionBarItem&&o&&o.length>0?o.map((function(r,i){return{id:ee.a({id:e,renderContextType:n},i),key:r.text,iconName:Object(Ee.b)(r.icon),name:r.text,data:0===i,className:t.menuItem,onClick:function(t){return ut(e,r,t)},onKeyDown:function(t){return function(e,t,n,r){if(Object(Je.b)(r.key)===Ye.a.ArrowDown){var o=document.getElementById(ee.a({id:e,renderContextType:n},0));if(r.target===o&&t&&t.length>1){var i=document.getElementById(ee.a({id:e,renderContextType:n},1));i&&(i.focus(),r.preventDefault(),r.stopPropagation())}}else Object(Je.b)(r.key)===Ye.a.Tab&&(r.preventDefault(),r.stopPropagation())}(e,o,n,t)},onRender:yt}})):[]}var ft,ht,mt,yt=Object(E.c)((function(e,t){var n=Object(o.__assign)(Object(o.__assign)({},e),{dismissMenu:t});return s.createElement(lt,Object(o.__assign)({},n))})),bt=pt,gt={fontWeight:"600",alignSelf:"baseline",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",marginLeft:"3px",userSelect:"text",fontFamily:"".concat(ge.g,", ").concat(ge.h,", ").concat(ge.i,", Arial, Verdana, sans-serif"),marginBottom:"1px",fontSize:"14px",lineHeight:"19px",flex:"4 1 auto"},vt=Object(E.c)((function(){return{author:Object(W.eb)(gt),header:Object(W.eb)({display:"flex",direction:"inherit",overflow:"hidden",flexDirection:"row",flexWrap:"nowrap",height:20})}})),Ct=Object(E.c)((function(e,t){return Object(a.k)().assertConditionTag(!!e.localizationAPI,"LocalizationAPI must be present when rendering context menu",595710280),{id:ee.I({id:e.parentId,renderContextType:t}),parentId:e.parentId,title:e.localizationAPI?e.localizationAPI.getString(123):"",ariaLabel:e.localizationAPI?e.localizationAPI.getString(123):"",onMenuClick:Tt(e),tabIndex:e.isTabbable?0:-1,renderContextType:t,menuItems:e.actionBarItems,itemType:F.ActionBarItem}}),5),Tt=Object(E.c)((function(e){return function(t){e.trySelectPost(),t&&Object(_.f)(t.key)===_.b.ArrowDown&&t.preventDefault()}})),Ot=s.memo((function(e){var t=vt();return s.createElement("div",{className:t.header},s.createElement("div",{className:t.author},e.authorLine),function(e){return!e.contextMenuProps||0===e.contextMenuProps.menuItems.length&&0===e.contextMenuProps.actionBarItems.length?null:s.createElement(bt,Object(o.__assign)({},Ct(e.contextMenuProps,e.renderContextType)))}(e),e.reactionButtonProps?s.createElement(ot,Object(o.__assign)({},e.reactionButtonProps)):void 0)})),xt=n(768),St=n(2655),kt=n(2621),Pt={fontFamily:"inherit",justifyContent:"center",selectors:(ft={},ft[".ms-Persona-initials"]={selectors:(ht={},ht[W.m]={color:"WindowText"},ht)},ft)},Et=Object(E.c)((function(e){var t,n;return{persona:Object(W.eb)(Pt,{selectors:(t={},t[".ms-Persona-initials"]={color:null==e?void 0:e.PersonaInitialsTextColor},t)}),personaResolved:Object(W.eb)(Pt,{selectors:{selectors:(n={},n[".ms-Persona-initials"]={color:null==e?void 0:e.PersonaInitialsTextColorResolved},n)}}),personaRootContainer:Object(W.eb)({margin:8,marginLeft:6,position:"absolute",left:"-15px"}),personaContainer:Object(W.eb)({margin:4,marginLeft:9,marginRight:3})}})),jt=s.memo((function(e){var t,n,r,i=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,l=Et(i),c=Object(kt.b)(),p=null!==(n=null==i?void 0:i.PersonaColorResolved)&&void 0!==n?n:q.a.GRAY_70,u=null!==(r=null==i?void 0:i.PersonaInitialsTextColorResolved)&&void 0!==r?r:q.a.GRAY_140,f={text:e.authorName,coinSize:20,initialsColor:e.resolved?p:e.authorColor||tt.a.purple,initialsTextColor:e.resolved?u:void 0,hidePersonaDetails:!0},h=Object(a.k)().getMetadata(),m="-4"===h.ring&&"DC2"===h.dataCenter?f:Object(o.__assign)(Object(o.__assign)({},f),{imageShouldStartVisible:!0,imageUrl:e.authorImageURL,showInitialsUntilImageLoads:!0}),y=s.useMemo((function(){return{personaInfo:{identifiers:{Smtp:e.authorEmail,PersonaType:"User"},displayName:e.authorName},behavior:{onCardOpen:void 0,onCardClose:void 0,disableHover:!0},tabIndex:c&&e.isTabbable?0:-1,clientScenario:"SharedComments"}}),[c,e.isTabbable,e.authorEmail,e.authorName]),b=d.x()&&window.LivePersonaCardHoverTargetV2?s.createElement(window.LivePersonaCardHoverTargetV2,{cardParameters:y}):void 0;return s.createElement("div",{className:e.isParent?l.personaRootContainer:l.personaContainer,style:e.opacity?{opacity:e.opacity}:void 0},Object(St.a)(s.createElement(xt.a,Object(o.__assign)({},m,{className:e.resolved?l.personaResolved:l.persona})),b))})),It=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.getStyles=function(e){return Object(qe.b)(null==e?void 0:e.colors,null==e?void 0:e.styles)},r.renderWithContexts=function(e,t){r.styles=r.getStyles(t);var n=[],i=r.props.displayMode===T.a.Draft||r.props.displayMode===T.a.DraftPreCommitPending,a=e.renderContextType;if(r.props.anchorText){var l=ee.b({id:r.props.id,renderContextType:a});n.push({element:s.createElement("div",{id:l,className:r.styles.anchor},r.props.anchorText),visibility:!0,key:l})}if(i){var c=ee.t({id:r.props.id,renderContextType:a});n.push({element:r.renderDraftCancelButton(a),visibility:!0,key:c})}else if(r.props.contextMenuProps&&r.props.contextMenuProps.menuItems.length>0&&n.push({element:s.createElement(bt,Object(o.__assign)({},r.props.contextMenuProps)),visibility:!r.props.hideActions,key:r.props.contextMenuProps.id}),r.props.reactionButtonProps&&1===r.props.rootAuthorOpacity){var p=ee.n({id:r.props.id,renderContextType:a}),u=r.props.reactionButtonProps.usersByReactionType&&r.props.reactionButtonProps.usersByReactionType[We.g.Like]?r.props.reactionButtonProps.usersByReactionType[We.g.Like]:[];n.push({element:s.createElement(ot,Object(o.__assign)({},r.props.reactionButtonProps)),visibility:u.length>0||!r.props.preventReacting&&!r.props.hideActions,key:p})}var d=n.map((function(e){return s.createElement("div",{key:e.key,className:e.visibility?r.styles.headerItem:r.styles.hiddenHeaderItem},e.element)})),f=1===r.props.rootAuthorOpacity?void 0:{boxShadow:"0px 2px 4px 0px rgba(0, 0, 0, ".concat(.13*(1-r.props.rootAuthorOpacity),")")};return s.createElement("div",{className:r.styles.headerContainer,style:f},r.renderRootPersona(),r.renderRootLabel(a),d.length?s.createElement("div",{className:i?r.styles.headerRightCornerDraft:r.styles.headerRightCorner},d):void 0)},r.render=function(){return Object(te.a)(r.renderWithContexts,ne.a,M.a)},r.cancelDraftButtonKeyDownHandler=r.cancelDraftButtonKeyDownHandler.bind(r),r.cancelDraftButtonClickHandler=r.cancelDraftButtonClickHandler.bind(r),r}return Object(o.__extends)(t,e),t.prototype.cancelDraftButtonClickHandler=function(e){this.props.onCancelDraft(),e.stopPropagation()},t.prototype.cancelDraftButtonKeyDownHandler=function(e){Object(_.f)(e.key)===_.b.Enter&&(this.props.onCancelDraft(),e.stopPropagation(),e.preventDefault())},t.prototype.renderDraftCancelButton=function(e){return s.createElement(J.a,{content:this.props.localizationAPI.getString(15),tooltipProps:ie.a,id:X.b},this.renderDraftCancelButtonInternal(e))},t.prototype.renderDraftCancelButtonInternal=function(e){return s.createElement("div",{className:this.styles.cancelDraftContainer},s.createElement(je.a,{id:ee.t({id:this.props.id,renderContextType:e}),styles:this.styles.cancelDraftButton,disabled:!1,onClick:this.cancelDraftButtonClickHandler,onKeyDown:this.cancelDraftButtonKeyDownHandler,iconProps:{iconName:"CancelGlyph"},tabIndex:d.U()&&!this.props.isTabbable?-1:void 0,ariaLabel:this.props.localizationAPI.getString(15)}))},t.prototype.renderRootPersona=function(){if(0===this.props.rootAuthorOpacity)return null;var e={authorName:Object(p.k)(this.props.author),resolved:this.props.isResolvedCard,isParent:!0,authorEmail:this.props.author.Email,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,opacity:this.props.rootAuthorOpacity,isTabbable:this.props.isTabbable};return s.createElement(jt,Object(o.__assign)({},e))},t.prototype.renderRootLabel=function(e){if(0===this.props.rootAuthorOpacity)return null;var t={authorLine:Object(p.k)(this.props.author),renderContextType:e};return s.createElement("div",{className:this.styles.headerAuthorContainer,style:{opacity:this.props.rootAuthorOpacity}},s.createElement(Ot,Object(o.__assign)({},t)))},t}(s.PureComponent),wt=n(43),At=Object(E.c)((function(e){var t,n;return{atMentionAriaContainer:Object(W.eb)({marginTop:"".concat(10,"px")}),atMentionMessageContainer:Object(W.eb)({backgroundColor:null!==(t=null==e?void 0:e.AtMentionMessageBackground)&&void 0!==t?t:"#F0F0F0"}),atMentionMessage:Object(W.eb)({fontSize:wt.a.size12,lineHeight:wt.a.size14,color:null!==(n=null==e?void 0:e.AtMentionMessageText)&&void 0!==n?n:q.a.GRAY_160}),atMentionUberMessageContainer:Object(W.eb)({padding:"".concat(12,"px"),display:"flex"})}})),Rt=Object(E.c)((function(e){var t=[];if(!e)return t;for(var n in e){var r=e[n];if(r&&r.stillInDraft){var o=Object(p.g)(r.mentionee);o&&t.push(o)}}return t})),Dt=l.a.memo((function(e){var t=Object(ne.b)().renderContextType,n=Object(M.b)(),r=At(null==n?void 0:n.colors),i=Object(ee.c)({id:e.commentId,renderContextType:t}),a=l.a.useMemo((function(){return function(e,t){var n,r,i,a,s=[e];try{for(var l=Object(o.__values)(t),c=l.next();!c.done;c=l.next()){var p=c.value,u=[];try{for(var d=(i=void 0,Object(o.__values)(s)),f=d.next();!f.done;f=d.next())for(var h=f.value.split(p),m=0;m<h.length;++m)u.push(h[m]),m!==h.length-1&&u.push(p)}catch(e){i={error:e}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}s=u}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}return s}(e.mentionedNotificationUberString,e.mentionedNames)}),[e.mentionedNotificationUberString,e.mentionedNames]);return l.a.createElement("div",{className:r.atMentionMessageContainer,id:i},l.a.createElement("div",{className:r.atMentionUberMessageContainer},l.a.createElement("div",{className:r.atMentionMessage,"aria-label":e.mentionedNotificationUberString},a.map((function(t){return l.a.createElement("span",{key:t},e.mentionedNames.includes(t)?l.a.createElement("strong",null,t):t)})))))})),_t=n(143),Nt=n(568),Mt=n(1210),Bt=n(90),Lt=function(e){function t(t){var n=e.call(this,t)||this;return n.state={showLoadingUI:!1},n}return Object(o.__extends)(t,e),t.prototype.setTimer=function(){var e=this;this.timeout||(this.timeout=setTimeout((function(){e.setState({showLoadingUI:!0}),e.timeout=void 0}),this.props.delay))},t.prototype.clearTimer=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0)},t.prototype.componentDidMount=function(){this.props.isLoading&&this.setTimer()},t.prototype.componentWillUnmount=function(){this.clearTimer()},t.prototype.componentDidUpdate=function(e){!e.isLoading&&this.props.isLoading?this.setTimer():e.isLoading&&!this.props.isLoading&&(this.clearTimer(),this.setState({showLoadingUI:!1}))},t.prototype.render=function(){return this.state.showLoadingUI?this.props.loadingUI:s.Children.only(this.props.children)},t}(s.Component),Ft=n(1036),Ht={marginTop:"8px",zIndex:20,width:"32px",maxHeight:"30px",selectors:{"& .ms-Spinner-circle":{borderColor:Ft.a,borderTopColor:Ft.b}}},Ut={maxHeight:"24px",width:"37px",minWidth:"37px",padding:0,margin:1,marginRight:2,marginLeft:3},zt=Object(E.c)((function(e,t){var n,r,o,i,a,s,l,c,p;return{commitBar:Object(W.eb)({marginBottom:"5px",marginTop:"1px",maxHeight:"30px",display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"flex-end"}),primaryButton:Object(ge.o)({root:Object(W.eb)(Ut,{backgroundColor:null!==(n=null==t?void 0:t.PrimaryButton)&&void 0!==n?n:Object(me.a)().primary,borderColor:null!==(r=null==t?void 0:t.PrimaryButton)&&void 0!==r?r:Object(me.a)().primary},e&&{transform:"scaleX(-1)"}),rootPressed:{backgroundColor:null!==(o=null==t?void 0:t.PrimaryButtonPressed)&&void 0!==o?o:Object(me.a)().shade20,borderColor:null!==(i=null==t?void 0:t.PrimaryButtonPressed)&&void 0!==i?i:Object(me.a)().shade20},rootHovered:Object(W.eb)({backgroundColor:null!==(a=null==t?void 0:t.PrimaryButtonHovered)&&void 0!==a?a:Object(me.a)().shade10,borderColor:null!==(s=null==t?void 0:t.PrimaryButtonHovered)&&void 0!==s?s:Object(me.a)().shade10}),rootFocused:Object(W.eb)({backgroundColor:null!==(l=null==t?void 0:t.PrimaryButton)&&void 0!==l?l:Object(me.a)().shade10,borderColor:null!==(c=null==t?void 0:t.PrimaryButton)&&void 0!==c?c:Object(me.a)().shade10}),icon:{width:16,color:null==t?void 0:t.PrimaryButtonIcon}}),defaultButton:Object(ge.o)({root:Object(W.eb)(Ut,{borderColor:null!==(p=null==t?void 0:t.CommonControlBorder)&&void 0!==p?p:ce.b.gray110,backgroundColor:null==t?void 0:t.DefaultButton}),rootPressed:{backgroundColor:null==t?void 0:t.DefaultButtonPressed},rootHovered:{backgroundColor:null==t?void 0:t.DefaultButtonHovered},icon:{color:null==t?void 0:t.DefaultButtonIcon,height:"12px",marginBottom:"1px",width:"16px",lineHeight:"12px"}}),icon:{fontFamily:"inherit"}}})),Kt=function(e){function t(t){var n=e.call(this,t)||this;return n.getStyles=function(e){return zt(Object(_t.a)(),null==e?void 0:e.colors)},n.renderWithContexts=function(e){return n.styles=n.getStyles(e),s.createElement("div",{className:n.styles.commitBar},n.renderTaskAssigner(),n.renderCommitButtons(n.props.buttons,n.props.tooltipDirection))},n.renderCommitButtons=Object(E.c)((function(e,t){return void 0===e&&(e=[]),e.map((function(e,r){return s.createElement(J.a,{key:r,id:X.b,content:e.disabled?void 0:Object(Ee.a)(e),directionalHint:t,tooltipProps:ie.a},s.createElement(Lt,{delay:ge.f,isLoading:!!e.showDelayedSpinner,key:r,loadingUI:s.createElement(A.a,{size:R.a.small,className:Ht})},e.usePrimaryButtonStyling?s.createElement(Nt.a,Object(o.__assign)({},n.getCommitButtonProps(e))):s.createElement(he.a,Object(o.__assign)({},n.getCommitButtonProps(e)))))}))}),5),n.getCommitButtonProps=Object(E.c)((function(e){return{id:e.id,disabled:e.disabled,onClick:e.onClick,onKeyDown:e.onKeyDown,ariaLabel:e.accessibilityLabel,tabIndex:e.isTabbable?void 0:-1,iconProps:{iconName:Object(Ee.b)(e.icon),style:n.styles.icon},styles:n.getCommitButtonStyles(!!e.usePrimaryButtonStyling)}}),5),n.getCommitButtonStyles=function(e){return e?n.styles.primaryButton:n.styles.defaultButton},n.getCommitButtonProps=n.getCommitButtonProps.bind(n),n.renderCommitButtons=n.renderCommitButtons.bind(n),n.state={},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;d.b()&&Object(Mt.a)().then((function(t){t?e.setState({taskAssigner:t.TaskAssigner}):Object(a.k)().assertConditionTag(!1,"Unable to load lazy at mention components.",577066527)})).catch(Object(Bt.a)(i.d.reserveTag(595632141)))},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t.prototype.renderTaskAssigner=function(){return this.props.taskAssigner&&this.state.taskAssigner?s.createElement(this.state.taskAssigner,Object(o.__assign)({},this.props.taskAssigner)):null},t}(s.PureComponent),Vt=n(821);function Wt(e){var t=e;return void 0!==t.onMentionCreated&&void 0!==t.onMentioneesStillInDraftUpdated&&void 0!==t.correlationId}!function(e){e[e.ReadOnlyComment=0]="ReadOnlyComment",e[e.DisabledComment=1]="DisabledComment",e[e.DisabledEditor=2]="DisabledEditor"}(mt||(mt={}));var qt=n(820),Qt=n(2743),Gt=n.n(Qt),Yt=Gt.a.import("delta"),Jt=Gt.a.import("parchment"),$t=Gt.a.import("blots/inline"),Xt=(Gt.a.import("formats/link"),Gt.a.import("modules/clipboard")),Zt=Gt.a.import("blots/block/embed"),en=Gt.a;function tn(e){return!!e&&e.tagName===nn.tagName&&e.className===nn.className&&"false"===e.contentEditable&&void 0!==e.href}var nn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.create=function(n){var r=JSON.parse(n),o=!!r.editable;delete r.editable;var i=JSON.stringify(r),a=e.create.call(this,i);return a.setAttribute(t.getDataAttributeName(),i),a.setAttribute("href",this.addURLProtocolIfNeeded(r.url)),a.setAttribute("contenteditable",o.toString()),a.setAttribute("class",t.className),a.setAttribute("className",t.className),a.setAttribute("rel","noreferrer"),a.setAttribute("target","_blank"),a.setAttribute("title",r.url),a.setAttribute("tabindex","-1"),a.addEventListener("click",t.onHyperlinkClicked),a},t.onHyperlinkClicked=function(e){var t=e.target;if(tn(t)){Object(a.k)().createActivityObject("DraftHyperlinkClicked",Object(a.l)(a.g.GlobalAPI),Object(a.n)({aggregationMode:a.a.OnSuccess})).successTag(562438278);var n=t.href;Object(qt.c)().onHyperlinkClick(n)&&e.preventDefault()}},t.formats=function(e){return e.getAttribute(this.getDataAttributeName())||(e.href?JSON.stringify({url:this.addURLProtocolIfNeeded(e.href),editable:!0}):void 0)},t.prototype.format=function(n,r){n===t.blotName&&r?this.domNode.setAttribute(t.getDataAttributeName(),r):e.prototype.format.call(this,n,r)},t.prototype.formats=function(){var n=e.prototype.formats.call(this);return n[t.blotName]=t.formats(this.domNode),n},t.getDataAttributeName=function(){return"data-hyperlink"},t.addURLProtocolIfNeeded=function(e){return e.toLowerCase().startsWith("www.")?"https://".concat(e):e},t.blotName="hyperlink",t.tagName="a",t.className="sharedcomments-hyperlink",t}($t);function rn(e){var t,n={width:"100%",textAlign:"left",padding:"4px 0px 4px 8px",height:"16px",color:null!==(t=null==e?void 0:e.SmartRepliesText)&&void 0!==t?t:ce.b.gray140,backgroundColor:null==e?void 0:e.CardBackground,fontFamily:"Segoe UI",fontSize:wt.a.size12,fontWeight:"400",lineHeight:"16px"};return Object(W.eb)(n)}function on(e){var t,n;return Object(W.eb)(rn(e),{backgroundColor:null!==(t=null==e?void 0:e.SuggestedItem)&&void 0!==t?t:q.a.SUGGESTED_PICKER_ITEM,":hover":{backgroundColor:null!==(n=null==e?void 0:e.SuggestedItemHovered)&&void 0!==n?n:q.a.SUGGESTED_PICKER_ITEM_HOVER}})}function an(e){var t;return Object(W.eb)({padding:"5px 0px 5px 8px",height:"16px",color:null!==(t=null==e?void 0:e.ResolvedCardText)&&void 0!==t?t:ce.b.gray130,backgroundColor:null==e?void 0:e.CardBackground,fontFamily:"Segoe UI",fontSize:"11px",fontWeight:"400",lineHeight:"16px"})}function sn(e,t){var n,r;return Object(W.eb)({boxShadow:null==t?void 0:t.CalloutBoxShadow,selectors:{".ms-Button":{backgroundColor:null==e?void 0:e.CardBackground,color:null==e?void 0:e.Text,selectors:{span:{color:null==e?void 0:e.Text,selectors:{":hover":{backgroundColor:null==e?void 0:e.DefaultButtonHovered},":active":{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}}},".is-suggested":{selectors:{".ms-Button":{backgroundColor:null!==(n=null==e?void 0:e.SuggestedItem)&&void 0!==n?n:q.a.SUGGESTED_PICKER_ITEM,selectors:{":hover, span:hover":{backgroundColor:null!==(r=null==e?void 0:e.SuggestedItemHovered)&&void 0!==r?r:q.a.SUGGESTED_PICKER_ITEM_HOVER},":active, span:active":{backgroundColor:null==e?void 0:e.DefaultButtonPressed}}}}}}})}var ln,cn=Object(E.c)((function(e){var t,n,r;return{selectors:{":focus":{outline:"none"},"& .ql-editor":{boxSizing:"border-box",whiteSpace:"pre-wrap",height:"100%",outline:"none",overflow:"hidden",padding:"3px",paddingTop:2,paddingBottom:2,tabSize:"4",wordWrap:"break-word",userSelect:"text"},"& .ql-clipboard":{left:"-100000px",position:"absolute",top:"50%",height:"1px",userSelect:"text",overflowY:"hidden"},"& .ql-editor p":{margin:0,padding:0,userSelect:"text"},"& ol, ul":{padding:0,listStylePosition:"inside"},"& .ql-editor em, u, strong, span, a, s":{userSelect:"text"},"& .ql-editor.ql-blank::before":(t={color:null!==(r=null==e?void 0:e.SubText)&&void 0!==r?r:q.a.GRAY_E,content:"attr(data-placeholder)",fontStyle:"normal",fontFamily:"inherit",fontSize:"12px",marginLeft:"1px",pointerEvents:"none",position:"absolute"},t[W.m]={color:"ButtonText",backgroundColor:"ButtonFace"},t),"& .ql-color-blue":{color:"blue",textDecoration:"none",selectors:(n={},n[W.m]={textDecoration:"underline"},n)}}}})),pn={boxSizing:"border-box",flexGrow:"1",position:"relative",overflowY:"hidden"},un={boxSizing:"border-box",flexGrow:"1",overflowY:"hidden",position:"relative",margin:0,fontFamily:"inherit",fontSize:12,fontWeight:"normal",lineHeight:1.5.toString(),cursor:"text"},dn=Object(W.eb)(un,{maxHeight:96,overflowY:"auto",selectors:{"::-webkit-scrollbar":{width:0}}},{"-ms-overflow-style":"none","scrollbar-width":"none"}),fn={paddingBottom:"5px"},hn={minHeight:22,padding:7,paddingTop:"0px",paddingBottom:"2px",borderRadius:ge.c},mn={pointerEvents:"none",cursor:"default"};!function(e){e[e.lineHeight=18]="lineHeight",e[e.maxHeight=80]="maxHeight",e[e.verticalOffset=60]="verticalOffset"}(ln||(ln={}));var yn={},bn=Object(E.c)((function(e,t,n){var r,i,a,s,l=t?{background:null!==(i=null!=e?e:null==n?void 0:n.CardBackground)&&void 0!==i?i:q.a.WHITE,cursor:"pointer",color:null!==(a=null==n?void 0:n.PrimaryButton)&&void 0!==a?a:Object(me.a)().primary,fontWeight:"bold"}:{backgroundImage:"linear-gradient(".concat("rgba(255,255,255,0) 0%",", ").concat(null!==(s=null!=e?e:null==n?void 0:n.CardBackground)&&void 0!==s?s:q.a.WHITE,")"),selectors:(r={},r[W.m]={visibility:"hidden !important"},r)};return Object(W.eb)(Object(o.__assign)({position:"absolute",left:0,top:ln.verticalOffset,right:0,bottom:0,visibility:"hidden"},l),Cn)})),gn=Object(E.c)((function(e,t,n){var r,o,i,a,s,l;void 0===e&&(e=!1),void 0===t&&(t=!1);var c={backgroundColor:t?void 0:null!==(o=null==n?void 0:n.AtMentionHighlight)&&void 0!==o?o:ce.b.gray20,borderRadius:"2px",boxDecorationBreak:"clone",color:e||t?void 0:null!==(i=null==n?void 0:n.AtMentionText)&&void 0!==i?i:ce.b.gray180,cursor:"default",fontFamily:'"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',fontSize:"12px",fontWeight:"500",padding:"1px 3px",pointerEvents:"none",textDecoration:"none",selectors:(r={},r[W.m]={textDecoration:"underline"},r)},p=Object(W.eb)(c,{"-webkit-box-decoration-break":"clone"}),u=null!==(a=null==n?void 0:n.AtMentionToMeHighlight)&&void 0!==a?a:Object(me.a)().tint40,d=null!==(s=null==n?void 0:n.ResolvedCardBackground)&&void 0!==s?s:ce.b.gray20;return{selectors:{"& .atmention":p,"& .current-user > .atmention":t?p:Object(W.eb)(p,{color:e?void 0:null!==(l=null==n?void 0:n.AtMentionToMeText)&&void 0!==l?l:Object(me.a)().shade10,backgroundColor:e?d:u,fontWeight:"600"}),"& office-optional":{userSelect:"text"}}}})),vn=Object(E.c)((function(e){var t;return{selectors:(t={},t["& ".concat(nn.className)]={wordBreak:"break-all"},t),a:void 0!==e?{":not(.atmention)":{color:e.Hyperlink,":visited":{color:e.Hyperlink},":active":{color:e.HyperlinkActive}}}:void 0}})),Cn={selectors:{":focus":{outline:"none"}}},Tn=Object(E.c)((function(e,t,n,r,i,a,s,l){var c;c=t?hn:fn;var p=n?dn:un,u=[cn(s),gn(i,a,s),vn(s)];return{EditorWrapper:Object(W.eb)(pn),EditorContainerEditing:W.eb.apply(void 0,Object(o.__spreadArray)([p,c],Object(o.__read)(u),!1)),EditorContainerFullContent:W.eb.apply(void 0,Object(o.__spreadArray)([p,yn],Object(o.__read)(u),!1)),EditorContainerTruncated:W.eb.apply(void 0,Object(o.__spreadArray)([p,yn,{maxHeight:ln.maxHeight},{marginBottom:e?void 0:"6px"}],Object(o.__read)(u),!1)),EditorDisabled:W.eb.apply(void 0,Object(o.__spreadArray)([p],Object(o.__read)(u),!1)),EditorPlaceholder:W.eb.apply(void 0,Object(o.__spreadArray)([p,mn,hn],Object(o.__read)(u),!1)),InnerEditorDisableFocusOutline:Object(W.eb)(Cn),EditorTruncationOverlay:Object(W.eb)(bn(r,e,s),Cn),SmartReplyHeader:an(s),SmartReplyItem:rn(s),SuggestedSmartReplyItem:on(s),SmartReplyCallout:sn(s,l)}})),On=n(1588),xn=n(715),Sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.create=function(n){var r=e.create.call(this,n);return r.setAttribute("class","atmention"),r.setAttribute(t.getDataAttributeName(),n),r.setAttribute("tabIndex","-1"),r.setAttribute("disabled","disabled"),r.setAttribute("spellcheck","false"),r},t.formats=function(e){return e.getAttribute(t.getDataAttributeName())||void 0},t.prototype.format=function(n,r){"atmention"===n&&r?this.domNode.setAttribute(t.getDataAttributeName(),r):e.prototype.format.call(this,n,r)},t.prototype.formats=function(){var n=e.prototype.formats.call(this);return n.atmention=t.formats(this.domNode),n},t.getDataAttributeName=function(){return"data-".concat(t.blotName)},t.blotName="atmention",t.tagName="A",t}($t),kn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.create=function(n){var r=e.create.call(this);return r.setAttribute("class",t.className),r.setAttribute("className",t.className),r.setAttribute("style","cursor: pointer"),r.setAttribute("tabindex","-1"),n.tooltip&&r.setAttribute("title",n.tooltip),r},t.blotName="clickable",t.tagName="a",t.className="sharedcomments-clickabletext",t}($t),Pn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.isAtmentionSupported=n.isAtmentionSupported,r.isImageSupported=n.isImageSupported,r.removeAtFormat=r.removeAtFormat.bind(r),r.pasteMentionHandler=r.pasteMentionHandler.bind(r),r.removeFontColorAndBackgroundFormat=r.removeFontColorAndBackgroundFormat.bind(r),r}return Object(o.__extends)(t,e),t.prototype.removeFontColorAndBackgroundFormat=function(e){e&&e.attributes&&(delete e.attributes.color,delete e.attributes.background)},t.prototype.removeImageContent=function(e){d.R()&&!this.isImageSupported&&e&&e.insert&&e.insert.image&&delete e.insert.image},t.prototype.removeAtFormat=function(e,t){this.quill.formatText(e,t,"optional",!1),this.quill.formatText(e,t,"atmention",!1)},t.prototype.pasteMentionHandler=function(){var e=window.getSelection(),t=e&&e.anchorNode?e.anchorNode.parentNode:null,n=e&&e.focusNode?e.focusNode.parentNode:null,r=Jt.find(t),o=t===n?void 0:Jt.find(n);return r&&"atmention"===r.statics.blotName&&this.removeAtFormat(r.offset(this.quill.scroll),r.length()),o&&"atmention"===o.statics.blotName&&this.removeAtFormat(o.offset(this.quill.scroll),o.length()),!0},t.prototype.onPaste=function(e){var n=this;if(!e.defaultPrevented&&this.quill.isEnabled())try{t.pasteOperationInProgress=!0,this.pasteMentionHandler();var r=this.quill.getSelection(),o=(new Yt).retain(r.index),i=this.quill.scrollingContainer.scrollTop;this.container.focus();var s=document.createRange(),l=window.getSelection();s.setStart(this.container,0),s.collapse(!0),l&&(Object(a.k)().assertConditionTag(!!l,"Expected a selection!",595854800),l.removeAllRanges(),l.addRange(s)),this.quill.selection.update("silent"),setTimeout((function(){try{if(o=o.concat(n.convert()).delete(r.length),o=n.isAtmentionSupported?new Yt(o.map((function(e){return e.insert&&(e.attributes&&e.attributes.optional&&delete e.attributes.optional,n.removeFontColorAndBackgroundFormat(e),n.removeImageContent(e),!e.attributes||!e.attributes.atmention||qn(JSON.parse(e.attributes.atmention).fullName,e.insert.slice(1))&&"UnknownEmail"!==JSON.parse(e.attributes.atmention).email||delete e.attributes.atmention),e}))):new Yt(o.map((function(e){return e.insert&&e.attributes&&delete e.attributes.atmention,n.removeFontColorAndBackgroundFormat(e),n.removeImageContent(e),e}))),d.t()){var e=Vt.a.getThemeAPI().getThemeMode();1===e&&function(e,t){Object(Vt.e)()&&e.forEach((function(e){e.insert&&e.attributes&&(e.attributes.background&&(e.attributes.background=Kn(e.attributes.background,t)),e.attributes.color&&(e.attributes.color=Kn(e.attributes.color,t)))}))}(o.ops,e)}n.quill.updateContents(o,"user"),n.quill.setSelection(o.length()-r.length,d.E()?"api":"silent"),n.quill.scrollingContainer.scrollTop=i,n.quill.focus()}catch(e){Object(a.k)().assertConditionTag(!1,"CommentClipboard paste delta scrubbing failed.",593035297)}finally{t.pasteOperationInProgress=!1}}),1)}catch(e){Object(a.k)().assertConditionTag(!1,"CommentClipboard preparation for paste failed.",593035298),t.pasteOperationInProgress=!1}},t.pasteOperationInProgress=!1,t}(Xt),En=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.create=function(t){var n=e.create.call(this,JSON.stringify(t));return n.setAttribute("src",t.src),n},t.value=function(e){return{src:e.getAttribute("src")}},t.blotName="image",t.tagName="img",t.className="sharedcomments-image",t}(Zt),jn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.create=function(n){var r=e.create.call(this,n);r.setAttribute(t.getDataAttributeName(),n);var o="string"==typeof n?JSON.parse(n):n;return(o&&o.atmention&&o.atmention.isCurrentUser||o.isCurrentUser)&&r.setAttribute("class","current-user"),r},t.formats=function(e){return e.getAttribute(t.getDataAttributeName())||void 0},t.prototype.format=function(n,r){n===t.blotName&&r?this.domNode.setAttribute(t.getDataAttributeName(),r):e.prototype.format.call(this,n,r)},t.prototype.formats=function(){var n=e.prototype.formats.call(this);return n[t.blotName]=t.formats(this.domNode),n},t.getDataAttributeName=function(){return"data-".concat(t.blotName)},t.blotName="optional",t.tagName=d.F()?"OFFICE-OPTIONAL":"SPAN",t}($t);function In(e,t){var n,r=null===(n=window.getComputedStyle(e))||void 0===n?void 0:n.textDecoration,i=void 0;return r&&(r.indexOf("underline")>-1&&(i={underline:!0}),r.indexOf("line-through")>-1&&(i=Object(o.__assign)(Object(o.__assign)({},i),{strike:!0})),i)?t.compose((new Yt).retain(t.length(),i)):t}function wn(e,t){var n,r=e;if(t.ops&&(null===(n=t.ops[0].attributes)||void 0===n?void 0:n.atmention))return t;var o=nn.formats(r);if(o&&r.text){if(Object(a.k)().createActivityObject("HyperlinkPasted",Object(a.l)(a.g.GlobalAPI),Object(a.n)({aggregationMode:a.a.OnSuccess})).successTag(589894537),!d.u()){var i=JSON.parse(o),s=null==i?void 0:i.url;return s&&s===r.text?d.F()?t.compose((new Yt).retain(t.length(),{hyperlink:o})):new Yt([{insert:r.text,attributes:{hyperlink:o}}]):new Yt(s?[{insert:s,attributes:{hyperlink:o}}]:[{insert:r.text}])}return d.F()?t.compose((new Yt).retain(t.length(),{hyperlink:o})):new Yt([{insert:r.text,attributes:{hyperlink:o}}])}return t}var An,Rn=["http://","https://","file://","file:\\\\","ftp://","mailto:","news:","notes:","\\\\","www.","onenote:","tel:","mms://","notes://","mssv://","bookmark://"],Dn=new RegExp("\\S+@\\S+\\.[\\w]+"),_n=function(e){var t,n,r=e.toLowerCase();r=function(e){var t=0;if(!e)return"";for(var n=e.length;n>t&&-1!=="#%&*{}:<>?+.;(),!']\"".indexOf(e.charAt(n-1));)n--;for(;t<n&&-1!=="(['\"".indexOf(e.charAt(t));)t++;return e.substr(t,n-t)}(r);try{for(var i=Object(o.__values)(Rn),a=i.next();!a.done;a=i.next()){var s=a.value;if((!r.startsWith("notes:")||r.startsWith("notes://"))&&r.startsWith(s))return!0}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1},Nn=function(e){if(!e)return"";var t,n,r=e;return r.startsWith("HYPERLINK ")&&(r=r.substr("HYPERLINK ".length+1,r.length-"HYPERLINK ".length-2)),(r=r.trim()).startsWith("HYPERLINK ")&&((r=r.substring("HYPERLINK ".length+1,r.lastIndexOf('"'))).startsWith("\\l ")&&(r=(r=r.substr(r.indexOf('"'))).replace('"',"bookmark://")),!_n(r))?r:('"',(n=r=(t=r)&&t.length>=2&&'"'===t.charAt(0)&&'"'===t.charAt(t.length-1)?t.substr(1,t.length-2):t)&&n.length<=254&&Dn.test(n)&&!_n(r)&&(r="mailto:"+r),_n(r)||(r="http://"+r),r.toLowerCase().startsWith("www")&&(r="https://"+r),r.startsWith("\\\\")&&(r="file:///"+r),-1!==r.toLowerCase().indexOf("alert(")?"":r)};d.d()&&en.register(nn),en.register(Sn),en.register(jn),en.register(kn),en.register("modules/clipboard",Pn,!0),d.e()&&((An=document.createElement("style")).innerText='\n    @counter-style decimal-parenthesis {\n      system: extends decimal;\n      suffix: ")   ";\n    }\n    @counter-style decimal-period {\n      system: extends decimal;\n      suffix: ".   ";\n    }\n    @counter-style lower-alpha-parenthesis {\n      system: extends lower-alpha;\n      suffix: ")   ";\n    }\n    @counter-style lower-alpha-period {\n      system: extends lower-alpha;\n      suffix: ".   ";\n    }\n    @counter-style upper-alpha-parenthesis {\n      system: extends upper-alpha;\n      suffix: ")   ";\n    }\n    @counter-style upper-alpha-period {\n      system: extends upper-alpha;\n      suffix: ".   ";\n    }\n    @counter-style lower-roman-parenthesis {\n      system: extends lower-roman;\n      suffix: ")   ";\n    }\n    @counter-style lower-roman-period {\n      system: extends lower-roman;\n      suffix: ".   ";\n    }\n    @counter-style upper-roman-parenthesis {\n      system: extends upper-roman;\n      suffix: ")   ";\n    }\n    @counter-style upper-roman-period {\n      system: extends upper-roman;\n      suffix: ".   ";\n    } ',document.head.appendChild(An));var Mn=/(?:https?:\/\/|www\.)[^\s]+[\s]*$/i,Bn=Object(z.a)((function(){var e=[];return d.d()&&e.push("hyperlink"),e.push("atmention","optional","clickable"),d.F()&&e.push("bold","italic","underline","strike","image"),d.t()&&e.push("background","color"),d.e()&&e.push("list"),e})),Ln=function(){function e(e){var t=document.createElement("div");t.id=e,t.style.display="none",document.body.appendChild(t),this.quillInstance=new en("#".concat(e),{formats:Bn(),modules:{clipboard:{isAtmentionSupported:!0,isImageSupported:!1}}})}return e.prototype.getQuill=function(){return this.quillInstance},e}();function Fn(e){for(var t,n,r,i=void 0,a=e.ops.length-1;a>=0;a--){var s=e.ops[a];i&&(void 0===(null===(t=null==s?void 0:s.attributes)||void 0===t?void 0:t.link)&&(s.attributes=Object(o.__assign)(Object(o.__assign)({},s.attributes),{link:i})),i=void 0),0===s.insert.length&&(null===(n=null==s?void 0:s.attributes)||void 0===n?void 0:n.link)&&(i=null===(r=null==s?void 0:s.attributes)||void 0===r?void 0:r.link,e.ops.splice(a,1))}}function Hn(e){var t=X.c?Object(a.k)().createActivityObject("GetQuillFromOfficeDelta",Object(a.l)(a.g.GlobalAPI),Object(a.j)()):void 0,n=JSON.parse(e);Fn(n);var r=!1;if(Object(Vt.e)()){var o=Vt.a.getThemeAPI().getThemeMode();r=1===o}var s={},l=d.F(),c=n.ops.map((function(e){var n,o,s,c,p,u;if(void 0!==e.insert){var f={};if(f.insert=e.insert,e.attributes){if(f.attributes=e.attributes,f.attributes.atmention&&(f.attributes.atmention=JSON.stringify(e.attributes.atmention)),f.attributes.link&&d.d()&&(f.attributes.hyperlink=JSON.stringify({url:Nn(f.attributes.link)}),delete f.attributes.link),d.d()||delete f.attributes.link,f.attributes.weight){if(l&&!f.attributes.atmention){var h=parseInt(f.attributes.weight,10);Object(a.k)().assertConditionTag(h>=700,"weight attribute less than 700.",591192854),f.attributes.bold=h>=700}else Object(a.k)().assertConditionTag(l,"Weight attribute present when rich text feature gate is off",591192855);delete f.attributes.weight}if(f.attributes.strikethrough&&(l&&!f.attributes.atmention?f.attributes.strike=f.attributes.strikethrough:Object(a.k)().assertConditionTag(l,"strikethrough attribute present when rich text feature gate is off",591192856),delete f.attributes.strikethrough),f.attributes.italic&&f.attributes.atmention&&delete f.attributes.italic,f.attributes.underline&&f.attributes.atmention&&delete f.attributes.underline,f.attributes.paragraph){if(d.e())switch(null===(n=e.attributes.paragraph)||void 0===n?void 0:n.listType){case xn.c.None:f.attributes.list=xn.a.none;break;case xn.c.Bullet:f.attributes.list=xn.a.disc;break;case xn.c.NumberArabic:switch(null===(o=e.attributes.paragraph)||void 0===o?void 0:o.listEndType){case xn.b.Parenthesis:f.attributes.list=xn.a.decimalParenthesis;break;default:f.attributes.list=xn.a.decimalPeriod}break;case xn.c.AlphabetLowerCase:switch(null===(s=e.attributes.paragraph)||void 0===s?void 0:s.listEndType){case xn.b.Parenthesis:f.attributes.list=xn.a.lowerAlphaParenthesis;break;default:f.attributes.list=xn.a.lowerAlphaPeriod}break;case xn.c.AlphabetUpperCase:switch(null===(c=e.attributes.paragraph)||void 0===c?void 0:c.listEndType){case xn.b.Parenthesis:f.attributes.list=xn.a.upperAlphaParenthesis;break;default:f.attributes.list=xn.a.upperAlphaPeriod}break;case xn.c.NumberRomanLowerCase:switch(null===(p=e.attributes.paragraph)||void 0===p?void 0:p.listEndType){case xn.b.Parenthesis:f.attributes.list=xn.a.lowerRomanParenthesis;break;default:f.attributes.list=xn.a.lowerRomanPeriod}break;case xn.c.NumberRomanUpperCase:switch(null===(u=e.attributes.paragraph)||void 0===u?void 0:u.listEndType){case xn.b.Parenthesis:f.attributes.list=xn.a.upperRomanParenthesis;break;default:f.attributes.list=xn.a.upperRomanPeriod}break;default:f.attributes.list=xn.a.none}delete f.attributes.paragraph}f.attributes.image&&f.attributes.atmention&&delete f.attributes.image,f.attributes.highlight&&(d.t()&&!f.attributes.atmention&&(f.attributes.background=r?Kn(f.attributes.highlight,1):f.attributes.highlight),delete f.attributes.highlight),f.attributes.color&&(f.attributes.atmention?delete f.attributes.color:d.t()&&(f.attributes.color=r?Kn(f.attributes.color,1):f.attributes.color))}if(e.optional)if(e.optional.image){var m=JSON.parse(JSON.stringify(e.optional));m.image.src=m.image.base64,delete m.image.base64,f.insert={image:m.image}}else f.attributes||(f.attributes={}),f.attributes.optional=JSON.stringify(e.optional);return f}return t&&t.failTag(595194440,-2130957543),Object(a.k)().assertConditionTag(!1,"Translation Error: op in office delta is not insert. Inserting empty insert.",i.d.reserveTag(595194441)),{insert:""}}));return t&&t.successTag(595194442),c.length?(s.ops=c,JSON.stringify(s)):JSON.stringify(new Yt)}var Un=void 0;function zn(e){var t=e.target;tn(t)&&(Object(a.k)().createActivityObject("PostedHyperlinkClicked",Object(a.l)(a.g.GlobalAPI),Object(a.n)({aggregationMode:a.a.OnSuccess})).successTag(562438279),Object(qt.c)().onHyperlinkClick(t.href)&&e.preventDefault())}function Kn(e,t){var n,r,o=null===(r=(n=Vt.a.getThemeAPI()).convertColorForTheme)||void 0===r?void 0:r.call(n,e,t);return null!=o?o:e}function Vn(e,t){if(e&&d.d())for(var n=e.getElementsByClassName(nn.className),r=0;r<n.length;r++)n[r].setAttribute("contenteditable",t?"false":"true")}function Wn(e,t,n){e.formatText(t,n,nn.blotName,!1)}function qn(e,t){var n=t.trim().split(" "),r=e.trim().split(" ");return n.every((function(e){return r.indexOf(e)>=0}))}function Qn(e){var t=!1;return e.forEach((function(e){t=!!e.delete&&e.delete.valueOf()>1})),t}function Gn(e){var t=!1;return e.forEach((function(e){t||(t=e.insert&&e.attributes&&e.attributes.atmention)})),t}function Yn(e,t){var n=document.getElementById(e);n&&(n.setAttribute("data-placeholder",t),n.setAttribute("aria-placeholder",t))}function Jn(e){var t=new Set;return e&&e.ops&&e.ops.forEach((function(e){if(e.attributes){var n=void 0;if("string"==typeof e.attributes.atmention)try{n=JSON.parse(e.attributes.atmention)}catch(e){return void Object(a.k)().assertConditionTag(!1,"Failed to parse atmention attributes",594921041)}else n=e.attributes.atmention;n&&t.add(n.email)}})),t}function $n(e,t){t?(e.setAttribute("aria-autocomplete",t["aria-autocomplete"]),e.setAttribute("aria-haspopup",t["aria-haspopup"]),e.setAttribute("aria-owns",t["aria-owns"]),e.setAttribute("aria-controls",t["aria-controls"])):(e.removeAttribute("aria-autocomplete"),e.removeAttribute("aria-haspopup"),e.removeAttribute("aria-owns"),e.removeAttribute("aria-controls"))}var Xn=n(636),Zn=function(e){function t(t){var n=e.call(this,t)||this;return n.contentRef=null,n.truncationRef=null,n.getStyles=function(e){return Tn(d.H(),!1,!1,n.props.truncationOverlayColor,n.props.dulledAtMentions,!1,null==e?void 0:e.colors,null==e?void 0:e.styles)},n.renderWithContexts=function(e){if(n.state.error)throw n.state.error;n.styles=n.getStyles(e);var t=n.getEditorStyle();return s.createElement("div",{className:t,id:Object(ee.x)(n.props.id)},s.createElement("div",{ref:n.setContentRef,className:n.styles.InnerEditorDisableFocusOutline,id:Object(ee.w)(n.props.id)}),n.renderTruncationOverlay(n.props.id,n.styles))},n.state={error:null},n.setContentRef=n.setContentRef.bind(n),n.setTruncationRef=n.setTruncationRef.bind(n),n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.tryUpdateComponent()},t.prototype.componentDidUpdate=function(e,t){this.tryUpdateComponent(e)},t.prototype.shouldTruncate=function(){return!this.props.showFullContent&&(this.props.content&&Object(Xn.e)(this.props.content).length>100||!!this.contentRef&&this.contentRef.offsetHeight>ln.maxHeight)},t.prototype.tryUpdateComponent=function(e){var t=this;requestAnimationFrame((function(){try{t.updateComponent(e)}catch(e){t.setState({error:e instanceof Error?e:new Error(Object(i.l)(e))})}}))},t.prototype.updateComponent=function(e){this.contentRef&&(e&&this.props.content===e.content&&this.props.themeMode===e.themeMode&&this.props.onClickableTextClicked===e.onClickableTextClicked?this.props.showFullContent!==e.showFullContent&&this.updateTruncationUI():(function(e,t,n,r){var o=(Un||(Un=new Ln("CommentsDisplayTextTranslationQuill").getQuill()).disable(),Un);if(n){var i=Hn(n);o.setContents(JSON.parse(i),"api")}Object(a.k)().assertConditionTag(!!o.root,"root element on Quill is undefined",559491102);var s=o.root.cloneNode(!0);s.addEventListener("click",zn),o.setText(""),s?(t.firstChild?t.replaceChild(s,t.firstChild):t.appendChild(s),t.firstElementChild&&t.firstElementChild.setAttribute("id",e),function(e,t){if(e&&t)for(var n=e.getElementsByClassName(kn.className),r=function(e){n[e].addEventListener("click",(function(r){var o=n[e].textContent;o&&(t(o),r.stopPropagation(),r.preventDefault())}))},o=0;o<n.length;o++)r(o)}(t,r)):Object(a.k)().assertConditionTag(!1,"Clone of Quill root node should be defined",595658959)}(this.props.id,this.contentRef,this.props.content,this.props.onClickableTextClicked),this.updateTruncationUI()),!this.props.placeholder||e&&e.placeholder===this.props.placeholder||Yn(this.props.id,this.props.placeholder),void 0!==this.props.commentTabbable&&this.props.commentTabbable!==(null==e?void 0:e.commentTabbable)&&function(e,t){if(e)for(var n=d.d()?e.querySelectorAll(".".concat(nn.className,",.").concat(kn.className)):e.getElementsByClassName(kn.className),r=0;r<n.length;r++){var o=t?"0":"-1";n[r].setAttribute("tabIndex",o)}}(this.contentRef,this.props.commentTabbable))},t.prototype.setContentRef=function(e){this.contentRef=e},t.prototype.setTruncationRef=function(e){this.truncationRef=e},t.prototype.updateTruncationUI=function(){if(this.props.viewerMode!==mt.DisabledEditor)if(this.contentRef){var e=this.shouldTruncate(),t=d.H()?ln.maxHeight-4:ln.maxHeight-.75*ln.lineHeight;this.contentRef.style.maxHeight=e?"".concat(t,"px"):"none",this.truncationRef&&(this.truncationRef.style.visibility=e?"visible":"hidden")}else Object(a.k)().assertConditionTag(!1,"contentRef should be defined",595658961)},t.prototype.getEditorStyle=function(){switch(this.props.viewerMode){case mt.DisabledEditor:return this.styles.EditorPlaceholder;case mt.DisabledComment:return this.shouldTruncate()?this.styles.EditorContainerTruncated:this.styles.EditorDisabled;case mt.ReadOnlyComment:return this.shouldTruncate()?this.styles.EditorContainerTruncated:this.styles.EditorContainerFullContent;default:return Object(i.m)(this.props.viewerMode),{}}},t.prototype.renderTruncationOverlay=function(e,t){if(this.props.viewerMode===mt.DisabledEditor||!1!==this.props.showFullContent)return null;var n=t.EditorTruncationOverlay,r=d.H()?"".concat(this.props.truncationUIText):"";return s.createElement("div",{id:Object(ee.ab)(e),className:n,ref:this.setTruncationRef},r)},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(s.PureComponent);function er(e,t,n){var r=function(n){function r(){var r=n.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return r.allContextContents={},r.keys=Object.keys(t),r.renderFunction=r.keys.reduceRight((function(n,i){return function(a,l){var c=t[i];return s.createElement(c.Consumer,null,(function(t){return r.allContextContents[i]=t,null===n?s.createElement(e,Object(o.__assign)({ref:a},l,r.allContextContents)):n(a,l)}))}}),null),r.render=function(){var t=r.props,n=t.forwardedRef,i=Object(o.__rest)(t,["forwardedRef"]);return r.renderFunction?r.renderFunction(n,i):(Object(a.k)().assertConditionTag(!1,"Contexts failed to wrap, default to null.",558724946),s.createElement(e,Object(o.__assign)({},i,{ref:n},r.allContextContents)))},r}return Object(o.__extends)(r,n),r}(s.Component),i=s.forwardRef((function(e,t){return s.createElement(r,Object(o.__assign)({key:"ContextualizedWrapperComponent",forwardedRef:t},e))}));return i.displayName=n,i}var tr,nr=n(2472);!function(e){e[e.SmartReply=0]="SmartReply",e[e.LPP=1]="LPP"}(tr||(tr={}));var rr,or=tr;!function(e){e[e.EditTypeUnknown=-1]="EditTypeUnknown",e[e.NoEdits=0]="NoEdits",e[e.CharactersInserted=1]="CharactersInserted",e[e.CharactersDeleted=2]="CharactersDeleted",e[e.CharactersInsertedAndDeleted=3]="CharactersInsertedAndDeleted",e[e.EntireSuggestionDeleted=4]="EntireSuggestionDeleted"}(rr||(rr={}));var ir,ar,sr,lr,cr=rr,pr=n(1115);function ur(e,t){if(e){var n=Object(ee.C)(),r=Object(ee.G)(),a={"aria-autocomplete":"none","aria-expanded":"true"};switch(t){case or.LPP:return Object(o.__assign)(Object(o.__assign)({},a),{"aria-haspopup":"listbox","aria-owns":n,"aria-controls":n});case or.SmartReply:return Object(o.__assign)(Object(o.__assign)({},a),{"aria-haspopup":"true","aria-owns":r,"aria-controls":r});default:Object(i.m)(t)}}}var dr=((ir={})[cr.CharactersInserted]=((ar={})[cr.CharactersInserted]=cr.CharactersInserted,ar[cr.CharactersDeleted]=cr.CharactersInsertedAndDeleted,ar[cr.CharactersInsertedAndDeleted]=cr.CharactersInsertedAndDeleted,ar),ir[cr.CharactersInsertedAndDeleted]=((sr={})[cr.CharactersInserted]=cr.CharactersInsertedAndDeleted,sr[cr.CharactersDeleted]=cr.CharactersInsertedAndDeleted,sr[cr.CharactersInsertedAndDeleted]=cr.CharactersInsertedAndDeleted,sr),ir[cr.CharactersDeleted]=((lr={})[cr.CharactersDeleted]=cr.CharactersDeleted,lr[cr.CharactersInserted]=cr.CharactersInsertedAndDeleted,lr[cr.CharactersInsertedAndDeleted]=cr.CharactersInsertedAndDeleted,lr),ir);function fr(e,t){var n=null==e?void 0:e.ops;if(void 0===n||!t)return!1;var r=n.some((function(e){return e.delete&&e.delete>0})),o=n.some((function(e){return e.retain&&e.retain>0}));return r&&o}var hr,mr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t}(n(1536).a),yr=n(242),br=en.import("delta"),gr=function(){function e(){var e,t;this.disableSelectionChangeCallback=!1,this.currentTheme=0,Object(qt.c)().initRichContentEditor(this),Object(Vt.e)()&&(this.currentTheme=Vt.a.getThemeAPI().getThemeMode(),null===(t=(e=Vt.a.getThemeAPI()).registerOnThemeChanged)||void 0===t||t.call(e,this.handleThemeChange.bind(this)))}return e.prototype.handleThemeChange=function(){var e=this,t=Vt.a.getThemeAPI().getThemeMode();if(this.currentTheme!==t){var n=this.getEditorContents();if(n&&this.editor){var r=0;n.forEach((function(n){var o,i,a,s,l=n.insert.length;if(null===(o=n.attributes)||void 0===o?void 0:o.background){var c=e.convertColorOnThemeChange(n.attributes.background,t);null===(i=e.editor)||void 0===i||i.formatText(r,l,"background",c,"api")}if(null===(a=n.attributes)||void 0===a?void 0:a.color){var p=e.convertColorOnThemeChange(n.attributes.color,t);null===(s=e.editor)||void 0===s||s.formatText(r,l,"color",p,"api")}r+=n.insert.length})),this.currentTheme=t}}},e.prototype.getEditorContents=function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.getContents()},e.prototype.getFormattingAtCurrentSelection=function(){var e;if(!this.editor)return{};if(this.formattingCache)return this.formattingCache;var t,n=this.editor.getSelection(!1);return(t=n&&this.editor.getFormat(n))&&(this.formattingCache={bold:t.bold,italic:t.italic,underline:t.underline,strikethrough:t.strike},d.e()&&(this.formattingCache.list=t.list),d.t()&&d.r()&&(this.formattingCache.fontColor=t.color,this.formattingCache.highlight=t.background)),null!==(e=this.formattingCache)&&void 0!==e?e:{}},e.prototype.getSelection=function(){var e=this.getSelectedContent();return{text:e?Object(Xn.f)(e):""}},e.prototype.applyFormattingToCurrentSelection=function(e){var t,n=this,r=this.richTextCapabilities&&!!(this.richTextCapabilities&e.type);if(this.editor&&r){var o=this.getSelectedContent();if(null==o?void 0:o.ops)for(var i=o.ops,a=0;a<i.length;a++)if(null===(t=i[a].attributes)||void 0===t?void 0:t.atmention)return;var s=!0,l=this.getFormattingAtCurrentSelection();this.executeWithSelectionChangeCallbackDisabled((function(){var t,r,o;if(n.editor)switch(e.type){case yr.DeltaFormattingType.Weight:n.editor.format("bold",!l.bold,"api");break;case yr.DeltaFormattingType.Italic:n.editor.format("italic",!l.italic,"api");break;case yr.DeltaFormattingType.Underline:n.editor.format("underline",!l.underline,"api");break;case yr.DeltaFormattingType.Strikethrough:n.editor.format("strike",!l.strikethrough,"api");break;case yr.DeltaFormattingType.Highlight:n.editor.format("background",n.applyColorAdjustedForTheme(null===(t=e.data)||void 0===t?void 0:t.color),"api"),n.moveSelectionToEnd();break;case yr.DeltaFormattingType.Color:n.editor.format("color",n.applyColorAdjustedForTheme(null===(r=e.data)||void 0===r?void 0:r.fontColor),"api"),n.moveSelectionToEnd();break;case yr.DeltaFormattingType.Paragraph:n.editor.format("list",null===(o=e.data)||void 0===o?void 0:o.listType,"api");break;default:s=!1}})),s&&this.invalidateFormattingCache()}},e.prototype.applyColorAdjustedForTheme=function(e){if(!Object(Vt.e)()||!e)return e;var t=Vt.a.getThemeAPI().getThemeMode();return 1===t?this.convertColorOnThemeChange(e,t):e},e.prototype.addContent=function(e){var t=this.richTextCapabilities&&!!(this.richTextCapabilities&e.type);if(this.editor&&t)switch(e.type){case yr.DeltaFormattingType.Hyperlink:if(e.data){var n=this.editor.getSelection(!1),r=(new br).retain(n.index).delete(n.length).insert(e.data.text,{hyperlink:JSON.stringify({url:e.data.link,editable:!0})}).insert(" ");this.editor.updateContents(r,"api"),this.editor.setSelection(n.index+e.data.text.length+2,0)}break;case yr.DeltaFormattingType.Image:e.data&&(n=this.editor.getSelection(!1))&&(r=(new br).retain(n.index).delete(n.length).insert({image:e.data}),this.editor.updateContents(r,"api"),this.editor.setSelection(n.index+1,0))}},e.prototype.isFormatEnabled=function(e){return d.E()&&!!this.editor&&!!this.richTextCapabilities&&!!(this.richTextCapabilities&e)},e.prototype.registerSelectionChangeHandler=function(e){this.selectionChangeHandler=e},e.prototype.convertColorOnThemeChange=function(e,t){var n,r;if(Object(Vt.e)()){var o=null===(r=(n=Vt.a.getThemeAPI()).convertColorForTheme)||void 0===r?void 0:r.call(n,e,t);return null!=o?o:e}return e},e.prototype.registerKeypressHandler=function(e){this.keypressHandler=e},e.prototype.setActiveEditorInfo=function(e){var t,n;this.editor=null!==(t=e.editor)&&void 0!==t?t:this.editor,this.editorContainerElement=null!==(n=e.editorContainer)&&void 0!==n?n:this.editorContainerElement,this.richTextCapabilities=e.richTextCapabilities,this.invokeSelectionChangeHandler()},e.prototype.resetActiveEditorInfo=function(){this.editor=void 0,this.editorContainerElement=void 0,this.richTextCapabilities=void 0},e.prototype.onSelectionChange=function(e){this.editor&&this.editor===e&&!this.disableSelectionChangeCallback&&this.invokeSelectionChangeHandler()},e.prototype.onKeyPress=function(e){var t;this.invalidateFormattingCache(),null===(t=this.keypressHandler)||void 0===t||t.call(this,e)},e.prototype.setFocus=function(){this.editorContainerElement&&this.editorContainerElement.focus()},e.prototype.invalidateFormattingCache=function(){this.formattingCache=void 0},e.prototype.invokeSelectionChangeHandler=function(){var e;this.invalidateFormattingCache(),null===(e=this.selectionChangeHandler)||void 0===e||e.call(this)},e.prototype.moveSelectionToEnd=function(){if(this.editor){var e=this.editor.getSelection(!1);this.editor.setSelection(e.index+e.length,0)}},e.prototype.executeWithSelectionChangeCallbackDisabled=function(e){this.disableSelectionChangeCallback=!0,e(),this.disableSelectionChangeCallback=!1},e.prototype.getSelectedContent=function(){if(this.editor){var e=this.editor.getSelection(!1);if(e)return this.editor.getContents(e.index,e.length)}},e}();function vr(){return hr||(hr=new gr),hr}var Cr=function(e){function t(t){var n=e.call(this,t)||this;return n.editorContainerRef=s.createRef(),n.editorRef=null,n.smartReplyPickerRef=s.createRef(),n.isRestoreInProgress=!1,n.selectedSmartReply=void 0,n.smartReplyEditHistory=cr.NoEdits,n.isQuillCursorPositionSet=!1,n.lastKnownCursorIndex=void 0,n.draftContentChangedRecently=!1,n.getStyles=function(e){return Tn(d.H(),n.props.useReplyBoxStyling,n.props.isHeightBounded,void 0,void 0,n.shouldHideMentionColors(),null==e?void 0:e.colors,null==e?void 0:e.styles)},n.setUpEditor=function(){var e,t;null===(t=(e=n.props).onMount)||void 0===t||t.call(e),n.initializeQuill(),n.restoreDraftIfExists(),n.props.componentRef(n),d.f()&&n.handleShowSmartReplyPicker(),Vn(n.editorRef,!1)},n.onEditorContainerMutation=function(e,t){if(n.getEditorFocusContainerDiv()){var r=Object(a.k)().createActivityObject("DelayedQuillInitialization",Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.j)());try{n.setUpEditor()}catch(e){throw r.failTag(556127642,-2130957485),e}r.successTag(556127643),t.disconnect()}},n.selectionChangeHandler=function(){n.myQuill&&(n.isQuillCursorPositionSet=n.myQuill.hasFocus(),n.isQuillCursorPositionSet&&d.E()&&vr().onSelectionChange(n.myQuill))},n.selectionChangeHandler_deprecated=function(){var e;(null===(e=n.myQuill)||void 0===e?void 0:e.hasFocus())&&vr().onSelectionChange(n.myQuill)},n.isInAtMentionMode=function(){return!1},n.getEditorFocusContainerDiv=function(){return document.getElementById(Object(ee.w)(n.props.id))},n.isSmartReplyPickerDisplayed=function(){var e;return!!(null===(e=n.smartReplyPickerRef.current)||void 0===e?void 0:e.isSuggestionsShown)},n.handleShowSmartReplyPickerInner=function(){var e,t,r;if(n.smartReplyPickerRef.current){var o=!!((null!==(t=null===(e=n.props.smartReplyProps)||void 0===e?void 0:e.smartReplies)&&void 0!==t?t:[]).length>0&&n.isEditorEmpty()&&(null===(r=n.myQuill)||void 0===r?void 0:r.hasFocus()));if(o!==n.smartReplyPickerRef.current.isSuggestionsShown)if(o){var i=Object(a.k)().createActivityObject("SmartReplyRendered",Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.n)({diagnosticLevel:a.b.BasicEvent}));n.smartReplyPickerRef.current.showPicker(!0),i.successTag(588292805)}else n.smartReplyPickerRef.current.hidePicker()}},n.renderWithContexts=function(e){n.styles=n.getStyles(e);var t=n.styles.EditorContainerEditing,r=n.props.smartReplyProps?n.renderSmartReplyPicker():null,o=d.f()?n.editorContainerRef:void 0;return s.createElement("div",{className:t,id:Object(ee.x)(n.props.id),ref:o},s.createElement("div",{tabIndex:-1,ref:n.setEditorRef,className:n.styles.InnerEditorDisableFocusOutline,id:Object(ee.w)(n.props.id),onKeyDown:n.onKeyDownHandler,onKeyUp:n.onKeyUpHandler,onKeyPress:n.onKeyPressHandler,onFocus:n.onFocusHandler,onBlur:n.onBlurHandler}),n.renderAdditionalEditorContent(),r)},n.onFocusHandler=n.onFocusHandler.bind(n),n.onKeyDownHandler=n.onKeyDownHandler.bind(n),n.onKeyUpHandler=n.onKeyUpHandler.bind(n),n.onKeyPressHandler=n.onKeyPressHandler.bind(n),n.onTextChangedHandler=n.onTextChangedHandler.bind(n),n.deleteHandler=n.deleteHandler.bind(n),n.removeAtFormat=n.removeAtFormat.bind(n),n.tabKeyHandler=n.tabKeyHandler.bind(n),n.onBlurHandler=n.onBlurHandler.bind(n),n.setEditorRef=n.setEditorRef.bind(n),n.enterNewline=n.enterNewline.bind(n),n.handleEscapeKeys=n.handleEscapeKeys.bind(n),n.handleShowSmartReplyPicker=n.handleShowSmartReplyPicker.bind(n),n.handleSmartReplySelection=n.handleSmartReplySelection.bind(n),n.onSmartRepliesShown=n.onSmartRepliesShown.bind(n),n.onSmartRepliesHidden=n.onSmartRepliesHidden.bind(n),n.toggleSmartReplyAriaAttributes=n.toggleSmartReplyAriaAttributes.bind(n),n.onResolveSmartReplySuggestions=n.onResolveSmartReplySuggestions.bind(n),n.renderSmartReply=n.renderSmartReply.bind(n),n.renderSmartReplyPicker=n.renderSmartReplyPicker.bind(n),n.getKeyboardBindings=n.getKeyboardBindings.bind(n),n}return Object(o.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){var n,r,o,i=this.getEditorFocusContainerDiv();if(i){var s=this.getFirstQuillEditor(i);s?(this.props.accessibilityLabel&&s.setAttribute("aria-label",this.props.accessibilityLabel.toString()),this.props.accessibilityDescribedBy&&s.setAttribute("aria-describedby",this.props.accessibilityDescribedBy.toString()),s.setAttribute("aria-readonly","false"),d.U()&&(this.props.isTabbable?s.removeAttribute("tabindex"):s.setAttribute("tabindex","-1"))):Object(a.k)().assertConditionTag(!1,"quillEditorDiv missing in CommentEditor",588805504)}var l=d.p()||this.isEditorEmpty();!e.savedDraftContent&&l&&this.restoreDraftIfExists();var c=this.props.placeholder;c&&e.placeholder!==c&&Yn(this.props.id,c),d.f()&&(null!==(r=null===(n=this.props.smartReplyProps)||void 0===n?void 0:n.smartReplies)&&void 0!==r?r:[])!==(null===(o=e.smartReplyProps)||void 0===o?void 0:o.smartReplies)&&(this.selectedSmartReply=void 0,this.handleShowSmartReplyPicker())},t.prototype.componentDidMount=function(){if(!this.getEditorFocusContainerDiv())return this.editorContainerMutationObserver=new MutationObserver(this.onEditorContainerMutation),void this.editorContainerMutationObserver.observe(document.body,{childList:!0,subtree:!0});this.setUpEditor(),this.throttledSaveDraftToSession()},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=this.props).onUnmount)||void 0===t||t.call(e)},t.prototype.toggleSmartReplyAriaAttributes=function(e){if(!this.isInAtMentionMode()){var t=this.getQuillEditorFromFocusContainerDiv();t&&$n(t,ur(e,or.SmartReply))}},t.prototype.logSmartReplyPostEditActivity=function(){var e=Object(a.k)().createActivityObject("SmartReplyPosted",Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.n)({diagnosticLevel:a.b.BasicEvent}));this.smartReplyEditHistory!==cr.EditTypeUnknown&&(e.addDataField("PostEditedType",this.smartReplyEditHistory,a.d.SystemMetadata),e.successTag(587818312))},t.prototype.onTextChangedHandler=function(e,t,n){var r,o,a,s=this;if(Object(i.n)(this.myQuill,"Quill should always be defined on text changed handlers.",i.d.reserveTag(576583245)),d.f()&&this.handleShowSmartReplyPicker(),"user"===n&&!this.myQuill.history.ignoreChange)if(Qn(e)){var l=this.myQuill.getContents(),c=0;l.forEach((function(e){e.attributes&&e.attributes.atmention&&(qn(JSON.parse(e.attributes.atmention).fullName,e.insert.slice(1))||s.removeAtFormat(c,e.insert.length)),c+=e.insert.length}))}else{var p=window.getSelection(),u=p&&p.anchorNode?p.anchorNode.parentNode:null,f=Jt.find(u);setTimeout((function(){if(s.myQuill){var t=s.myQuill.getSelection();if(f&&"atmention"===f.statics.blotName){var n=f.offset(s.myQuill.scroll);t.index===n+1?s.removeAtFormat(n,1):t.index<n+f.length()&&t.index>n?s.removeAtFormat(n,f.length()):t.index===n+f.length()&&e.filter((function(e){return"string"==typeof e.insert})).length&&s.removeAtFormat(t.index-1,1)}}}),0)}var h=this.isEditorEmpty();this.props.isDraftEmpty!==h&&(null===(o=(r=this.props).onDraftEmptinessChanged)||void 0===o||o.call(r,h)),d.f()&&this.selectedSmartReply&&(this.smartReplyEditHistory=function(e,t,n,r){return function(e,t){switch(t){case cr.NoEdits:case cr.EditTypeUnknown:case cr.EntireSuggestionDeleted:return t}switch(e){case cr.EntireSuggestionDeleted:return e;case cr.EditTypeUnknown:case cr.NoEdits:return t}return dr[e]?dr[e][t]:cr.EditTypeUnknown}(e,function(e,t,n){return function(e,t){var n=(null==e?void 0:e.ops)&&e.ops.length>0?e.ops[0].insert:"";return!(!(n=n&&"\n"===n[n.length-1]?null==n?void 0:n.slice(0,-1):n)||t!==n)}(n,t)?cr.NoEdits:function(e,t){var n=null==e?void 0:e.ops;if(void 0===n||0===n.length||!t)return!1;var r=0,o=0,i=0;n.forEach((function(e){var t,n,a,s;r+=null!==(t=e.delete)&&void 0!==t?t:0,o+=null!==(n=e.retain)&&void 0!==n?n:0,i+=null!==(s=null===(a=e.insert)||void 0===a?void 0:a.length)&&void 0!==s?s:0}));var a=o+i;return!(i>0&&0===r||!(a<=1)&&0!==a)}(e,t)?cr.EntireSuggestionDeleted:function(e,t){return!!(t&&(null==e?void 0:e.ops)&&e.ops.some((function(e){return"string"==typeof e.insert})))}(e,t)?fr(e,t)?cr.CharactersInsertedAndDeleted:cr.CharactersInserted:fr(e,t)?cr.CharactersDeleted:cr.EditTypeUnknown}(t,n,r))}(this.smartReplyEditHistory,e,null!==(a=this.selectedSmartReply)&&void 0!==a?a:"",this.myQuill.getContents())),this.throttledSaveDraftToSession()},t.prototype.throttledSaveDraftToSession=function(){var e=this;d.p()&&!this.draftContentChangedRecently&&this.props.onSaveDraftToSession&&(this.draftContentChangedRecently=!0,setTimeout((function(){var t,n;null===(n=(t=e.props).onSaveDraftToSession)||void 0===n||n.call(t),e.draftContentChangedRecently=!1}),1e3))},t.prototype.getFirstQuillEditor=function(e){var t=e.getElementsByClassName("ql-editor");return t.length>0?t[0]:void 0},t.prototype.getQuillEditorFromFocusContainerDiv=function(){var e=this.getEditorFocusContainerDiv();return e?this.getFirstQuillEditor(e):void 0},t.prototype.restoreDraftIfExists=function(){var e=this,t=this.props.savedDraftContent;if(t){this.isRestoreInProgress=!0;var n=t.editorCursorPosition,r=t.editorContent;n||(Object(a.k)().assertConditionTag(!1,"Cursor position promise should be defined on Web, defaulting to resolve(undefined).",588805505),n=Promise.resolve(void 0)),Promise.all([r,n]).then((function(t){var n=Object(o.__read)(t,2),r=n[0],i=n[1];r&&(e.setContents(r,i),e.isRestoreInProgress=!1)})).catch(Object(Bt.a)(i.d.reserveTag(588805506)))}},t.prototype.setEditorRef=function(e){this.editorRef=e,d.E()&&(this.editorRef?vr().setActiveEditorInfo({editorContainer:e}):vr().resetActiveEditorInfo())},t.prototype.removeAtFormat=function(e,t){Object(i.n)(this.myQuill,"Quill should be defined when removing format.",i.d.reserveTag(576583246));try{this.myQuill.formatText(e,t,{optional:!1,atmention:!1})}catch(t){Object(a.k)().assertConditionTag(t instanceof Error,"Missing catch details due to unhandled error type?",520962377),t instanceof Error&&("NotFoundError"===t.message?(Object(a.k)().assertConditionTag(!1,"Error removing At Format",588805508),this.clear()):t.message.indexOf("mutations")>-1&&(Object(a.k)().assertConditionTag(!1,"Threw error cannot find property mutations of undefined",588649689),0===e&&this.myQuill.formatText(e,1,{optional:!1,atmention:!1})))}},t.prototype.getChunkBoundaryForDelete=function(e,t,n,r){Object(i.n)(this.myQuill,"Quill should be defined when processing blots.",i.d.reserveTag(576583247));var o=this.myQuill.getText(n.index,1),a=this.myQuill.getText(n.index-1,1),s=this.myQuill.getText(n.index,n.length),l=-1,c=-1,p=0===n.length,u=p&&" "===a,d=p&&" "===o||!this.myQuill.getFormat(n.index,1).atmention;if(""!==s&&n.index+n.length<=e+t.length||!d&&!u){if(""!==s&&s.indexOf(" ")>=0)return;return l=t.lastIndexOf(" ",n.index-e-1),c=t.indexOf(" ",n.index-e),{chunkStart:l<0?c<0?e:e+1:l+e,chunkEnd:c<0?e+t.length-1:l<0?c+e:c+e-1}}if(p){if(d)return r?(c=t.indexOf(" ",n.index-e+1),{chunkStart:n.index,chunkEnd:c<0?e+t.length-1:c+e}):(l=t.lastIndexOf(" ",n.index-e-1),c=t.indexOf(" ",n.index-e),{chunkStart:l<0?c<0?e:e+1:l+e,chunkEnd:l<0&&" "===o?n.index:n.index-1});if(u)return r?(c=t.indexOf(" ",n.index-e),{chunkStart:n.index-1,chunkEnd:c<0?e+t.length-1:c+e}):{chunkStart:(l=t.lastIndexOf(" ",n.index-e-2))<0?e+1:l+e+1,chunkEnd:n.index-1}}},t.prototype.deleteHandler=function(e){Object(i.n)(this.myQuill,"Quill must be defined in delete handler",i.d.reserveTag(576583248));var t=window.getSelection(),n=t&&t.anchorNode?t.anchorNode.parentNode:null,r=t&&t.focusNode?t.focusNode.parentNode:null,o={startBlot:Jt.find(n),endBlot:n===r?void 0:Jt.find(r)},s=t&&t.anchorNode?Jt.find(t.anchorNode.previousSibling):null;if(s&&"atmention"===s.statics.blotName&&t&&0===t.anchorOffset&&(o.startBlot=s),d.d()&&o.startBlot&&o.startBlot.statics.blotName===nn.blotName){if(t&&"Caret"===t.type&&t.anchorNode&&t.anchorNode.textContent&&t.anchorOffset===t.anchorNode.textContent.length){var l=this.myQuill.getSelection();if(!l)return!0;var c=t.anchorNode.textContent.length,p=l.index;return this.myQuill.formatText(p-c,c,{optional:!1,hyperlink:!1}),!1}Wn(this.myQuill,o.startBlot.offset(this.myQuill.scroll),o.startBlot.length()),o.endBlot&&o.endBlot.statics.blotName===nn.blotName&&Wn(this.myQuill,o.endBlot.offset(this.myQuill.scroll),o.endBlot.length())}if(o.startBlot){if(o.endBlot)return"atmention"===o.startBlot.statics.blotName&&this.removeAtFormat(o.startBlot.offset(this.myQuill.scroll),o.startBlot.length()),"atmention"===o.endBlot.statics.blotName&&this.removeAtFormat(o.endBlot.offset(this.myQuill.scroll),o.endBlot.length()),!0;var u=o.startBlot.offset(this.myQuill.scroll),f=this.myQuill.getSelection(),h=this.myQuill.getText(u,o.startBlot.length());if(!f)return Object(a.k)().assertConditionTag(!1,"Unexpected empty selection in Quill",587495514),!0;if("atmention"!==o.startBlot.statics.blotName&&0===f.length&&e&&this.myQuill.getFormat(f.index,1).atmention){var m=this.myQuill.getFormat(f.index+1).atmention.fullName;m&&this.removeAtFormat(f.index,m.length+1)}if("atmention"===o.startBlot.statics.blotName){if(f.index===u)return 0===f.length&&!e||(this.removeAtFormat(o.startBlot.offset(this.myQuill.scroll),o.startBlot.length()),!0);var y=this.getChunkBoundaryForDelete(u,h,f,e);if(y)return y.chunkStart>y.chunkEnd||(this.myQuill.deleteText(y.chunkStart,y.chunkEnd-y.chunkStart+1),!1);this.removeAtFormat(u,o.startBlot.length())}}return!0},t.prototype.getKeyboardBindings=function(){var e=this;return{tab:{key:_.c.Tab,handler:function(){return e.tabKeyHandler()}},shiftTab:{key:_.c.Tab,shiftKey:!0,handler:function(){return e.tabKeyHandler()}},enter:{key:_.c.Enter,handler:function(){return e.enterNewline(!1)}},back:{key:_.c.Backspace,handler:function(){var t=e.deleteHandler(!1);return d.F()&&d.E()&&vr().onKeyPress({key:_.c.Backspace}),t}},delete:{key:_.c.Delete,handler:function(){var t=e.deleteHandler(!0);return d.F()&&d.E()&&vr().onKeyPress({key:_.c.Delete}),t}},commitWithCtrl:{key:_.c.Enter,shortKey:!0,handler:function(){return e.handleCommitKeys()}},newlineWithShift:{key:_.c.Enter,shiftKey:!0,handler:function(){return e.enterNewline(!0)}},bold:{key:_.c.b,shortKey:!0,handler:this.getRichTextKeypressHandler({key:_.c.b,shortKey:!0},d.F(),{type:On.DeltaFormattingType.Weight})},italic:{key:_.c.i,shortKey:!0,handler:this.getRichTextKeypressHandler({key:_.c.i,shortKey:!0},d.F(),{type:On.DeltaFormattingType.Italic})},underline:{key:_.c.u,shortKey:!0,handler:this.getRichTextKeypressHandler({key:_.c.u,shortKey:!0},d.F(),{type:On.DeltaFormattingType.Underline})},strikethrough:{key:_.c.x,shortKey:!0,shiftKey:!0,handler:this.getRichTextKeypressHandler({key:_.c.x,shortKey:!0,shiftKey:!0},d.F(),{type:On.DeltaFormattingType.Strikethrough})},insertHyperlink:{key:_.c.k,shortKey:!0,handler:this.getRichTextKeypressHandler({key:_.c.k,shortKey:!0},d.F())},highlight:{key:_.c.h,shortKey:!0,altKey:!0,handler:this.getRichTextKeypressHandler({key:_.c.h,shortKey:!0,altKey:!0},d.t())},undo:{key:_.c.z,shortKey:!0,handler:function(){return d.F()&&d.E()&&vr().onKeyPress({key:_.c.z,shortKey:!0}),!0}}}},t.prototype.getRichTextKeypressHandler=function(e,t,n){var r=this;return function(){var o;if(!t)return!1;var i=null===(o=r.myQuill)||void 0===o?void 0:o.getFormat();return!((null==i?void 0:i.atmention)||d.E()&&(n&&vr().applyFormattingToCurrentSelection(n),vr().onKeyPress(e),1))}},t.prototype.tabKeyHandler=function(){return d.U()},t.prototype.getQuillScrollingContainer=function(){return this.props.isHeightBounded?"#".concat(Object(ee.x)(this.props.id)):this.props.scrollingContainerId?"#".concat(this.props.scrollingContainerId):void 0},t.prototype.initializeQuill=function(){var e={keyboard:{bindings:this.getKeyboardBindings()}};try{this.myQuill=function(e,t,n,r){var s="#".concat(Object(ee.w)(e.id)),l=[];d.d()&&l.push(["a",wn]),d.F()&&l.push(['[style*="text-decoration"]',In]),e.richTextCapabilities&&On.DeltaFormattingType.Image&&en.register(En);var c={formats:Bn(),scrollingContainer:r,modules:Object(o.__assign)(Object(o.__assign)({},t),{clipboard:{isAtmentionSupported:Wt(e),matchers:l.length>0?l:void 0}})};e.placeholder&&(c.placeholder=e.placeholder);var p=new en(s,c);if(function(e,t,n,r,o){var i=e.root;if(i){i.spellcheck=!0,e.history.options.delay=500,i.id=t,i.setAttribute("aria-haspopup","true"),i.setAttribute("role","textbox"),n&&i.setAttribute("aria-describedby",n),d.U()&&!o&&i.setAttribute("tabindex","-1"),r&&i.setAttribute("aria-label",r);var s=e.clipboard&&e.clipboard.container;s&&s.setAttribute("aria-hidden","true")}else Object(a.k)().assertConditionTag(!1,"root element on Quill is undefined",595891799)}(p,e.id,e.accessibilityDescribedBy,e.accessibilityLabel,e.isTabbable),e.defaultValue){var u=Hn(e.defaultValue);p.setContents(JSON.parse(u),"api")}return p.enable(),p.on("text-change",(function(e,t,r){if(Object(a.k)().assertConditionTag(!!p.root,"root element on Quill is undefined",559491103),p.root&&""===p.root.textContent&&Gn(t)){var o=window.getSelection(),s=o&&o.anchorNode?o.anchorNode.parentNode:null,l=Jt.find(s);l&&"scroll"===l.statics.blotName&&Object(a.k)().assertConditionTag(!1,"Quill editor crash in Chrome/Edge/Safari, unable to complete replace operation",589084383)}n(e,t,r),d.d()&&function(e,t){if(Object(i.n)(t.ops,"ops should always be definied when parsing for hyperlinks.",i.d.reserveTag(562937945)),2===t.ops.length&&t.ops[1].insert&&t.ops[1].attributes&&t.ops[1].attributes.hyperlink){var n=window.getSelection(),r=n&&n.anchorNode?n.anchorNode.parentNode:null;if(!r)return;var o=Jt.find(r);if(!o)return;Wn(e,o.offset(e.scroll),o.length())}if(2===t.ops.length&&t.ops[0].retain&&(u=t.ops[1].insert,/\s/.test(u))){var a=t.ops[0].retain,s=e.getText().substr(0,a).match(Mn);if(!s)return;var l=s[0],c=s[0].trimRight(),p=[];a>l.length&&p.push({retain:a-l.length}),p.push({retain:c.length,attributes:{hyperlink:JSON.stringify({url:c,editable:!0})}}),1===p.length&&p[0].retain?Wn(e,0,p[0].retain):2===p.length&&p[0].retain&&p[1].retain&&Wn(e,p[0].retain,p[1].retain),e.updateContents(new Yt(p))}var u}(p,e)})),p}(this.props,e,this.onTextChangedHandler,this.getQuillScrollingContainer()),this.myQuill.on("selection-change",this.selectionChangeHandler)}catch(e){throw e}},t.prototype.onKeyUpHandler=function(e){Object(_.f)(e.key)===_.b.Control&&Vn(this.editorRef,!1)},t.prototype.onKeyDownHandler=function(e){Object(_.f)(e.key)===_.b.Control&&Vn(this.editorRef,!0),Object(_.f)(e.key)===_.b.Escape&&this.handleEscapeKeys()&&e.stopPropagation(),this.props.onKeyDown&&this.props.onKeyDown(e)},t.prototype.onKeyPressHandler=function(e){},t.prototype.enterNewline=function(e){var t=this;if(!this.myQuill)return Object(a.k)().assertConditionTag(!1,"this.myQuill should always be defined if in keyboard handler",588805509),!1;var n=function(){return Object(i.n)(t.myQuill,"Quill must be defined when processing new line.",i.d.reserveTag(576583249)),t.myQuill.insertText(t.myQuill.getSelection().index,"\n"),!1},r=window.getSelection(),o=r&&r.anchorNode?r.anchorNode.parentNode:null,s=Jt.find(o);if(s&&"atmention"===s.statics.blotName){var l=s.offset(this.myQuill.scroll),c=this.myQuill.getSelection();return c.index===l||c.index===l+s.length()||this.removeAtFormat(s.offset(this.myQuill.scroll),s.length()),n()}return!e||n()},t.prototype.handleCommitKeys=function(){return!(!this.props.onCommitRequested||this.isEditorEmpty()||(this.props.onCommitRequested(L.a.KeyboardShortcut),0))},t.prototype.handleEscapeKeys=function(){return!!this.props.onEscapeRequested&&(this.props.onEscapeRequested(),!0)},t.prototype.onFocusHandler=function(e){var t;if(this.editorRef){var n=e.target;if(n&&n.classList.contains("ql-clipboard"))return;null===(t=document.getElementById(Object(ee.w)(this.props.id)))||void 0===t||t.removeAttribute("tabindex");var r=document.activeElement;this.editorRef.contains(r)&&this.editorRef!==r&&this.isQuillCursorPositionSet||this.focus(),this.props.onFocus&&this.props.onFocus(),d.E()&&this.myQuill&&vr().setActiveEditorInfo({editor:this.myQuill,richTextCapabilities:this.props.richTextCapabilities}),e.stopPropagation(),this.lastKnownCursorIndex=void 0}},t.prototype.onBlurHandler=function(e){var t,n,r,o=e.relatedTarget||document.activeElement;if(null===(t=document.getElementById(Object(ee.w)(this.props.id)))||void 0===t||t.setAttribute("tabindex","-1"),d.f()){var i=document.getElementById(Object(ee.G)());if(this.props.onEditorBlur&&!Pn.pasteOperationInProgress&&o!==this.editorRef&&e.target!==this.editorRef){var a=o;i&&(i.contains(a)||a.contains(i))||this.props.onEditorBlur()}}else this.props.onEditorBlur&&!Pn.pasteOperationInProgress&&o!==this.editorRef&&e.target!==this.editorRef&&this.props.onEditorBlur();this.lastKnownCursorIndex=null===(r=null===(n=this.myQuill)||void 0===n?void 0:n.getSelection())||void 0===r?void 0:r.index},t.prototype.isEditorEmpty=function(){return!(!this.myQuill||!this.myQuill.editor.isBlank())},t.prototype.setContents=function(e,t){if(this.myQuill){var n=Hn(e),r=JSON.parse(n);this.myQuill.setContents(r),this.isRestoreInProgress&&Vn(this.editorRef,!1);var o=null!=t?t:this.myQuill.getLength();this.lastKnownCursorIndex=o,this.myQuill.hasFocus()&&this.setSelection(o)}},t.prototype.getContentsAsync=function(){var e=this;return this.isRestoreInProgress&&this.props.savedDraftContent?this.props.savedDraftContent.editorContent:new Promise((function(t,n){if(e.myQuill){var r=e.myQuill.getContents();t(function(e){var t=X.c?Object(a.k)().createActivityObject("GetOfficeDeltaFromQuill",Object(a.l)(a.g.GlobalAPI),Object(a.j)()):void 0,n=JSON.parse(e);Object(i.n)(n.ops,"Quill operations must be defined.",i.d.reserveTag(562937944));var r=!1;if(Object(Vt.e)()){var o=1===Vt.a.getThemeAPI().getThemeMode();r=o}var s={ops:[]},l=n.ops.map((function(e){if(void 0!==e.insert){var n={insert:e.insert};if(e.attributes){if(e.attributes.optional&&("string"==typeof e.attributes.optional?n.optional=JSON.parse(e.attributes.optional):n.optional=e.attributes.optional),n.attributes={},e.attributes.atmention&&("string"==typeof e.attributes.atmention?n.attributes.atmention=JSON.parse(e.attributes.atmention):n.attributes.atmention=e.attributes.atmention),d.d()&&e.attributes.hyperlink&&("string"==typeof e.attributes.hyperlink?n.attributes.link=JSON.parse(e.attributes.hyperlink).url:n.attributes.link=e.attributes.hyperlink.url,n.attributes.link&&(n.attributes.link=Nn(n.attributes.link))),d.F()&&!e.attributes.atmention&&(e.attributes.bold&&(n.attributes.weight=700),e.attributes.strike&&(n.attributes.strikethrough=e.attributes.strike),e.attributes.italic&&(n.attributes.italic=e.attributes.italic),e.attributes.underline&&(n.attributes.underline=e.attributes.underline)),d.e()&&e.attributes.list)switch(n.attributes.paragraph={},e.attributes.list){case xn.a.none:n.attributes.paragraph.listType=xn.c.None;break;case xn.a.disc:n.attributes.paragraph.listType=xn.c.Bullet;break;case xn.a.decimalParenthesis:n.attributes.paragraph.listType=xn.c.NumberArabic,n.attributes.paragraph.listEndType=xn.b.Parenthesis;break;case xn.a.decimalPeriod:n.attributes.paragraph.listType=xn.c.NumberArabic,n.attributes.paragraph.listEndType=xn.b.Period;break;case xn.a.lowerAlphaParenthesis:n.attributes.paragraph.listType=xn.c.AlphabetLowerCase,n.attributes.paragraph.listEndType=xn.b.Parenthesis;break;case xn.a.lowerAlphaPeriod:n.attributes.paragraph.listType=xn.c.AlphabetLowerCase,n.attributes.paragraph.listEndType=xn.b.Period;break;case xn.a.upperAlphaParenthesis:n.attributes.paragraph.listType=xn.c.AlphabetUpperCase,n.attributes.paragraph.listEndType=xn.b.Parenthesis;break;case xn.a.upperAlphaPeriod:n.attributes.paragraph.listType=xn.c.AlphabetUpperCase,n.attributes.paragraph.listEndType=xn.b.Period;break;case xn.a.lowerRomanParenthesis:n.attributes.paragraph.listType=xn.c.NumberRomanLowerCase,n.attributes.paragraph.listEndType=xn.b.Parenthesis;break;case xn.a.lowerRomanPeriod:n.attributes.paragraph.listType=xn.c.NumberRomanLowerCase,n.attributes.paragraph.listEndType=xn.b.Period;break;case xn.a.upperRomanParenthesis:n.attributes.paragraph.listType=xn.c.NumberRomanUpperCase,n.attributes.paragraph.listEndType=xn.b.Parenthesis;break;case xn.a.upperRomanPeriod:n.attributes.paragraph.listType=xn.c.NumberRomanUpperCase,n.attributes.paragraph.listEndType=xn.b.Period;break;default:n.attributes.paragraph.listType=xn.c.None}d.t()&&!e.attributes.atmention&&(e.attributes.background&&(n.attributes.highlight=r?Kn(e.attributes.background,0):e.attributes.background),e.attributes.color&&(n.attributes.color=r?Kn(e.attributes.color,0):e.attributes.color))}if(e.insert.image){n.optional||(n.optional={});var o=e.insert.image;o.base64=o.src,delete o.src,n.optional.image=o,n.insert=""}return n}return t&&t.failTag(595194443,-2130957544),Object(a.k)().assertConditionTag(!1,"Translation Error: op in quill delta is not insert. Inserting empty insert operation.",i.d.reserveTag(595194444)),{insert:""}}));return l.length?(s.ops=l,Fn(s),t&&t.successTag(595194445),JSON.stringify(s)):(t&&t.failTag(595194446,-2130957544),Object(a.k)().assertConditionTag(!1,"Translation Error: Quill Delta should never have an empty operation",i.d.reserveTag(595194447)),JSON.stringify(new Yt))}(JSON.stringify(r))),d.f()&&e.selectedSmartReply&&(e.logSmartReplyPostEditActivity(),e.selectedSmartReply=void 0,e.smartReplyEditHistory=cr.NoEdits)}else n(new u.a(B.e,i.d.reserveTag(588351390),-2130957550))}))},t.prototype.getCursorPositionAsync=function(){var e=this;return this.isRestoreInProgress&&this.props.savedDraftContent?this.props.savedDraftContent.editorCursorPosition||Promise.resolve(void 0):new Promise((function(t,n){var r=e.myQuill?e.myQuill.getSelection():void 0;t(r?r.index:e.lastKnownCursorIndex)}))},t.prototype.clear=function(){var e;null===(e=this.myQuill)||void 0===e||e.setText("")},t.prototype.blur=function(){var e;null===(e=this.myQuill)||void 0===e||e.blur()},t.prototype.focus=function(){var e;this.myQuill&&(this.isQuillCursorPositionSet?this.myQuill.focus():this.setSelection(null!==(e=this.lastKnownCursorIndex)&&void 0!==e?e:this.myQuill.getLength()))},t.prototype.setSelection=function(e){if(this.myQuill)try{var t=Math.min(e,this.myQuill.getLength());t<0?(Object(a.k)().assertConditionTag(!1,"Selection index should not be negative. Its current value is: ".concat(t),508048466),this.myQuill.focus()):this.myQuill.setSelection(t,0)}catch(e){Object(a.k)().assertConditionTag(!1,Object(i.l)(e),556339362),this.myQuill.focus()}},t.prototype.getDisplayMode=function(){return this.props.displayMode},t.prototype.shouldHideMentionColors=function(){return!1},t.prototype.renderAdditionalEditorContent=function(){},t.prototype.handleShowSmartReplyPicker=function(){setTimeout(this.handleShowSmartReplyPickerInner,pr.a)},t.prototype.onResolveSmartReplySuggestions=function(){var e;return(null===(e=this.props.smartReplyProps)||void 0===e?void 0:e.smartReplies)||null},t.prototype.renderSmartReply=function(e,t){var n=t.suggestionModel.selected?this.styles.SuggestedSmartReplyItem:this.styles.SmartReplyItem;return s.createElement("span",{className:n},e)},t.prototype.handleSmartReplySelection=function(e){var t,n=null!==(t=this.onResolveSmartReplySuggestions())&&void 0!==t?t:[];if(-1!==n.indexOf(e)){var r=n.indexOf(e)+1,o=Object(a.k)().createActivityObject("SmartReplyClicked",Object(a.l)(a.g.ReviewedAsNotNecessary),Object(a.n)({diagnosticLevel:a.b.BasicEvent}));o.addDataField("ClickPosition",r,a.d.SystemMetadata),o.addDataField("SmartReplyLength",e.length,a.d.SystemMetadata),Object(i.n)(this.myQuill,"Quill should be defined when processing smart reply selection.",i.d.reserveTag(576583250));var s=this.myQuill.getSelection();s&&this.myQuill.insertText(s.index,e,"api"),this.selectedSmartReply=e,o.successTag(588292807)}},t.prototype.onSmartRepliesShown=function(){this.toggleSmartReplyAriaAttributes(!0)},t.prototype.onSmartRepliesHidden=function(){this.toggleSmartReplyAriaAttributes(!1)},t.prototype.renderSmartReplyPicker=function(){var e;if(!d.f()||!this.props.smartReplyProps||!this.editorContainerRef.current)return null;var t=Object(ee.U)(this.props.id),n=Object(z.a)((function(e,n){return{headerItemsProps:[{renderItem:function(){return s.createElement("div",{className:e,id:t},n)},shouldShow:function(){return!0}}]}}))(this.styles.SmartReplyHeader,null===(e=this.props.smartReplyProps)||void 0===e?void 0:e.pickerTitle);return s.createElement(mr,{componentRef:this.smartReplyPickerRef,calloutWidth:Object(pe.g)(),suggestionItems:this.onResolveSmartReplySuggestions()||[],suggestionsStore:new nr.a,onResolveSuggestions:this.onResolveSmartReplySuggestions,onChange:this.handleSmartReplySelection,pickerSuggestionsProps:n,onZeroQuerySuggestion:this.onResolveSmartReplySuggestions,pickerCalloutProps:{ariaLabelledBy:t,target:this.editorContainerRef.current,className:this.styles.SmartReplyCallout},inputElement:this.getQuillEditorFromFocusContainerDiv(),onRenderSuggestionsItem:this.renderSmartReply,onSuggestionsShown:this.onSmartRepliesShown,onSuggestionsHidden:this.onSmartRepliesHidden})},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(s.PureComponent),Tr=Cr,Or=n(484),xr=n(333),Sr=n(1035),kr=n(740),Pr=[{UserId:"S::mynameisannie@sharedComments.com::3od7ob07-08q8-0sjs-lob9-7p956l88b3rp",DisplayName:"Annie Lindqvist (Redmond)",Email:"mynameisannie@sharedComments.com",Provider:"AD"},{UserId:"S::ValentinaCanWrite@microsoft.com::87597fbh-6c1y-rdw6-zxf9-21m8o4s3w721",DisplayName:"Valentina Lovric",Email:"ValentinaCanWrite@microsoft.com",Provider:"AD"},{UserId:"S::nichoCanWrite@microsoft.com::89wmux1c-l2o8-zyv9-oj3q-w30p912pi1zf",DisplayName:"Nicho Lundberg",Email:"nichoCanWrite@microsoft.com",Provider:"AD"},{UserId:"S::BellirinaCanReview@microsoft.com::87597fbh-6c1y-rdw6-zxf9-32n9p5t4x832",DisplayName:"Bellirina Rosa",Email:"BellirinaCanReview@microsoft.com",Provider:"AD"},{UserId:"S::aaronReid@microsoft.com::iyy40m52-99h4-a8kc-9d56-j988s9j17755",DisplayName:"Aaron Reid (Asia Pacific Research & Development)",Email:"aaronReid@microsoft.com",Provider:"AD"},{UserId:"S::Roko@microsoft.com::4zvf82t2-140h-3506-l8vm-zgg95407x3h0",DisplayName:"Roko Kolar (India Development Center)",Email:"Roko@microsoft.com",Provider:"AD"},{UserId:"S::Christian@microsoft.com::5azgo6y8-1b38-d2ah-7t95-jqvg5r1nmvx1",DisplayName:"Christian Bergqvist (Israel Research & Development)",Email:"Christian@microsoft.com",Provider:"AD"},{UserId:"S::Maor@microsoft.com::lqj9p96z-fe80-zx4v-a19n-2855t8yp0b80",DisplayName:"Maor Sharett (Vancouver)",Email:"Maor@microsoft.com",Provider:"AD"},{UserId:"S::Anny@microsoft.com::27f75c64-w2kj-7rye-3823-6fs244j9553y",DisplayName:"Anny Lindqvist (New England Research & Development)",Email:"Anny@microsoft.com",Provider:"AD"},{UserId:"S::Aron@microsoft.com::tkec2ao2-h3n4-asqv-lwcm-nuj74bc2501r",DisplayName:"Aron Reid (Silicon Valley & San Francisco)",Email:"Aron@microsoft.com",Provider:"AD"},{UserId:"S::Alix@microsoft.com::9ooh72e8-0224-0tdi-8of3-vf01g64jt140",DisplayName:"Alix Lundberg",Email:"Alix@microsoft.com",Provider:"AD"},{UserId:"S::Roko@microsoft.com::kj1i4m3e-2t48-48tb-54mh-xl5278i109lc",DisplayName:"Roko Kular",Email:"Roko@microsoft.com",Provider:"AD"},{UserId:"S::Christian@microsoft.com::ef944246-30s0-qj56-87le-a4mz2b8k1337",DisplayName:"Christian Bergqvest",Email:"Christian@microsoft.com",Provider:"AD"},{UserId:"S::Valintina@microsoft.com::fjo0bk47-y6q8-20wz-g4na-1d5u572q2pid",DisplayName:"Valintina Lovric",Email:"Valintina@microsoft.com",Provider:"AD"},{UserId:"S::Maor@microsoft.com::zt3sdbse-e073-1562-1js5-v5x78of1p09r",DisplayName:"Maor Sharet",Email:"Maor@microsoft.com",Provider:"AD"},{UserId:"S::Anny@microsoft.com::d4268h1x-6568-bh7s-k789-om88c1f90690",DisplayName:"Anny Lindqvest",Email:"Anny@microsoft.com",Provider:"AD"},{UserId:"S::Alix@microsoft.com::qkxh95h2-22f5-u2z3-h2l2-j5i144rv6480",DisplayName:"Alix Lunberg",Email:"Alix@microsoft.com",Provider:"AD"},{UserId:"S::Annie@microsoft.com::ujy2cg5t-1ya6-v7us-0eqt-0dw5r1p6p547",DisplayName:"Annie Lindqvest",Email:"Annie@microsoft.com",Provider:"AD"},{UserId:"S::Alixander@microsoft.com::91e1zb0b-0321-7a9x-6xui-gwgn2brkup19",DisplayName:"Alixander Lundberg",Email:"Alixander@microsoft.com",Provider:"AD"},{UserId:"S::Anny@microsoft.com::0s510228-n7b1-7u4d-6w13-2t2j8p70bhg4",DisplayName:"Anny Lundqvist",Email:"Anny@microsoft.com",Provider:"AD"},{UserId:"S::Anny@microsoft.com::a560500t-4w06-1712-pgul-b9az2s18kv9g",DisplayName:"Anny Lundqvist (Redmond)",Email:"Anny@microsoft.com",Provider:"AD"},{UserId:"S::Maor@microsoft.com::t2k8y26d-x1eo-qza4-52qr-wtkjr8f233r8",DisplayName:"Maor Shorett",Email:"Maor@microsoft.com",Provider:"AD"},{UserId:"S::Valentina@microsoft.com::f480ks5p-fsd9-tk2u-9xui-1852ex3ve541",DisplayName:"Valentina Lovrics",Email:"Valentina@microsoft.com",Provider:"AD"},{UserId:"S::Maor@microsoft.com::clt641r7-d5si-dd5d-d045-fxu1g97a7r9m",DisplayName:"Maor Sharet",Email:"Maor@microsoft.com",Provider:"AD"},{UserId:"S::Valentina@microsoft.com::8s6j87ee-b7ic-ga48-ox0z-nm37syw7971k",DisplayName:"Valentina Lovrecs",Email:"Valentina@microsoft.com",Provider:"AD"},{UserId:"S::Maor@microsoft.com::e9m0hlvc-cc89-edn9-o2ux-mqwn9m108md4",DisplayName:"Maor Sharitt",Email:"Maor@microsoft.com",Provider:"AD"}].map((function(e){var t,n=3!==(t=e.UserId.split("::")).length?{UPN:"UnknownUPN",AadObjectId:"UnknownAadObjectId",SubstrateId:"UnknownSubstrateId"}:{UPN:t[1],AadObjectId:t[2],SubstrateId:"".concat(t[2],"@").concat("v0pt9p5w-fw09-7c24-k1r3-lpn9bjq978he")};return{AadObjectId:n.AadObjectId,Id:n.SubstrateId,Name:e.DisplayName,UserPrincipalName:n.UPN,EmailAddresses:[n.UPN],SuggestionType:"Person",SuggestionSubtype:"OrganizationUser",HostAppSuggestion:{},Source:"Loki",SuggestionOrigin:"Search"}}));function Er(e){return new Promise((function(t,n){setTimeout((function(){if(""===e)t(Pr);else{var n=Pr.filter((function(t){return t.Name.toLocaleLowerCase().includes(e.toLocaleLowerCase())||t.EmailAddresses[0].toLocaleLowerCase().includes(e.toLocaleLowerCase())||t.UserPrincipalName.toLocaleLowerCase().includes(e.toLocaleLowerCase())}));t(n)}}),200)}))}var jr,Ir,wr,Ar=n(756),Rr=n(154),Dr=((jr={}).android="Android",jr.web="Web",jr.win32="Win32",jr.macos="Mac",jr.ios="iOS",jr),_r=((Ir={}).android="OfficeAndroid",Ir.web="OfficeWebApps",Ir.win32="OfficeWin32",Ir.macos=void 0,Ir.ios="OfficeiOS",Ir),Nr=void 0,Mr=function(e){function t(t){var n=e.call(this,t)||this;return n.configureLPP=function(e){try{if(e&&!n.state.livePersonaPickerInstance){if(!Object(Sr.a)()){var t=(s=Object(a.k)().getMetadata(),{clientType:_r[Object(Rr.a)()],hostAppName:s.appName,hostAppPlatform:Dr[Object(Rr.a)()],hostAppRing:s.releaseAudienceGroup||s.ring||s.releaseAudience,hostAppVersion:s.appVersion,complianceEnvironment:s.sovereignEnvironmentName?(r=s.sovereignEnvironmentName,"Df"===r?"Df":"Msit"===r?"Msit":"Prod"===r?"Prod":"Blackforest"===r?"Blackforest":"GccModerate"===r?"GccModerate":"GccHigh"===r?"GccHigh":"DoD"===r?"DoD":"Gallatin"===r?"Gallatin":"AG08"===r?"AG08":"AG09"===r?"AG09":"Unknown"):"Prod"});e.initializeLivePersonaPicker("ACCOUNT_IDENTIFIER",Object(o.__assign)(Object(o.__assign)({},t),{complianceEnvironment:t.complianceEnvironment,clientCorrelationId:Object(a.k)().getMetadata().sessionId,refreshAuthToken:n.refreshAuthToken,getHostAppSuggestions:n.isTestEnvironment()?Er:void 0,offline:n.isTestEnvironment(),settings:d.m()?{suggestUseEmailAddress:!0}:void 0}))}Object(Sr.b)()}Nr=e.getLivePersonaPickerContainer("ACCOUNT_IDENTIFIER"),n.state.livePersonaPickerInstance||n.setState({livePersonaPickerInstance:Nr})}catch(e){Object(a.k)().assertConditionTag(!1,"configureLPP: ".concat("string"==typeof e?e:Object(i.l)(e)),595637921)}var r,s},n.renderLivePersonaPicker=function(){return n.state.livePersonaPickerInstance?s.createElement(n.state.livePersonaPickerInstance,{inputId:n.props.target?n.props.target:"",strings:n.state.peoplePickerStrings,isOpen:n.props.inAtMentionMode,maxHeight:400,maxWidth:250,onSuggestionSelected:n.props.onSuggestionSelected,onShow:n.props.onShow,onDismiss:n.props.onDismiss,componentRef:n.onPeoplePickerRef,onSuggestionHighlighted:n.props.onSuggestionHighlighted,suggestionListId:ee.C()}):null},n.onPeoplePickerRef=n.onPeoplePickerRef.bind(n),n.refreshAuthToken=n.refreshAuthToken.bind(n),n.state={livePersonaPickerInstance:Nr,peoplePickerStrings:{loading:"Loading...",error:"Can't search right now.",allResults:"No more results found.",limitedResults:"Top results",emptyResults:"No suggestions found for now.",useThisAddress:"Use this address",atMentionsModePlaceholderText:"Type @ to mention a person",pickerModePlaceholderText:"Enter a name or email address",suggestionsAnnouncement:"Number of suggestions found: ",selectedSuggestionAccessibilityLabel:"Suggestion",selectedSuggestionNumberAccessibilityLabel:"of",suggestionsAvailableAnnouncement:"Suggestions Available"}},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;Object(Mt.a)().then((function(t){e.setState({peoplePicker:t})})).catch(Object(Bt.a)(i.d.reserveTag(595632143))),this.state.lppImports||Object(Ar.b)().then((function(t){if(t){e.configureLPP(t);var n=Object(kr.b)().getLocaleInfo().uiCulture;t.getLivePersonaPickerStrings(n).then((function(t){e.setState({peoplePickerStrings:t})})).catch((function(e){Object(a.k)().assertConditionTag(!1,"failed to fetch LPP strings for locale: ".concat(n,", error: ").concat(e.message),595637531)})),e.setState({lppImports:t})}else Object(a.k)().assertConditionTag(!1,"LPP was not able to load.",576582748)})).catch(Object(Bt.a)(i.d.reserveTag(591155841)))},t.prototype.isTestEnvironment=function(){var e=Object(a.k)().getMetadata(),t="-4"===e.ring&&"DC2"===e.dataCenter;return X.c||t},t.prototype.refreshAuthToken=function(e){return this.props.getAuthToken?this.props.getAuthToken(xr.c.Loki):(Object(a.k)().assertConditionTag(!1,"getAuthToken cannot be undefined",595637532),Promise.resolve(""))},t.prototype.onPeoplePickerRef=function(e){this.peoplePickerRef=e},t.prototype.onMentionsTextChanged=function(e,t){this.peoplePickerRef&&(t?this.props.onDismiss():this.peoplePickerRef.onQueryChanged(e))},t.prototype.onMentionsKeyDownHandler=function(e){if(this.peoplePickerRef&&(Object(a.k)().assertConditionTag(!!this.state.peoplePicker,"peoplepicker did not lazy-load correctly",595632416),e&&e.keyCode&&this.props.inAtMentionMode&&this.state.lppImports)){var t=this.state.lppImports.keyboardEventKeyCodeToCustomKey[e.keyCode];void 0!==t&&this.peoplePickerRef.onCustomKeyPressed(t)}},t.prototype.render=function(){return this.renderLivePersonaPicker()},t}(s.PureComponent),Br=n(890),Lr=en.import("delta"),Fr=function(e){function t(t){var n=e.call(this,t)||this;return n.startIndexOfMention=0,n.onAtMentionSuggestionHighlighted=function(e){n.setState({activeDescendantId:e})},n.getActiveDescendantId=function(){return n.state.activeDescendantId},n.isInAtMentionMode=function(){return n.state.inAtMentionMode},n.exitAtMentionMode=n.exitAtMentionMode.bind(n),n.insertMentionText=n.insertMentionText.bind(n),n.onSuggestionSelected=n.onSuggestionSelected.bind(n),n.onKeyDownHandler=n.onKeyDownHandler.bind(n),n.onKeyPressHandler=n.onKeyPressHandler.bind(n),n.onTextChangedHandler=n.onTextChangedHandler.bind(n),n.onMentionHostRef=n.onMentionHostRef.bind(n),n.enterAtMentionMode=n.enterAtMentionMode.bind(n),n.onShowHandler=n.onShowHandler.bind(n),n.enterNewline=n.enterNewline.bind(n),n.getKeyboardBindings=n.getKeyboardBindings.bind(n),n.state={activeDescendantId:void 0,inAtMentionMode:!1,isReplacingContentAtBeginning:!1,mentionQueryString:"",hadWordSelectionShortcut:!1},n}return Object(o.__extends)(t,e),t.prototype.enterNewline=function(t){return!this.state.inAtMentionMode&&e.prototype.enterNewline.call(this,t)},t.prototype.handleEscapeKeys=function(){return this.state.inAtMentionMode||e.prototype.handleEscapeKeys.call(this)},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=this.props).onUnmount)||void 0===t||t.call(e)},t.prototype.componentDidUpdate=function(t,n){n.inAtMentionMode&&!this.state.inAtMentionMode&&this.AtMentionRef&&this.AtMentionRef.onMentionsTextChanged("",!0);var r=this.state.inAtMentionMode,o=this.getQuillEditorFromFocusContainerDiv();if(o&&(r!==n.inAtMentionMode&&$n(o,ur(r,or.LPP)),!r&&this.isSmartReplyPickerDisplayed()&&($n(o,ur(!0,or.SmartReply)),o.removeAttribute("aria-activedescendant")),r&&!this.isSmartReplyPickerDisplayed())){var i=this.getActiveDescendantId();i&&o&&o.setAttribute("aria-activedescendant",i)}e.prototype.componentDidUpdate.call(this,t,n)},t.prototype.onMentionHostRef=function(e){this.AtMentionRef=e},t.prototype.updateCurrentMentions=function(e,t){var n=Jn(t),r=Jn(t.compose(e));Object(p.o)(n,r)&&this.props.onMentioneesStillInDraftUpdated(r)},t.prototype.onTextChangedHandler=function(t,n,r){if(this.state.isReplacingContentAtBeginning&&this.setState({isReplacingContentAtBeginning:!1}),this.state.inAtMentionMode&&this.AtMentionRef){var o=this.getMentionText();if(o&&o.length>0&&this.state.mentionQueryString!==o)if(o.split(" ").length>3)this.AtMentionRef.onMentionsTextChanged("",!0),this.setState({mentionQueryString:""});else{this.setState({mentionQueryString:o});var i=this.AtMentionRef.isTestEnvironment()?o.substr(1):o;this.AtMentionRef.onMentionsTextChanged(i,!1)}}this.props.displayMode===H.Editing&&d.b()&&(Gn(t)||Qn(t)||function(e){var t=!1;return e.forEach((function(e){t||(t=!!e.retain&&!!e.attributes&&null===e.attributes.atmention)})),t}(t))&&this.updateCurrentMentions(t,n),e.prototype.onTextChangedHandler.call(this,t,n,r)},t.prototype.onKeyPressHandler=function(e){if(this.myQuill){var t=this.myQuill.getSelection();if(t){if(this.setState({isReplacingContentAtBeginning:0===t.index&&t.length>0}),String.fromCharCode(e.which)!==Br.a)return;var n=this.myQuill.getText(t.index-1,1),r=/\s/.test(n),o=/\n/.test(n),i=""===n;(0===t.index||r||o||i)&&(this.enterAtMentionMode(),this.startIndexOfMention=t.index)}}else Object(a.k)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066520)},t.prototype.onKeyDownHandler=function(t){if(this.myQuill){var n=this.myQuill.getSelection();if(this.state.inAtMentionMode&&this.isEditorEmpty()&&this.exitAtMentionMode(),n&&this.state.inAtMentionMode){var r=Object(_.f)(t.key),o=n.index,i=t.ctrlKey,s=t.shiftKey;switch(this.setState({hadWordSelectionShortcut:i&&s&&(r===_.b.ArrowLeft||r===_.b.ArrowRight)}),r){case _.b.Backspace:var l=o>0&&this.startIndexOfMention===o-1,c=this.startIndexOfMention===o,p=o<this.startIndexOfMention;(l||c||p)&&!this.state.hadWordSelectionShortcut&&this.exitAtMentionMode(),this.state.hadWordSelectionShortcut&&this.setState({hadWordSelectionShortcut:!1});break;case _.b.Delete:o===this.startIndexOfMention&&this.exitAtMentionMode();break;case _.b.Tab:t.stopPropagation(),t.preventDefault();break;case _.b.ArrowUp:case _.b.ArrowDown:t.preventDefault();break;default:0===o&&n.length>0&&this.exitAtMentionMode()}}this.AtMentionRef&&this.AtMentionRef.onMentionsKeyDownHandler(t),e.prototype.onKeyDownHandler.call(this,t)}else Object(a.k)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066521)},t.prototype.getMentionText=function(){if(this.myQuill){var e=0;this.myQuill.getSelection()&&(e=this.myQuill.getSelection().index),e<this.startIndexOfMention&&Object(i.i)("selection moved before @ when inAtMentionMode: ".concat(this.state.inAtMentionMode,"\n      selectionIndex ").concat(e," startIndexOfMention ").concat(this.startIndexOfMention));var t;return t=e>this.startIndexOfMention?e-this.startIndexOfMention:e===this.startIndexOfMention?1:this.myQuill.getLength(),this.myQuill.getText(this.startIndexOfMention,t)}Object(a.k)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066522)},t.prototype.exitAtMentionMode=function(){this.setState({inAtMentionMode:!1,activeDescendantId:void 0,mentionQueryString:""}),this.updateAriaAttributes(!1)},t.prototype.enterAtMentionMode=function(){var e=this;this.setState({inAtMentionMode:!0}),setTimeout((function(){return e.updateAriaAttributes(!0)}))},t.prototype.onShowHandler=function(){this.enterAtMentionMode()},t.prototype.updateAriaAttributes=function(e){if(this.editorRef){var t=document.getElementById(this.props.id);if(t&&this.myQuill){if(t.hasAttribute("aria-controls")&&!e)t.removeAttribute("aria-controls");else if(e&&t.parentElement){var n=this.myQuill.getSelection();t.parentElement.focus(),n&&this.myQuill.setSelection(n.index,0)}}else Object(a.k)().assertConditionTag(!1,"Trying to use Quill div when not mounted in DOM",588805467)}},t.prototype.insertMentionText=function(e,t,n){if(this.myQuill){this.exitAtMentionMode(),this.props.onMentionCreated(n);var r=Object(p.g)(n),o=Object(p.h)(n),i=Xn.b.Resolved,s=(new Lr).retain(this.startIndexOfMention).delete(e).insert("@".concat(t),{atmention:JSON.stringify(Object(Xn.c)(r,o,i)),optional:JSON.stringify(Object(Xn.d)({directoryId:n.AadObjectId}))}).insert(" ");this.myQuill.updateContents(s,"api");var l=this.startIndexOfMention+t.length+2;this.myQuill.setSelection(l,0),Object(Or.b)(this.props.localizationAPI.formatString(227,t))}else Object(a.k)().assertConditionTag(!1,"Quill should be defined for editor handlers!",577066523)},t.prototype.onSuggestionSelected=function(e){this.insertMentionText(this.state.mentionQueryString.length,e.Name,e)},t.prototype.shouldHideMentionColors=function(){return this.state.isReplacingContentAtBeginning},t.prototype.renderAdditionalEditorContent=function(){return this.props.displayMode===H.Editing?s.createElement(Mr,{ref:this.onMentionHostRef,onSuggestionSelected:this.onSuggestionSelected,target:this.props.id,onShow:this.onShowHandler,onDismiss:this.exitAtMentionMode,inAtMentionMode:this.state.inAtMentionMode,getAuthToken:this.props.getAuthToken,onSuggestionHighlighted:this.onAtMentionSuggestionHighlighted}):void 0},t.prototype.getKeyboardBindings=function(){var t=this;return Object(o.__assign)(Object(o.__assign)({},e.prototype.getKeyboardBindings.call(this)),{enter:{key:_.c.Enter,handler:function(){var e;return(!d.f()||!(null===(e=t.smartReplyPickerRef.current)||void 0===e?void 0:e.isSuggestionsShown))&&t.enterNewline(!1)}}})},t}(Cr),Hr=er(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){if(this.props.displayMode!==H.Editing){var e={id:this.props.id,accessibilityLabel:this.props.accessibilityLabel,showFullContent:this.props.showFullComment,content:this.props.defaultValue,placeholder:this.props.placeholder,truncationOverlayColor:this.props.truncationOverlayColor,dulledAtMentions:this.props.dulledAtMentions,commentTabbable:this.props.commentTabbable,viewerMode:this.props.useReplyBoxStyling?mt.DisabledEditor:this.props.displayMode===H.Disabled?mt.DisabledComment:mt.ReadOnlyComment,truncationUIText:this.props.localizationAPI.getString(229),themeMode:Object(Vt.e)()?Vt.a.getThemeAPI().getThemeMode():void 0,onClickableTextClicked:this.props.onClickableTextClicked};return s.createElement(Zn,Object(o.__assign)({},e))}var t=this.props.componentTreeId.renderContextType;return this.props.supportsAtMentions&&Wt(this.props)?s.createElement(Fr,Object(o.__assign)({},this.props,{renderContextType:t})):s.createElement(Tr,Object(o.__assign)({},this.props,{renderContextType:t}))},t}(s.PureComponent),{componentTreeId:ne.a},"CommentEditor"),Ur=n(1211),zr=n(188),Kr=er(function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.getStyles=function(e){return Object(pe.e)({id:r.props.id,renderContextType:r.props.componentTreeId.renderContextType},!!r.props.taskTopperProps,r.getMaxHeight(),null==e?void 0:e.colors)},r.rootTabIndexValue=-1,r.cardRef=null,r.replyBoxRef=null,r.taskTopperCheckboxRef=null,r.onDraftEmptinessChanged=function(e){r.props.onDraftEmptinessChanged(r,e)},r.contextMenuProps=Object(E.c)((function(e,t,n,o){return{id:ee.e({id:e,renderContextType:t}),parentId:r.props.id,title:r.props.localizationAPI.getString(45),ariaLabel:r.props.localizationAPI.getString(45),onMenuClick:r.onContextMenuInteractionHandler,menuItems:n,itemType:F.CardContextMenuItem,tabIndex:o,renderContextType:t}}),5),r.reactionButtonProps=Object(E.c)((function(e,t,n,r,o,i,a,s,l){return d.a()?{commentId:e,isTabbable:n,onReactionPressed:r.onReactionPressed,renderContextType:t,usersByReactionType:o,buttonStrings:i,localizationAPI:a,reactionType:N.a.Like,userReactionSummary:null!=l?l:{Like:{count:0,currentUserReacted:!1}},preventDefaultKeyDownBehavior:void 0,preventReacting:s}:void 0}),5),r.reactionButtonStrings=Object(E.c)((function(){return{buttonLabel:r.props.localizationAPI.getString(231),buttonLabelPlural:r.props.localizationAPI.getString(239),buttonA11yDropdownText:r.props.localizationAPI.getString(240)}})),r.fetchReplyButton=Object(E.c)((function(e,t,n,o,i,a,s,l){var c=Z.e(l,e,!!a,s);switch(e){case T.a.Reply:case T.a.ReplyPreCommitPending:return{id:ee.T({id:t,renderContextType:n}),icon:2,isTabbable:i,disabled:o,onClick:r.sendReplyButtonClickHandler,onKeyDown:r.sendCommentButtonKeyDownHandler,text:r.props.localizationAPI.getString(48),accessibilityLabel:c,tooltipText:c,usePrimaryButtonStyling:!0};case T.a.ReplyPostCommitPending:return{disabled:!0,icon:2,onClick:function(){},text:r.props.localizationAPI.getString(48),accessibilityLabel:c,showDelayedSpinner:!0,tooltipText:c,usePrimaryButtonStyling:!0};case T.a.Draft:case T.a.DraftPreCommitPending:return{id:ee.T({id:t,renderContextType:n}),icon:2,isTabbable:i,disabled:r.shouldDisableSendButton(),onClick:r.sendReplyButtonClickHandler,onKeyDown:r.sendCommentButtonKeyDownHandler,text:r.props.localizationAPI.getString(48),accessibilityLabel:c,tooltipText:c,usePrimaryButtonStyling:!0};default:return}})),r.fetchCancelButton=Object(E.c)((function(e,t,n,o){switch(e){case T.a.Reply:case T.a.ReplyPreCommitPending:var i=r.props.localizationAPI.getString(15);return{id:ee.R({id:t,renderContextType:n}),icon:1,isTabbable:o,disabled:!1,onClick:r.cancelReplyButtonClickHandler,onKeyDown:r.cancelReplyButtonKeyDownHandler,text:i,accessibilityLabel:i,tooltipText:i,usePrimaryButtonStyling:!1};case T.a.ReplyPostCommitPending:var a=r.props.localizationAPI.getString(15);return{disabled:!0,icon:1,onClick:function(){},text:a,accessibilityLabel:a,tooltipText:a,usePrimaryButtonStyling:!1};default:return}})),r.getMemoizedCommitButtons=Object(E.c)((function(e,t,n,o,i,a,s,l){var c=[],p=r.fetchReplyButton(e,t,n,o,i,a,s,l);if(!p)return c;c.push(p);var u=r.fetchCancelButton(e,t,r.props.componentTreeId.renderContextType,i);return u?(c.push(u),c):c})),r.onEditorMount=function(){r.props.onCardEditorMounted(r.props.id)},r.onSaveDraftToSession=function(){r.textEditorRef&&r.props.onSaveDraft(r.getId(),r.textEditorRef)},r.onEditorUnmount=function(){r.onCardSaveDraft(r.textEditorRef)},r.renderWithContexts=function(e){r.styles=r.getStyles(e);var t=s.createElement(j.a,{className:r.getStyles(e).commentCardFocusTrapZone,disabled:r.shouldDisableFocusTrapZone(),disableFirstFocus:!0,forceFocusInsideTrap:!1,ignoreExternalFocusing:!0,isClickableOutsideFocusTrap:!0},r.renderCard(e));return r.logCardRendered(),d.x()?s.createElement(kt.a.Provider,{value:r.state.lpcEnabled},t):t},r.renderPosts=r.renderPosts.bind(r),r.expandButtonHandler=r.expandButtonHandler.bind(r),r.onPost=r.onPost.bind(r),r.onCancel=r.onCancel.bind(r),r.onEditorClick=r.onEditorClick.bind(r),r.shouldDisableSendButton=r.shouldDisableSendButton.bind(r),r.cardKeyDownHandler=r.cardKeyDownHandler.bind(r),r.cardClickHandler=r.cardClickHandler.bind(r),r.renderCommitRegion=r.renderCommitRegion.bind(r),r.replyBoxKeyDownHandler=r.replyBoxKeyDownHandler.bind(r),r.cancelReplyThenFocus=r.cancelReplyThenFocus.bind(r),r.cancelReplyButtonKeyDownHandler=r.cancelReplyButtonKeyDownHandler.bind(r),r.sendCommentButtonKeyDownHandler=r.sendCommentButtonKeyDownHandler.bind(r),r.cancelReplyButtonClickHandler=r.cancelReplyButtonClickHandler.bind(r),r.sendReplyButtonClickHandler=r.sendReplyButtonClickHandler.bind(r),r.expandButtonClickHandler=r.expandButtonClickHandler.bind(r),r.expandButtonKeyDownHandler=r.expandButtonKeyDownHandler.bind(r),r.renderableItemListScrollHandler=r.renderableItemListScrollHandler.bind(r),r.clearDraft=r.clearDraft.bind(r),r.onCardMouseEnter=r.onCardMouseEnter.bind(r),r.onCardMouseLeave=r.onCardMouseLeave.bind(r),r.setCardRef=r.setCardRef.bind(r),r.setReplyBoxRef=r.setReplyBoxRef.bind(r),r.setTaskTopperCheckboxRef=r.setTaskTopperCheckboxRef.bind(r),r.onContextMenuInteractionHandler=r.onContextMenuInteractionHandler.bind(r),r.editorBlurHandler=r.editorBlurHandler.bind(r),r.editorComponentRef=r.editorComponentRef.bind(r),r.onContextMenuItemMounted=r.onContextMenuItemMounted.bind(r),r.onEditorCommitRequested=r.onEditorCommitRequested.bind(r),r.onEditorEscapeRequested=r.onEditorEscapeRequested.bind(r),r.getContentsAsync=r.getContentsAsync.bind(r),r.getCursorPositionAsync=r.getCursorPositionAsync.bind(r),r.renderResolvedOrTaskTopper=r.renderResolvedOrTaskTopper.bind(r),r.hideCardHeader=r.hideCardHeader.bind(r),r.state={rootAuthorOpacity:1,headerHidden:!1,isAtMentionHintMessageAllowed:!1,lpcEnabled:!(!d.x()||!window.LivePersonaCardHoverTargetV2)},r.setTabIndex(t),r}return Object(o.__extends)(t,e),t.prototype.getCommentEditorCallbackProps=function(){return{componentRef:this.editorComponentRef,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onEditorBlur:this.editorBlurHandler,onFocus:this.onEditorFocus,onUnmount:this.onEditorUnmount}},t.prototype.setCardRef=function(e){this.cardRef=e},t.prototype.setReplyBoxRef=function(e){this.replyBoxRef=e},t.prototype.setTaskTopperCheckboxRef=function(){this.taskTopperCheckboxRef=document.getElementById(ee.j({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType})),this.taskTopperCheckboxRef&&this.setTabIndex(this.props)},t.prototype.setTabIndex=function(e){e.selected||e.isTabbable?(this.rootTabIndexValue=0,this.taskTopperCheckboxRef&&(this.taskTopperCheckboxRef.tabIndex=0)):(this.rootTabIndexValue=-1,this.taskTopperCheckboxRef&&(this.taskTopperCheckboxRef.tabIndex=-1))},t.prototype.getInnerElementsTabIndex=function(){return this.props.displayMode===T.a.CardPostCommitPending?-1:this.rootTabIndexValue},t.prototype.getRootTabIndex=function(){return this.rootTabIndexValue},t.prototype.getMaxHeight=function(){return this.props.maximumDimensions&&this.props.maximumDimensions.height?Math.max(this.props.maximumDimensions.height,pe.a):void 0},t.prototype.onCardMouseEnter=function(){this.props.onCardHighlightChange(this,!0)},t.prototype.onCardMouseLeave=function(){this.props.onCardHighlightChange(this,!1)},t.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),this.notifyRenderedOnce()},t.prototype.UNSAFE_componentWillUpdate=function(e,t){this.setTabIndex(e)},t.prototype.componentDidUpdate=function(e,t){var n=this.isActiveReply()||this.isActiveDraft();if(this.props.draftId&&!n&&Object(a.k)().assertConditionTag(!1,"CardDisplayMode inconsistent with draft warning state",593799004),d.j())if(this.props.draftId!==e.draftId)this.setState({isAtMentionHintMessageAllowed:!1});else if(!this.state.isAtMentionHintMessageAllowed){var r=void 0===e.currentMentionees||0===Object.keys(e.currentMentionees).length,o=void 0===this.props.currentMentionees||0===Object.keys(this.props.currentMentionees).length;if(r&&!o)try{var s=localStorage.getItem("SharedComments_NumberOfAtMentionHintMessageShown"),l=s?parseInt(s,10):0;l>=3?this.setState({isAtMentionHintMessageAllowed:!1}):(localStorage.setItem("SharedComments_NumberOfAtMentionHintMessageShown",(l+1).toString()),this.setState({isAtMentionHintMessageAllowed:!0}))}catch(e){Object(a.k)().assertConditionTag(!1,"Failed to update local storage: ".concat("string"==typeof e?e:Object(i.l)(e)),527720457)}}this.textEditorRef&&e.cardRelativeDraftingState===O.a.InCard&&this.props.cardRelativeDraftingState===O.a.InOtherContextOfThisCard&&this.props.onSaveDraft(this.getId(),this.textEditorRef),d.x()&&!this.state.lpcEnabled&&window.LivePersonaCardHoverTargetV2&&this.setState({lpcEnabled:!0})},t.prototype.focus=function(){this.props.displayMode!==T.a.ReplySessionRequestPending&&this.cardRef&&this.cardRef.focus({preventScroll:!0})},t.prototype.blur=function(){this.cardRef&&this.cardRef.blur()},t.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():new Promise((function(e,t){t(new u.a(B.e,i.d.reserveTag(589103744),-2130957550))}))},t.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():new Promise((function(e,t){e(void 0)}))},t.prototype.cardKeyDownHandler=function(e){var t=this.props.componentTreeId.renderContextType;switch(Object(_.f)(e.key)){case _.b.Tab:if(this.props.isTabbable){if(this.isActiveDraft()&&e.shiftKey&&this.shouldDisableSendButton()&&!this.shouldDisableFocusTrapZone()&&this.textEditorRef&&e.target===document.getElementById(ee.i({id:this.props.id,renderContextType:t},this.props.isNewThread)))this.textEditorRef.focus(),e.preventDefault();else if(!d.U()&&this.isActiveDraft()){var n=document.getElementById(ee.T({id:this.props.id,renderContextType:t})),r=document.getElementById(ee.t({id:this.props.id,renderContextType:t})),o=void 0;e.target!==n||e.shiftKey?e.target===r&&(o=e.shiftKey&&!this.shouldDisableSendButton()?n:this.textEditorRef):o=r,o&&(o.focus(),e.preventDefault())}e.stopPropagation()}break;case _.b.Enter:if(e.ctrlKey&&!this.props.isDraftEmpty&&(this.isActiveDraft()||this.isActiveReply())){this.props.onPost(this,L.a.KeyboardShortcut),e.stopPropagation(),e.preventDefault();break}case _.b.Space:e.currentTarget===e.target&&(this.toggleExpansion(),e.stopPropagation(),e.preventDefault())}},t.prototype.shouldClickTargetExpandCard=function(e){var t=this.props.componentTreeId.renderContextType,n=e.target,r=document.getElementById(ee.j({id:this.props.id,renderContextType:t}));if(r&&r.parentElement&&r.parentElement.contains(n))return!1;var o=document.getElementById(ee.W({id:this.props.id,renderContextType:t}));return!o||!o.contains(n)},t.prototype.cardClickHandler=function(e){this.props.hasSelectedChild||this.shouldClickTargetExpandCard(e)&&(this.props.onCardSelectExpand(this,!1,!1),e.stopPropagation())},t.prototype.contextMenuClickHandler=function(e,t){e.onClick(this.props.id,!!this.props.taskTopperProps),t&&t.stopPropagation()},t.prototype.expandButtonClickHandler=function(e){this.expandButtonHandler(),null==e||e.stopPropagation()},t.prototype.expandButtonKeyDownHandler=function(e){Object(_.f)(e.key)===_.b.Enter&&(this.expandButtonHandler(),e.stopPropagation())},t.prototype.renderableItemListScrollHandler=function(e){var t=e.target;if(t.id===ee.P({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType})){var n=t.scrollTop;this.setState({rootAuthorOpacity:n>pe.b?0:(pe.b-n)/pe.b})}},t.prototype.expandButtonHandler=function(){this.focus(),this.props.onCardSelectExpand(this,!0,!1)},t.prototype.onPost=function(e){this.props.onPost(this,e)},t.prototype.onCancel=function(){this.props.onCancel(this)},t.prototype.onEditorClick=function(e){this.props.displayMode===T.a.Normal&&this.props.onEditorPress(this),e.stopPropagation()},t.prototype.shouldDisableSendButton=function(){return!1!==this.props.isDraftEmpty},t.prototype.generateCardActionItems=function(e){var t=this,n=[];return e&&e.length>0&&(n=e.map((function(e){return{id:ee.d({id:t.props.id,renderContextType:t.props.componentTreeId.renderContextType},e.text),text:e.text,accessibilityLabel:e.text,onClick:t.contextMenuClickHandler.bind(t,e),icon:e.icon,tooltipText:e.tooltipText,tooltipDirection:I.a.topCenter,isTabbable:t.props.isTabbable}}))),n},t.prototype.renderCardFooter=function(){return s.createElement("div",{className:this.styles.cardFooter})},t.prototype.onContextMenuItemMounted=function(e){e&&e.focus()},t.prototype.onContextMenuInteractionHandler=function(e){e&&function(e){return void 0!==e.key}(e)&&Object(_.f)(e.key)===_.b.ArrowDown&&e.preventDefault()},t.prototype.renderCardHeader=function(){var e=this.props.componentTreeId.renderContextType;if(!this.state.headerHidden){var t=this.props.menuItems.length>0&&this.props.displayMode!==T.a.Resolved,n={id:this.props.id,author:this.props.author,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,anchorText:this.props.anchorText,contextMenuProps:t?this.contextMenuProps(this.props.id,e,this.props.menuItems,this.getInnerElementsTabIndex()):void 0,isResolvedCard:this.props.displayMode===T.a.Resolved,hideActions:t?this.props.displayMode===T.a.CardPostCommitPending:void 0,preventReacting:this.props.preventReacting,localizationAPI:this.props.localizationAPI,onCancelDraft:this.onCancel,rootAuthorOpacity:this.state.rootAuthorOpacity,displayMode:this.props.displayMode,cardCollapsedState:this.props.cardCollapsedState,menuItems:this.props.menuItems,preventDefaultKeyDownBehavior:this.props.preventDefaultKeyDownBehavior,isTabbable:this.props.isTabbable,reactionButtonProps:this.reactionButtonProps(this.props.id,e,this.props.isTabbable,{onReactionPressed:this.props.onReactionUpdated},this.props.usersByReactionType,this.reactionButtonStrings(),this.props.localizationAPI,this.props.preventReacting,this.props.userReactionSummary),onEditRootPost:this.props.onEditRootPost,allowRootEditButton:this.props.allowRootEditButton};return s.createElement(It,Object(o.__assign)({},n))}},t.prototype.injectHideCommentHeaderCallback=function(e){if(e){var t=e.constructor===Array?e[0]:e;return s.cloneElement(t,{onHideCardHeader:this.hideCardHeader})}},t.prototype.renderPosts=function(){var e=s.Children.toArray(this.props.children),t=e.length,n=this.props.displayMode===T.a.Resolved,r=t>2||n&&t>1,o=this.props.componentTreeId.renderContextType,i=this.injectHideCommentHeaderCallback(t?e[0]:void 0),a=t>1?e[t-1]:void 0,l=[];if(this.props.children&&r)for(var c=1;c<t-1;++c){var p=this.props.children[c];l.push(p)}var u=this.props.cardCollapsedState===C.a.Collapsed,d=u&&r,f=u&&n;return s.createElement("div",{id:ee.P({id:this.props.id,renderContextType:o}),onClick:d?this.expandButtonClickHandler:void 0,className:this.styles.renderableItemList,role:"group","aria-expanded":r?!u:void 0,onKeyDown:d?this.expandButtonKeyDownHandler:void 0,onScroll:this.renderableItemListScrollHandler},i,this.renderExpandButton({onPress:this.expandButtonHandler}),d?void 0:l,f?void 0:a,o===S.a.DiscreteIsolated?s.createElement("div",{className:this.styles.spacingAfterLastPost}):void 0)},t.prototype.clearDraft=function(){this.textEditorRef&&this.textEditorRef.clear()},t.prototype.replyBoxKeyDownHandler=function(e){var t=this.props.componentTreeId.renderContextType;if(Object(_.f)(e.key)===_.b.Enter||e.which===_.c.Space)this.props.displayMode!==T.a.Normal&&this.props.displayMode!==T.a.ReplySessionRequestPending||this.props.onEditorPress(this),e.target===this.replyBoxRef&&e.preventDefault(),e.stopPropagation();else if(!d.U()&&Object(_.f)(e.key)===_.b.Tab){var n=this.isActiveReply();if(this.isActiveDraft()||n){var r=document.getElementById(ee.T({id:this.props.id,renderContextType:t})),o=n?document.getElementById(ee.R({id:this.props.id,renderContextType:t})):document.getElementById(ee.t({id:this.props.id,renderContextType:t})),i=document.getElementById(ee.V({id:this.props.id,renderContextType:t}));e.shiftKey||!e.shiftKey&&this.shouldDisableSendButton()?o&&o.focus():i?i.focus():r&&r.focus(),e.preventDefault(),e.stopPropagation()}}},t.prototype.sendCommentButtonKeyDownHandler=function(e){Object(_.f)(e.key)===_.b.Enter&&this.onPost(L.a.CommitButton)},t.prototype.cancelReplyButtonKeyDownHandler=function(e){Object(_.f)(e.key)===_.b.Enter&&this.cancelReplyThenFocus(),d.U()||Object(_.f)(e.key)!==_.b.Tab||e.shiftKey||this.textEditorRef&&(this.textEditorRef.focus(),e.preventDefault(),e.stopPropagation())},t.prototype.sendReplyButtonClickHandler=function(e){this.onPost(L.a.CommitButton),null==e||e.stopPropagation()},t.prototype.cancelReplyButtonClickHandler=function(e){this.cancelReplyThenFocus(),null==e||e.stopPropagation()},t.prototype.cancelReplyThenFocus=function(){this.onCancel();var e=document.getElementById(ee.i({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},!1));e&&e.focus()},t.prototype.onEditorCommitRequested=function(){this.onPost(L.a.KeyboardShortcut)},t.prototype.onEditorEscapeRequested=function(){d.U()&&this.focus()},t.prototype.editorBlurHandler=function(){this.props.onEditorBlur(this)},t.prototype.editorComponentRef=function(e){this.textEditorRef=e},t.prototype.renderCommentEditor=function(e){var t=Z.h(this.props.localizationAPI,this.props.supportsAtMentions,this.isActiveDraft(),this.props.cardRelativeDraftingState),n=this.props.componentTreeId.renderContextType,r=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({id:ee.f({id:this.props.id,renderContextType:n}),isDraftEmpty:void 0,isTabbable:this.props.isTabbable,accessibilityLabel:t,accessibilityDescribedBy:ee.S({id:this.props.id,renderContextType:n})},this.getCommentEditorCallbackProps()),{displayMode:H.Disabled,useReplyBoxStyling:!0,isHeightBounded:!!this.getMaxHeight(),placeholder:t,scrollingContainerId:this.props.scrollingContainerId,supportsAtMentions:this.props.supportsAtMentions,localizationAPI:this.props.localizationAPI}),this.props.mentionEditorProps),{onMount:this.onEditorMount,onSaveDraftToSession:this.onSaveDraftToSession,focusManagerKeyDownHandler:this.props.commentEditorAdditionalKeyDownHandler,commentId:this.props.id}),i=this.props.smartReplies?{pickerTitle:this.props.localizationAPI.getString(203),smartReplies:this.props.smartReplies}:void 0;return e||(r=Object(o.__assign)(Object(o.__assign)({},r),{displayMode:H.Editing,onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.onEditorEscapeRequested,savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,richTextCapabilities:this.props.richTextCapabilities,smartReplyProps:i})),s.createElement(Hr,Object(o.__assign)({},r))},t.prototype.hideCardHeader=function(e){this.setState({headerHidden:e})},t.prototype.renderCommitRegion=function(){var e=this.props.componentTreeId.renderContextType,t=this.getMemoizedCommitButtons(this.props.displayMode,this.props.id,e,this.shouldDisableSendButton(),this.props.isTabbable,this.props.taskTopperProps,this.props.selectedTaskAssignee,this.props.localizationAPI);if(t.length)return s.createElement(Kt,{taskAssigner:this.getTaskAssignerProps(),buttons:t,tooltipDirection:I.a.bottomCenter})},t.prototype.renderReplyBox=function(){if(!this.props.isReadOnly){var e=this.props.componentTreeId.renderContextType,t=this.isActiveDraft(),n=this.isActiveReply(),r=this.props.displayMode===T.a.ReplyPostCommitPending||this.props.displayMode===T.a.CardPostCommitPending,o=n||t||r,i=!n&&!t&&!r,a=!n&&!t,l=d.n();return s.createElement("div",{className:this.styles.replyBoxContainer,style:{position:"relative"}},s.createElement("div",{id:ee.h({id:this.props.id,renderContextType:e}),ref:this.setReplyBoxRef,role:i?"button":void 0,"aria-label":i?Z.h(this.props.localizationAPI,this.props.supportsAtMentions,t,this.props.cardRelativeDraftingState):void 0,className:!d.U()&&this.props.restrictActionControls_deprecated?this.styles.replyBoxRestrictFocus_deprecated:this.styles.replyBoxDefault,onClick:this.onEditorClick,onKeyDown:this.replyBoxKeyDownHandler,tabIndex:i?this.props.displayMode===T.a.ReplyPostCommitPending?-1:this.getInnerElementsTabIndex():void 0},this.renderCommentEditor(a),s.createElement("div",{className:this.styles.cardOverlay,style:this.props.displayMode===T.a.ReplyPostCommitPending?{display:"inline"}:{display:"none"}})),l?this.renderDraftBoxMessage(!r&&!this.props.isDraftEmpty&&(n||t)):void 0,o?this.renderCommitRegion():void 0,s.createElement("div",{id:ee.S({id:this.props.id,renderContextType:e}),style:{display:"none"}},this.props.localizationAPI.getString(55)))}},t.prototype.renderAtMentionHintMessage=function(){var e=this.isActiveDraft(),t=this.isActiveReply(),n=d.j()?Rt(this.props.currentMentionees):[],r=function(e,t){if(0===t.length)return"";var n="";if(1===t.length)n=t[0];else if(2===t.length)n=e.formatString(242,t[0],t[1]);else if(3===t.length)n=e.formatString(243,t[0],t[1],t[2]);else{var r=t.length-1;n=e.formatString(244,t[0],r.toString())}return e.formatString(241,n)}(this.props.localizationAPI,n),o=this.props.displayMode===T.a.ReplyPostCommitPending||this.props.displayMode===T.a.CardPostCommitPending;if(d.j()&&this.state.isAtMentionHintMessageAllowed&&!o&&!1===this.props.isDraftEmpty&&(t||e)&&void 0!==this.props.currentMentionees&&Object.keys(this.props.currentMentionees).length>0&&r.length>0&&!this.props.isReadOnly){var i=At();return s.createElement("span",{className:i.atMentionAriaContainer,"aria-live":"polite","aria-atomic":"true","aria-relevant":"additions"},this.renderAtMentionInfoBar(r,n))}},t.prototype.renderAtMentionInfoBar=function(e,t){return s.createElement(Dt,{commentId:this.props.id,localizationAPI:this.props.localizationAPI,mentionedNotificationUberString:e,mentionedNames:t})},t.prototype.renderResolvedOrTaskTopper=function(){var e=this,t=Object(E.c)((function(t,n){return{cardTopperContainerProps:{},resolvedButtonsProps:t===T.a.Resolved?e.generateCardActionItems(n):void 0,taskTopperCheckboxRef:e.setTaskTopperCheckboxRef}}));return this.renderResolvedOrTaskTopperHelper(t(this.props.displayMode,this.props.menuItems))},t.prototype.shouldDisableFocusTrapZone=function(){var e;if(null===(e=this.props)||void 0===e?void 0:e.tabFocusTrapBehavior)switch(this.props.tabFocusTrapBehavior){case D.b.Trap:return!1;case D.b.DoNotTrap:return!0;default:Object(i.m)(this.props.tabFocusTrapBehavior)}return!Object(zr.a)(this.props.componentTreeId.renderContextType)&&(d.U()||!this.isActiveReply()&&!this.isActiveDraft())},t.prototype.renderCard=function(e){var t=this.props.componentTreeId.renderContextType,n=this.styles.cardInnerContainer,r=this.props.isReadOnly?this.styles.cardBodyReadOnly:this.styles.cardBody,i=Object(pe.d)({id:this.props.id,renderContextType:t},this.props.highlightCard,this.isSelectionWithinCard(),this.props.displayMode===T.a.Resolved&&this.props.cardCollapsedState===C.a.Collapsed,null==e?void 0:e.colors,null==e?void 0:e.styles),a={id:this.props.id,renderContextType:t},l={id:ee.i(a,this.props.isNewThread),role:"treeitem",className:i,tabIndex:this.getRootTabIndex(),onContextMenu:Ur.a,onKeyDown:this.cardKeyDownHandler,ref:this.setCardRef,onFocus:this.onCardFocus},c={"aria-label":this.props.accessibilityLabel,"aria-expanded":this.props.cardCollapsedState===C.a.Expanded,"aria-selected":this.isSelectionWithinCard(),"aria-level":1,"aria-describedby":ee.H({id:this.props.id,renderContextType:t}),"aria-setsize":this.props.accessibilitySetSize,"aria-posinset":this.props.accessibilityPositionInSet};return this.props.displayMode===T.a.Loading?s.createElement("div",Object(o.__assign)({"aria-label":this.props.accessibilityLabel},l),s.createElement("div",{className:this.styles.cardPlaceholder},s.createElement("div",{id:ee.g(a),className:this.styles.cardOverlay},s.createElement(w.a,{delay:ge.f},s.createElement(A.a,{className:this.styles.cardSpinner,size:R.a.large}))))):!d.U()&&this.isActiveDraft()?s.createElement("div",Object(o.__assign)({onClick:this.cardClickHandler},l,c),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),s.createElement("div",{className:n},s.createElement("div",{className:r},this.renderPosts(),this.renderReplyBox(),d.n()?void 0:this.renderDraftBoxMessage(!1))),this.renderAtMentionHintMessage()):this.props.displayMode===T.a.Resolved?s.createElement("div",Object(o.__assign)({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},l,c),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),s.createElement("div",{className:n},s.createElement("div",{className:r},this.renderPosts(),this.renderCardFooter()))):this.props.displayMode===T.a.CardPostCommitPending?s.createElement("div",Object(o.__assign)({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},l,c),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),s.createElement("div",{className:n},s.createElement("div",{className:this.styles.cardBody},this.renderPosts(),this.renderReplyBox(),s.createElement("div",{className:this.styles.cardOverlay},s.createElement(w.a,{delay:ge.f},s.createElement(A.a,{className:this.styles.cardSpinner,size:R.a.large}))))),this.renderAtMentionHintMessage()):s.createElement("div",Object(o.__assign)({onMouseEnter:this.onCardMouseEnter,onMouseLeave:this.onCardMouseLeave,onClick:this.cardClickHandler},l,c),this.renderResolvedOrTaskTopper(),this.renderCardHeader(),s.createElement("div",{className:n},s.createElement("div",{className:r},this.renderPosts(),this.renderReplyBox(),d.n()?void 0:this.renderDraftBoxMessage(!1))),this.renderAtMentionHintMessage())},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(Ve),{componentTreeId:ne.a},Ve.DisplayName),Vr=n(166),Wr=s.memo((function(e){var t,n=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,r=function(e){switch(e){case 13:case 14:return"TaskAssign";case 15:return"TaskComplete";case 21:return"TaskReopen";case 17:return"TaskEdit";case 18:return"TaskDelete";default:return}}(e.icon),o=ve(n),i=s.createElement("div",null,s.createElement("div",{className:o.container},r&&s.createElement(Be.a,{iconName:r,className:o.icon}),s.createElement("div",{className:o.body},e.description)));return s.createElement(J.a,{content:e.description,directionalHint:I.a.bottomCenter,tooltipProps:ie.a,id:X.b},i)})),qr=Object(E.c)((function(e){var t;return{body:Object(W.eb)({fontFamily:"inherit",color:null!==(t=null==e?void 0:e.SubText)&&void 0!==t?t:q.a.GRAY_E,fontWeight:"normal",fontSize:"11px",lineHeight:18,marginLeft:"3px",userSelect:"text"})}})),Qr=s.memo((function(e){var t,n=null===(t=Object(M.b)())||void 0===t?void 0:t.colors,r=qr(n);return s.createElement("div",{className:r.body,id:e.id},e.timestamp)})),Gr=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t.onFocusParent=function(){return t.props.onFocusParent(t)},t.saveDraftIfEditing=function(e){t.isEditingOrPending(t.props.postDisplayMode)&&t.props.onSaveDraft(t.getId(),e)},t}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"textEditorRef",{get:function(){return this._textEditorRef},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.props.onPostMounted(this.props.id)},t.prototype.componentWillUnmount=function(){this.textEditorRef&&this.saveDraftIfEditing(this.textEditorRef)},t.prototype.setContents=function(e){this.textEditorRef&&this.textEditorRef.setContents(e)},t.prototype.getContentsAsync=function(){return this.textEditorRef?this.textEditorRef.getContentsAsync():Promise.resolve("")},t.prototype.getCursorPositionAsync=function(){return this.textEditorRef?this.textEditorRef.getCursorPositionAsync():Promise.resolve(void 0)},t.prototype.getId=function(){return this.props.id},t.prototype.isEditingOrPending=function(e){return e===x.a.Editing||e===x.a.EditPreCommitPending},t.prototype.renderTimestamp=function(){if(!this.props.collapsed&&this.props.postDisplayMode!==x.a.New_nonFluent&&!this.isEditingOrPending(this.props.postDisplayMode)){var e=this.props.componentTreeId.renderContextType;return s.createElement(Qr,{timestamp:this.props.timestamp,id:Object(ee.K)({id:this.props.id,renderContextType:e}),renderContextType:e,resolved:this.props.postDisplayMode===x.a.Resolved})}},t.prototype.getActionBarItemsAsButtonProps=function(e){var t=this;return e.actionBarItems.map((function(n,r){n.id,n.onClick;var i=Object(o.__rest)(n,["id","onClick"]);return Object(o.__assign)(Object(o.__assign)({},i),{id:Object(ee.a)({id:e.id,renderContextType:t.props.componentTreeId.renderContextType},r),onClick:function(){return n.onClick(t)},onKeyDown:function(e){var r;return null===(r=n.onKeyDown)||void 0===r?void 0:r.call(n,e,t)},isTabbable:e.isTabbable})}))},t.prototype.getNumberOfHistoryItemsToRender=function(){return!d.b()||this.props.collapsed?0:this.props.taskHistoryProps.length},t.prototype.renderHistoryItemContent=function(){if(0!==this.props.taskHistoryProps.length&&0!==this.getNumberOfHistoryItemsToRender())return this.props.taskHistoryProps.map((function(e,t){return s.createElement(Wr,Object(o.__assign)({},e,{key:e.description}))}))},t.prototype.renderDraftBoxMessage=function(e){if(!d.B())return null;var t=this.props.draftWarningState;return t||e?s.createElement(fe,{key:"draftBoxMessage",draftWarningState:t,localizationAPI:this.props.localizationAPI,target:U.Post,id:t?Object(ee.u)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}):Object(ee.M)({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),defaultToPostingTip:e}):null},t.DisplayName="CommentPost",t}(s.PureComponent),Yr=Object(E.c)((function(e,t,n,r){var o,i,a,s;return{actionbarEdit:Object(W.eb)({maxHeight:"30px",marginTop:"5px",display:"flex",flexDirection:"row",flexWrap:"nowrap",overflow:"hidden",alignSelf:"flex-end"}),body:Object(W.eb)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,marginTop:"6px",marginBottom:"2px",marginRight:6,position:"relative",overflow:"hidden"},e?{marginLeft:"12px",marginRight:"14px",marginTop:"0px"}:{paddingLeft:"3px"}),container:Object(W.eb)({display:"flex",direction:"inherit",overflow:"hidden",flexGrow:1,flexDirection:"row",flexWrap:"nowrap",flexShrink:0,margin:0,marginLeft:"2px",marginRight:"2px",border:0,position:"relative",selectors:{":focus":t?{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(q.a.FOCUS_BOX),selectors:(o={},o[W.m]={boxShadow:"none",outline:"1px solid ".concat(q.a.FOCUS_BOX)},o)}:{outline:"none"}}},e?{overflow:"visible",backgroundColor:"transparent"}:{}),postOverlay:Object(W.eb)({position:"absolute",zIndex:10,left:0,top:0,right:0,bottom:0,backgroundColor:null!==(i=null==r?void 0:r.PostOverlay)&&void 0!==i?i:"rgba(255,255,255,0.5)"}),postSpinner:Object(W.eb)({position:"absolute",zIndex:20,left:"50%",top:"50%",marginLeft:"-20px",marginTop:"-20px",selectors:{"& .ms-Spinner-circle":{borderColor:Ft.a,borderTopColor:Ft.b}}}),editorEditingContainer:Object(W.eb)({display:"flex",margin:"0px",marginBottom:"4px",backgroundColor:null!==(a=null==n?void 0:n.CardBackground)&&void 0!==a?a:"#FFFFFF",border:"1px solid",borderColor:null!==(s=null==n?void 0:n.CommonControlBorder)&&void 0!==s?s:ce.b.gray110,borderRadius:ge.c,userSelect:"text",padding:0}),editorRestContainer:Object(W.eb)({display:"flex",marginRight:"2px",backgroundColor:"transparent",userSelect:"text",padding:"1px",border:0}),lowFidelityWarning:Object(W.eb)({display:"flex",marginLeft:"4px",fontFamily:"inherit",fontSize:"12px",fontWeight:"normal",fontStyle:"italic",borderStyle:"dotted",borderColor:"red",borderWidth:"2px",whiteSpace:"normal"})}})),Jr=n(2656),$r=Object(E.c)((function(e){var t,n,r,o;return{root:{maxHeight:"12px",marginRight:"6px",padding:0,color:null!==(n=null==e?void 0:e.PrimaryButton)&&void 0!==n?n:"#2B5C9C",fontSize:"11px",fontWeight:"600",fontFamily:"inherit",lineHeight:1.4,overflow:"visible",border:"1px solid transparent",selectors:(t={".ms-Fabric--isFocusVisible &:focus::after":ge.m},t[W.m]={outline:"auto"},t)},rootHovered:Object(W.eb)({color:null!==(r=null==e?void 0:e.PrimaryButtonHovered)&&void 0!==r?r:"#333333"},ge.l),rootPressed:Object(W.eb)({color:null==e?void 0:e.PrimaryButtonPressed}),rootFocused:Object(W.eb)({color:null!==(o=null==e?void 0:e.PrimaryButton)&&void 0!==o?o:"#333333",outline:"none",border:"1px dotted"},ge.k),label:{margin:0}}})),Xr=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t.renderWithContexts=function(e){var n=$r(null==e?void 0:e.colors),r={id:t.props.id,disabled:t.props.disabled,onClick:function(e){e.stopPropagation(),t.props.onClick&&t.props.onClick(e)},ariaLabel:t.props.accessibilityLabel,tabIndex:t.props.isTabbable?void 0:-1};return s.createElement(Ge.a,Object(o.__assign)({},r,{styles:n}),t.props.text)},t}return Object(o.__extends)(t,e),t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(s.PureComponent),Zr=function(e){function t(t){var n=e.call(this,t)||this;return n.state={content:[]},n}return Object(o.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){this.setState({content:this.generateRenderedContent(this.props.actions)})},t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.actions!==this.props.actions&&this.setState({content:this.generateRenderedContent(e.actions)})},t.prototype.generateRenderedContent=function(e){return e.map((function(e,t){return s.createElement(Xr,Object(o.__assign)({key:t},e))}))},t.prototype.render=function(){return this.props.isVisible?s.createElement("div",null,this.state.content):s.createElement("div",null)},t}(s.PureComponent),eo=Object(E.c)((function(e){var t;return{errorWrapper:Object(W.eb)({display:"flex",direction:"inherit",flexDirection:"row",marginTop:"6px",marginRight:"8px",position:"relative",width:"100%"}),errorMessageContainer:Object(W.eb)({display:"flex",direction:"inherit",flexDirection:"column",marginLeft:"10px",marginRight:"8px",width:"100%"}),errorMessage:Object(W.eb)({fontSize:"12px",paddingLeft:"1px",color:null!==(t=null==e?void 0:e.Text)&&void 0!==t?t:q.a.ACTIVE_COMMENT_TEXT,textAlign:"left",fontFamily:"inherit",marginRight:"8px",marginBottom:"3px",display:"flex",fontWeight:"normal",whiteSpace:"normal"}),errorIconStyles:{root:{width:"16px",fontSize:"16px",marginTop:"4px",marginLeft:"11px"}}}})),to=function(e){function t(){var t=e.apply(this,Object(o.__spreadArray)([],Object(o.__read)(arguments),!1))||this;return t.getIconProps=Object(z.a)((function(e){return{iconName:Object(Ee.b)(19),styles:e.errorIconStyles}})),t.renderWithContexts=function(e){return t.styles=eo(null==e?void 0:e.colors),s.createElement("div",{className:t.styles.errorWrapper},s.createElement(Be.a,Object(o.__assign)({},t.getIconProps(t.styles),{tabIndex:-1})),s.createElement("div",{className:t.styles.errorMessageContainer},s.createElement("div",{id:t.props.id,className:t.styles.errorMessage},t.props.warningMessage),s.createElement(Zr,{isVisible:!0,actions:t.props.buttons})))},t}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.hideCardHeader&&this.props.hideCardHeader(!0)},t.prototype.componentWillUnmount=function(){this.props.hideCardHeader&&this.props.hideCardHeader(!1)},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(s.PureComponent),no=er(function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.postRootKeyDownHandler=function(e){switch(Object(_.f)(e.key)){case _.b.Enter:case _.b.Space:e.currentTarget===e.target&&r.props.parent&&(r.props.onCollapseParent(r),e.stopPropagation(),e.preventDefault())}},r.onDraftEmptinessChanged=function(e){r.props.onDraftEmptinessChanged(r,e)},r.onEditorMount=function(){r.props.onPostEditorMounted(r.props.id)},r.reactionButtonProps=Object(E.c)((function(e,t,n,r,o,i,a,s,l){return{commentId:e,isTabbable:n,onReactionPressed:r.onReactionPressed,renderContextType:t,usersByReactionType:o,buttonStrings:i,localizationAPI:a,reactionType:N.a.Like,userReactionSummary:null!=l?l:{Like:{count:0,currentUserReacted:!1}},preventDefaultKeyDownBehavior:void 0,preventReacting:s}})),r.reactionButtonStrings=Object(E.c)((function(){return{buttonLabel:r.props.localizationAPI.getString(231),buttonLabelPlural:r.props.localizationAPI.getString(239),buttonA11yDropdownText:r.props.localizationAPI.getString(240)}})),r.getDisplayErrorProps=Object(E.c)((function(e,t,n){var o=r.props.localizationAPI.getString(183),i=ee.L({id:t,renderContextType:n});return r.getPostWarningProps(e,o,i)})),r.getLowFidelityWarningProps=Object(E.c)((function(e,t,n,o){var i=ee.D({id:n,renderContextType:o});return r.getPostWarningProps(e,t,i)})),r.onSaveDraftToSession=function(){r.textEditorRef&&r.props.onSaveDraft(r.getId(),r.textEditorRef)},r.renderWithContexts=function(e){switch(r.styles=Yr(!!r.props.parent,r.shouldUseFocusStyle(),null==e?void 0:e.colors,null==e?void 0:e.styles),r.defaultEditorProps=r.getDefaultEditorProps(null==e?void 0:e.colors),r.props.postDisplayMode){case x.a.LowFidelityWarningDelete:case x.a.LowFidelityWarningEdit:return r.renderLowFidelityWarningState();case x.a.Editing:case x.a.EditPreCommitPending:return r.renderEditState();case x.a.Resolved:return r.renderResolvedState();case x.a.Normal:case x.a.PendingDraft:return r.renderNormalState();case x.a.PendingEdit:return r.renderPendingEditState();case x.a.Error:return r.renderPostErrorState();case x.a.New_nonFluent:throw new u.a(B.m,i.d.reserveTag(589103702),-2130957558);default:return Object(i.m)(r.props.postDisplayMode),null}},r.state={hover:!1,actionBarItems:[]},r.postFocusHandler=r.postFocusHandler.bind(r),r.postClickHandler=r.postClickHandler.bind(r),r.renderCommentEditor=r.renderCommentEditor.bind(r),r.commitHandler=r.commitHandler.bind(r),r.commentEditorKeyDownHandler_deprecated=r.commentEditorKeyDownHandler_deprecated.bind(r),r.editorComponentRef=r.editorComponentRef.bind(r),r.postEditingKeyDownHandler_deprecated=r.postEditingKeyDownHandler_deprecated.bind(r),r.onMouseLeavePost=r.onMouseLeavePost.bind(r),r.onMouseOverPost=r.onMouseOverPost.bind(r),r.onEditorCommitRequested=r.onEditorCommitRequested.bind(r),r.onContextMenuInteractionHandler=r.onContextMenuInteractionHandler.bind(r),r.trySelectPost=r.trySelectPost.bind(r),r.getDisplayErrorProps=r.getDisplayErrorProps.bind(r),r.onRetry=r.onRetry.bind(r),r.defaultEditorProps=r.getDefaultEditorProps(),r}return Object(o.__extends)(t,e),t.prototype.getDefaultEditorProps=function(e){var t=this.props.componentTreeId.renderContextType,n=Object(ge.n)(this.props.postDisplayMode===x.a.Resolved,!!this.props.cardSelected,e);return Object(o.__assign)(Object(o.__assign)({id:ee.H({id:this.props.id,renderContextType:t}),isDraftEmpty:void 0,componentRef:this.editorComponentRef},this.props.mentionableEditorProps),{accessibilityLabel:Z.n(this.props.localizationAPI),accessibilityDescribedBy:ee.v({id:this.props.id,renderContextType:t}),displayMode:H.ReadOnly,defaultValue:this.props.commentBody,scrollingContainerId:this.props.scrollingContainerId,supportsAtMentions:this.props.supportsAtMentions,richTextCapabilities:this.props.richTextCapabilities,truncationOverlayColor:n,dulledAtMentions:this.props.dulledAtMentions,localizationAPI:this.props.localizationAPI,commentId:this.props.id,commentTabbable:this.props.isTabbable,onClickableTextClicked:this.props.onClickableTextClicked})},t.prototype.editorComponentRef=function(e){this._textEditorRef=e},t.prototype.onMouseOverPost=function(){this.props.collapsed||this.setState({hover:!0})},t.prototype.onMouseLeavePost=function(){this.props.collapsed||this.setState({hover:!1})},t.prototype.UNSAFE_componentWillMount=function(){this.setState({actionBarItems:this.getActionBarItemsAsButtonProps(this.props)})},t.prototype.onContextMenuInteractionHandler=function(e){this.trySelectPost(),e&&Object(_.f)(e.key)===_.b.ArrowDown&&e.preventDefault()},t.prototype.componentDidCatch=function(e){this.onError(e)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.props.actionBarItems===e.actionBarItems&&this.props.isTabbable===e.isTabbable||this.setState({actionBarItems:this.getActionBarItemsAsButtonProps(e)})},t.prototype.componentDidUpdate=function(e,t){var n=this.isEditingOrPending(this.props.postDisplayMode);if(this.props.draftId&&!n&&Object(a.k)().assertConditionTag(!1,"PostDisplayMode inconsistent with draft warning state",593802317),this.textEditorRef&&this.isEditingOrPending(e.postDisplayMode)&&this.props.hasDraftInOtherRenderContext&&this.props.onSaveDraft(this.getId(),this.textEditorRef),this.textEditorRef&&!n&&(e.commentBody!==this.props.commentBody||!this.props.collapsed&&e.collapsed))try{this.textEditorRef.setContents(this.props.commentBody)}catch(e){this.onError(e instanceof Error?e:new Error(Object(i.l)(e)))}Object(a.k)().assertConditionTag(void 0===this.props.draftId||this.isEditingOrPending(this.props.postDisplayMode),"post has draft state and is not in editing mode",593802318)},t.prototype.onRetry=function(){this.props.onClearError(this)},t.prototype.onError=function(e){Object(Bt.a)(i.d.reserveTag(594351964))(e),this.props.onError(this)},t.prototype.postFocusHandler=function(e){var t=document.getElementById(ee.J({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}));t&&e.target===t&&(Object(Jr.a)(this.props.postDisplayMode)||this.props.selected||this.props.collapsed||this.props.onSelect(this,!1))},t.prototype.trySelectPost=function(){Object(Jr.a)(this.props.postDisplayMode)||this.props.selected||this.props.onSelect(this,!1)},t.prototype.postClickHandler=function(e){this.trySelectPost(),e.stopPropagation()},t.prototype.commitHandler=function(e){this.props.onCommit(this,e)},t.prototype.getBodyStyle=function(){return this.styles.body},t.prototype.renderCommitBar=function(){return s.createElement(Kt,{buttons:this.state.actionBarItems,tooltipDirection:I.a.bottomCenter})},t.prototype.postEditingKeyDownHandler_deprecated=function(e){if(Object(_.f)(e.key)===_.b.Tab){var t=document.getElementById(ee.a({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},this.props.actionBarItems.length-1));e.target!==t||e.shiftKey||(this.textEditorRef&&this.textEditorRef.focus(),e.stopPropagation(),e.preventDefault())}},t.prototype.commentEditorKeyDownHandler_deprecated=function(e){if(Object(_.f)(e.key)===_.b.Tab){var t=e.shiftKey?this.props.actionBarItems.length-1:0,n=document.getElementById(ee.a({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType},t));n&&n.focus(),e.stopPropagation()}},t.prototype.onEditorCommitRequested=function(){this.commitHandler(L.a.KeyboardShortcut)},t.prototype.renderBlueDot=function(){return He(this.props)?s.createElement(Oe,{dotType:this.props.parent?be.RootPost:be.ReplyPost,historyItemCount:this.getNumberOfHistoryItemsToRender(),renderContextType:this.props.componentTreeId.renderContextType}):null},t.prototype.renderCommentEditor=function(e){var t=this.styles.editorRestContainer,n=void 0;return e.displayMode===H.Editing&&(t=this.styles.editorEditingContainer,n=s.createElement("div",{id:ee.v({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),style:{display:"none"}},this.props.localizationAPI.getString(56))),s.createElement("div",{className:t},s.createElement(Hr,Object(o.__assign)({onKeyDown:d.U()?void 0:this.commentEditorKeyDownHandler_deprecated},e,this.props.mentionableEditorProps)),n)},t.prototype.renderHeader=function(){return this.props.parent?null:s.createElement(Ot,Object(o.__assign)({},this.getRenderableItemHeaderProps()))},t.prototype.renderPersona=function(){return this.props.parent?null:s.createElement(jt,Object(o.__assign)({},this.getRenderableItemPersonaProps()))},t.prototype.getRootDivProps=function(){return{className:Object(Vr.a)(this.styles.container),tabIndex:this.props.isTabbable?0:-1,onFocus:this.postFocusHandler,onClick:this.postClickHandler,id:ee.J({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),onKeyDown:this.postRootKeyDownHandler}},t.prototype.getRenderableItemPersonaProps=function(){return{authorName:Object(p.k)(this.props.author),resolved:this.props.postDisplayMode===x.a.Resolved,isParent:!!this.props.parent,authorColor:this.props.authorColor,authorImageURL:this.props.authorImageURL,authorEmail:this.props.author.Email,isTabbable:this.props.isTabbable}},t.prototype.getRenderableItemHeaderProps=function(){var e=this.props.parent||this.props.collapsed||this.props.postDisplayMode!==x.a.Normal&&this.props.postDisplayMode!==x.a.Resolved||!(this.state.hover||this.props.selected),t=this.props.usersByReactionType&&this.props.usersByReactionType[N.a.Like]?this.props.usersByReactionType[N.a.Like]:[],n=this.props.componentTreeId.renderContextType;return{authorLine:Object(p.k)(this.props.author),renderContextType:n,contextMenuProps:e||0===this.props.actionBarItems.length?void 0:{menuItems:[],actionBarItems:this.props.actionBarItems,isTabbable:this.props.isTabbable,parentId:this.props.id,trySelectPost:this.trySelectPost,localizationAPI:this.props.localizationAPI},reactionButtonProps:(e||this.props.preventReacting)&&0===t.length?void 0:this.reactionButtonProps(this.props.id,n,this.props.isTabbable,{onReactionPressed:this.props.onReactionUpdated},this.props.usersByReactionType,this.reactionButtonStrings(),this.props.localizationAPI,this.props.preventReacting,this.props.userReactionSummary)}},t.prototype.shouldUseFocusStyle=function(){return(d.U()||!this.isEditingOrPending(this.props.postDisplayMode)&&!this.props.restrictActionControls_deprecated)&&this.props.selected},t.prototype.getPostWarningProps=function(e,t,n){return{buttons:e,warningMessage:t,id:n,hideCardHeader:this.props.onHideCardHeader}},t.prototype.renderEditState=function(){var e=Z.n(this.props.localizationAPI),t=Object(o.__assign)(Object(o.__assign)({},this.defaultEditorProps),{defaultValue:this.props.commentBody,displayMode:H.Editing,savedDraftContent:this.props.savedDraftContent,isDraftEmpty:this.props.isDraftEmpty,isTabbable:this.props.isTabbable,onCommitRequested:this.onEditorCommitRequested,onEscapeRequested:this.onFocusParent,onDraftEmptinessChanged:this.onDraftEmptinessChanged,onSaveDraftToSession:this.onSaveDraftToSession,accessibilityLabel:e,onMount:this.onEditorMount});return s.createElement("div",Object(o.__assign)({role:"comment","aria-label":this.props.accessibilityLabel,"aria-describedby":t.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),this.renderPersona(),this.renderBlueDot(),s.createElement("div",{className:this.getBodyStyle(),onKeyDown:d.U()?void 0:this.postEditingKeyDownHandler_deprecated},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(t),s.createElement("div",{className:this.styles.actionbarEdit},this.renderCommitBar()),this.renderDraftBoxMessage(!1)))},t.prototype.renderLowFidelityWarningState=function(){var e=this.getLowFidelityWarningProps(this.state.actionBarItems,this.props.lowFidelityWarningString,this.props.id,this.props.componentTreeId.renderContextType);return this.renderPostWarning(e,this.props.accessibilityLabel)},t.prototype.renderPostErrorState=function(){var e=this.getDisplayErrorProps(this.state.actionBarItems,this.props.id,this.props.componentTreeId.renderContextType);return this.renderPostWarning(e,this.props.localizationAPI.getString(183))},t.prototype.renderPostWarning=function(e,t){return s.createElement("div",Object(o.__assign)({role:"treeitem","aria-describedby":e.id,"aria-label":t,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps()),s.createElement(to,Object(o.__assign)({},e)))},t.prototype.renderResolvedState=function(){var e=Object(o.__assign)(Object(o.__assign)({},this.defaultEditorProps),{displayMode:H.Disabled,showFullComment:!this.props.collapsed,defaultValue:this.props.commentBody,dulledAtMentions:this.props.dulledAtMentions});return s.createElement("div",Object(o.__assign)({role:"comment","aria-label":this.props.accessibilityLabel,"aria-describedby":e.id,"aria-selected":this.props.selected,"aria-level":2,onMouseOver:this.onMouseOverPost,onMouseLeave:this.onMouseLeavePost},this.getRootDivProps()),this.renderPersona(),this.renderBlueDot(),s.createElement("div",{className:this.getBodyStyle()},s.createElement("div",null," ",this.renderHeader()," "),this.renderHistoryItemContent(),this.renderCommentEditor(e),this.renderTimestamp()))},t.prototype.renderNormalState=function(){var e=Object(o.__assign)(Object(o.__assign)({},this.defaultEditorProps),{displayMode:H.ReadOnly,showFullComment:!this.props.collapsed,defaultValue:this.props.commentBody});return s.createElement("div",Object(o.__assign)({role:"comment","aria-label":this.props.accessibilityLabel,"aria-describedby":e.id,"aria-selected":this.props.selected,"aria-level":2},this.getRootDivProps(),{onMouseOver:this.onMouseOverPost,onMouseLeave:this.onMouseLeavePost}),this.renderPersona(),this.renderBlueDot(),s.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(e),this.renderTimestamp()))},t.prototype.renderPendingEditState=function(){var e=this,t={id:ee.H({id:this.props.id,renderContextType:this.props.componentTreeId.renderContextType}),isDraftEmpty:void 0,componentRef:function(t){return e._textEditorRef=t},displayMode:H.ReadOnly,showFullComment:!this.props.collapsed,defaultValue:this.props.commentBody,accessibilityLabel:this.props.localizationAPI.getString(88),localizationAPI:this.props.localizationAPI};return s.createElement("div",Object(o.__assign)({style:{position:"relative"}},this.getRootDivProps()),this.renderPersona(),this.renderBlueDot(),s.createElement("div",{className:this.getBodyStyle()},this.renderHeader(),this.renderHistoryItemContent(),this.renderCommentEditor(t),this.renderTimestamp()),s.createElement("div",{className:this.styles.postOverlay},s.createElement(w.a,{delay:ge.f},s.createElement(A.a,{className:this.styles.postSpinner,size:R.a.large}))))},t.prototype.render=function(){return Object(te.a)(this.renderWithContexts,M.a)},t}(Gr),{componentTreeId:ne.a},Gr.DisplayName),ro=Object(E.c)((function(e){var t;return e?{outline:"none",borderRadius:"1px",boxShadow:"0px 0px 0px 1px ".concat(q.a.FOCUS_BOX),selectors:(t={},t[W.m]={boxShadow:"none",outline:"1px solid ".concat(q.a.FOCUS_BOX)},t)}:{outline:"none"}})),oo={display:"flex",direction:"inherit",overflow:"hidden",flexGrow:1,flexDirection:"row",flexWrap:"nowrap",flexShrink:0,marginLeft:"2px",marginRight:"2px",border:0,position:"relative"},io=Object(E.c)((function(){return{body:Object(W.eb)({display:"flex",direction:"inherit",flexDirection:"column",flexGrow:1,marginTop:"6px",marginBottom:"2px",marginRight:6,paddingLeft:"3px",position:"relative",overflow:"hidden"}),container:Object(W.eb)(oo,{selectors:{":focus":ro(!0)}}),containerNoFocus:Object(W.eb)(oo,{selectors:{":focus":ro(!1)}})}})),ao=s.memo(s.forwardRef((function(e,t){var n=e.accessibilityLabel,r=e.author,o=e.resolved,i=e.authorColor,a=e.authorImageURL,l=e.selected,c=e.onSelect,u=function(e,t){var n=e.id,r=e.timestamp,o=e.historyItemContent,i=Object(ne.b)(),a=s.useCallback((function(){return n}),[n]),l=s.useCallback((function(){return s.createElement(Qr,{timestamp:r,id:Object(ee.K)({id:n,renderContextType:i.renderContextType}),renderContextType:i.renderContextType})}),[n,r,i]),c=s.useCallback((function(){return o.map((function(e){return s.createElement(Wr,{icon:e.icon,description:e.description,key:e.description})}))}),[o]),p=s.useMemo((function(){return{getId:a}}),[a]);return Object(s.useImperativeHandle)(t,(function(){return p}),[p]),{getId:a,renderTimestamp:l,renderHistoryItemContent:c,componentTreeId:i,imperativeHandle:p}}(e,t),f=u.componentTreeId,h=u.renderHistoryItemContent,m=u.renderTimestamp,y=u.imperativeHandle,b=f.renderContextType,g=s.useRef(null),v=s.useCallback((function(){return s.createElement(jt,{authorName:Object(p.k)(r),resolved:o,isParent:!1,authorColor:i,authorImageURL:a,authorEmail:r.Email,isTabbable:l})}),[r,o,i,a,l]),C=s.useCallback((function(){return s.createElement(Ot,{authorLine:Object(p.k)(r),renderContextType:f.renderContextType,contextMenuProps:{menuItems:[],actionBarItems:[],isTabbable:!1,parentId:"",trySelectPost:function(){},localizationAPI:void 0}})}),[f,r]),T=s.useCallback((function(e){var t=g.current;t&&e.target===t&&(l||c(y,!1))}),[g,l,c,y]),O=s.useCallback((function(e){l||c(y,!1),e.stopPropagation()}),[l,c,y]),x=io(),S=function(e,t){return(d.U()||!t)&&e}(l,e.restrictActionControls_deprecated)?x.container:x.containerNoFocus;return s.createElement("div",{role:"treeitem","aria-label":n,"aria-level":2,"aria-selected":l,className:Object(Vr.a)(S),ref:g,tabIndex:l?0:-1,onFocus:T,onClick:O,id:Object(ee.J)({id:e.id,renderContextType:b})},v(),s.createElement("div",{className:x.body},C(),h(),e.collapsed?void 0:m()))}))),so=n(2620),lo=n(265),co=function(e,t,n,r,o,i,a,s,l,c,u){if(t===T.a.Draft||t===T.a.DraftPreCommitPending)return r?e.formatString(224,r):e.getString(223);if(t===T.a.Loading)return e.getString(225);var d=[],f=i?ae.c(i.completion):t===T.a.Resolved;if(i){var h=null==i?void 0:i.assignees[0];h?d.push(e.formatString(f?215:214,Object(p.k)(h))):d.push(e.getString(f?217:216)),d.push(e.formatString(u?266:212,n))}else d.push(e.formatString(f?213:u?265:211,n));return r&&d.push(e.formatString(218,r)),t!==T.a.Reply&&a!==O.a.InChildPost||d.push(e.getString(222)),1===o?d.push(e.getString(219)):o>1&&d.push(e.formatString(220,String(o))),t!==T.a.CardPostCommitPending&&t!==T.a.ReplyPostCommitPending||d.push(e.getString(221)),s&&(d.push(e.getString(237)),d.push(e.getString(238))),d.join(e.getString(226))},po=function(e,t,n,r,o){var i=void 0,a=o.author,s=o.timestamp,l=o.isUnread;switch(i=l?145:21,n&&(i=l?137:25),t){case x.a.Editing:case x.a.EditPreCommitPending:i=23;break;case x.a.Resolved:i=l?136:22;break;case x.a.LowFidelityWarningDelete:case x.a.LowFidelityWarningEdit:return r.getStringOrUndefined(26);case x.a.Normal:break;case x.a.New_nonFluent:default:return}return r.formatString(i,a,s)},uo=function(e,t,n){return t&&n?e.formatString(232,t,n):(Object(a.k)().assertConditionTag(!1,"Task History Item accessibility label not resolving properly",557056852),e.getString(119))},fo=n(130);function ho(e,t){return!!t&&t.selectedCardId===e&&!Object(g.j)(t.selectionDetails)}function mo(e,t){return!!t&&t.selectedCardId===e&&Object(g.j)(t.selectionDetails)}function yo(e,t){return!!t&&Object(g.j)(t.selectionDetails)&&t.selectionDetails.selectedPostId===e}function bo(e,t,n,r,o){switch(e){case so.a.AllCardsTabbable:return!0;case so.a.ExpandedCardOrFirstCardTabbable:if(o){var i=ho(t,o),a=mo(t,o);return i||r===C.a.Expanded&&a}return n;case so.a.ExpandedCardTabbable:return!!o&&r===C.a.Expanded;case so.a.SelectedCardTabbable:return!!o&&o.selectedCardId===t}}function go(e,t,n,r,o,i){if(r===x.a.PendingEdit||r===x.a.PendingDraft)return yo(t,i);switch(e){case so.b.AllPostsTabbable:return!0;case so.b.ExpandedCardPostsTabbable:return o===C.a.Expanded;case so.b.ExpandedCardRootPostTabbable:var a=yo(t,i),s=ho(n||t,i);return r!==x.a.New_nonFluent&&(a||s&&o===C.a.Expanded&&!n);case so.b.SelectedPostTabbable:return yo(t,i)}}function vo(e,t,n){return C.a.Collapsed===e||void 0!==n&&(n!==O.a.InChildPost||!t)}function Co(e,t,n,r,l,u,f,h,m,C,T,O,S,k,P,E,j){var I=e.localizationAPI,w=e.selectedState,A=e.isDraftThread,R=e.isCommentsContextReadOnly,D=e.draftState,_=e.cardCollapsedState,N=!1;w&&Object(g.j)(w.selectionDetails)&&(N=w.selectionDetails.selectedPostId===t.commentId);var M=function(e,t,n,r,o,s,l){if(t.pending!==b.a.None)return Object(a.k)().assertConditionTag(t.pending!==b.a.Delete,"Post with PostPendingType.Delete should not attempt to be rendered. Falling back to PendingEdit display mode.",595153811),l?x.a.PendingDraft:x.a.PendingEdit;if(s){if(l)return Object(a.k)().assertConditionTag(!d.l(),"New post should not be rendered while drafting in fluent.",574755652),x.a.New_nonFluent;if(n.postIdToDraftIdMap[e.commentId])return Object(y.i)(n)?x.a.EditPreCommitPending:x.a.Editing}if(r&&Object(g.b)(r)===e.commentId)switch(r.selectionDetails.lowFidelityWarningType){case void 0:break;case g.a.DeleteReply:return x.a.LowFidelityWarningDelete;case g.a.Edit:return x.a.LowFidelityWarningEdit;case g.a.DeleteThread:return d.l()?x.a.LowFidelityWarningDelete:x.a.Normal;default:Object(i.m)(r.selectionDetails)}return t.displayingErrorUI?x.a.Error:o?x.a.Resolved:x.a.Normal}(t,n,D,w,r,m,A),B=!!(t.commentFlags&c.a.ReadOnly||R),L=n.displayDate||"",F=D.postIdToDraftIdMap[t.commentId],H=F?D.drafts[F]:void 0,U=!!H&&H.renderContextType!==e.renderContextType,z=m&&H?Object(o.__assign)({draftId:F},Object(y.g)(H)):{};return s.createElement(no,Object(o.__assign)({},e.postCallbacks,z,{postDisplayMode:M,isReadOnly:B,id:t.commentId,author:t.author,authorColor:null==u?void 0:u.authorColor,authorImageURL:null==u?void 0:u.authorImageURL,timestamp:L,commentBody:t.commentBody,parent:""===t.parentId,lowFidelityWarningString:N?Z.l(I,w):"",selected:N,isTabbable:go(l,t.commentId,t.parentId,M,_,w),supportsAtMentions:e.isAtMentionEnabled,localizationAPI:I,actionBarItems:e.getActionBarItems(M,null==w?void 0:w.selectionDetails.lowFidelityWarningType,P,""===t.parentId,B,t.commentFlags,d.w()),accessibilityLabel:po(0===t.parentId.length,M,B,I,{author:Object(p.k)(t.author),timestamp:L,repliesCount:f,commentBody:t.commentBody,isReplyPending:h,isUnread:d.l()&&!!(t.commentFlags&c.a.IsNew),anchorHintText:t.anchorHintText}),key:t.commentId,mentionableEditorProps:e.mentionableEditorProps,taskHistoryProps:T,accessibilityPositionInSet:C.accessibilityPositionInSet,accessibilitySetSize:C.accessibilitySetSize,accessibilityLevel:C.accessibilityLevel,isNew:!!(t.commentFlags&c.a.IsNew),scrollingContainerId:O,isCardHovered:e.isCardHighlighted,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,collapsed:S,restrictActionControls_deprecated:k,preventReacting:B||P===v.a.None||!!(t.commentFlags&c.a.ReactionRestricted)||M===x.a.Resolved,richTextCapabilities:e.richTextCapabilities,usersByReactionType:d.a()?t.usersByReactionType:void 0,userReactionSummary:d.a()?t.userReactionSummary:void 0,dulledAtMentions:E,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,isEditable:!(t.commentFlags&c.a.EditRestricted||t.commentFlags&c.a.ReadOnly||M===x.a.Resolved||P!==v.a.Any),cardSelected:j,hasDraftInOtherRenderContext:U}))}function To(e,t,n,r,o,i,a,l,c,p,u){var d=fo.d(t,e),f=fo.a(t.taskId,t.records[0].recordId),h=!1;i&&Object(g.j)(i.selectionDetails)&&(h=i.selectionDetails.selectedPostId===f);var m=u.displayDate;return s.createElement(ao,{historyItemContent:d,onSelect:n.onSelect,id:f,key:f,author:t.records[0].user,timestamp:m,selected:h,authorColor:null==r?void 0:r.authorColor,authorImageURL:null==r?void 0:r.authorImageURL,resolved:o,collapsed:a,restrictActionControls_deprecated:l,accessibilitySetSize:c.accessibilitySetSize,accessibilityPositionInSet:c.accessibilityPositionInSet,accessibilityLabel:uo(e,t.records[0].user.DisplayName,m),preventDefaultKeyDownBehavior:p})}!function(e){e.None="NONE",e.SmallPhone="SMALL_PHONE",e.Phablet="PHABLET",e.LargeDisplay="LARGE_DISPLAY",e.Infinite="INFINITE"}(wr||(wr={})),wr.None;var Oo=s.memo((function(e){var t,n,r,l=e.thread,x=e.renderContextType,k=e.cardState,E=e.postOrHistoryRecordStates,j=e.postCallbacks,I=e.cardCallbacks,w=e.localizationAPI,A=e.selectedState,R=e.isolationEdit,D=e.isDraftThread,_=e.isCommentsContextReadOnly,N=e.keyboardingOptions,M=e.personaIconPropertiesMap,B=e.draftState,L=e.cardCollapsedState,F=e.cardRelativeDraftingState,H=e.maximumDimensions,U=e.preventDefaultKeyDownBehavior,z=e.restrictActionControls_deprecated,K=e.allowedDraftingSession,V=e.taskState,W=e.isCardTabbable,q=e.tabFocusTrapBehavior,Q=fo.h(l),G=Q.commentId,Y=F===O.a.InChildPost,J=!!(Q.commentFlags&c.a.Resolved),$=E[0].displayDate||"",X=[],Z=function(e,t,n,r,o,a){if(Object(h.O)(t.loadState))return T.a.Loading;switch(t.pending){case m.a.Card:case m.a.Delete:return T.a.CardPostCommitPending;case m.a.Editor:return T.a.ReplyPostCommitPending;case m.a.None:break;default:Object(i.m)(t.pending)}if(a)return Object(y.i)(n)?T.a.DraftPreCommitPending:T.a.Draft;if(r&&r.selectedCardId===e.commentId&&Object(g.d)(r)&&!d.l())return T.a.LowFidelityWarningOnDeleteThread;if(o){if(n.cardIdToDraftIdMap[e.commentId])return Object(y.i)(n)?T.a.ReplyPreCommitPending:T.a.Reply;if(n.pendingDraft&&"REPLY"===n.pendingDraft.sessionType&&n.pendingDraft.threadId===e.commentId)return T.a.ReplySessionRequestPending}return e.commentFlags&c.a.Resolved?T.a.Resolved:T.a.Normal}(Q,k,B,A,F===O.a.InCard,D),te=ho(Q.commentId,A),ne=_||!!(Q.commentFlags&c.a.ReadOnly),re=mo(Q.commentId,A),oe=(n=Z===T.a.Resolved,r=L===C.a.Collapsed,n&&(!(te||re)||r)),ie=l.length-1,se=!1,le=!Object(h.O)(k.loadState),ce=x!==S.a.HalfPane&&!d.l(),pe=!1;if(le&&(!D||ce))for(var ue=0;ue<l.length;ue++){var de=l[ue],fe=E[ue];if(Object(lo.a)(de)){de.commentModel.commentFlags&c.a.LowFidelity&&(se=!0);var he=de.commentModel.commentId,me=Object(h.J)(B)===he,ye=!!B.postIdToDraftIdMap[he];if(pe=pe||!!(de.commentModel.commentFlags&c.a.IsNew),!fe)throw new u.a("Post Or History Record state undefined for comment ".concat(he),i.d.reserveTag(589103624),-2130957493);if((!R||!Y||ye)&&Object(b.b)(fe)&&fe.pending!==b.a.Delete){var be=Object(lo.b)(de)?fo.d(de.historyItem,w):[],ge=vo(L,me,F);X.push(Co(e,de.commentModel,fe,J,N.postTabbingMode,d.C()?Object(f.d)(M,de.commentModel.author):void 0,ie,k.pending===m.a.Editor,Y||D,{accessibilitySetSize:l.length,accessibilityPositionInSet:ue+1,accessibilityLevel:(null!==(t=e.accessibilityLevel)&&void 0!==t?t:1)+1},be,H&&H.height?Object(ee.P)({id:G,renderContextType:x}):Object(zr.b)(x)?Object(ee.p)():void 0,L===C.a.Collapsed,ge,K,oe,te))}}else d.b()&&X.push(To(w,de.historyItem,j,d.C()?Object(f.d)(M,de.historyItem.records[0].user):void 0,J,A,L===C.a.Collapsed,z,{accessibilitySetSize:l.length,accessibilityPositionInSet:ue+1},U,fe))}var ve=K===v.a.None||!e.isResolveSupported;return function(e,t,n,r,i,a,l,u,f,m,b,C,x,S){var k=e.cardState,P=e.cardCallbacks,E=e.localizationAPI,j=e.selectedState,I=e.isAtMentionEnabled,w=e.isTaskCreationEnabled,A=e.draftState,R=e.cardCollapsedState,D=e.cardRelativeDraftingState,_=e.maximumDimensions,N=e.isolationEdit,M=e.richTextCapabilities,B=e.thread,L=Object(h.O)(k.loadState)?k.loadState.initialItemCount:r.length,F=A.cardIdToDraftIdMap[t.commentId],H=F?A.drafts[F]:void 0,U=D===O.a.InCard&&H?Object(o.__assign)({draftId:F},Object(y.g)(H)):{};return s.createElement(Kr,Object(o.__assign)({},P,U,{cardCollapsedState:R,selected:f,isReadOnly:C,hasSelectedChild:m,hasLowFidelityChild:b,displayMode:i,id:t.commentId,supportsAtMentions:I,isTabbable:e.isCardTabbable,localizationAPI:E,accessibilityLabel:co(E,i,Object(p.k)(t.author),t.anchorHintText,L-1,n,D,b&&"win32"===Object(Rr.a)(),u,t.commentBody,S),accessibilityDescription:"win32"===Object(Rr.a)()?Object(Xn.e)(fo.h(B).commentBody):void 0,anchorText:t.anchorHintText,author:t.author,authorColor:a?a.authorColor:"",authorImageURL:a?a.authorImageURL:"",cardRelativeDraftingState:D,supportsTaskCreation:w,taskTopperProps:n,isNewThread:e.isDraftThread,foldableLayoutState:e.foldableLayoutState,accessibilityPositionInSet:e.accessibilityPositionInSet,accessibilitySetSize:e.accessibilitySetSize,accessibilityLevel:e.accessibilityLevel,maximumDimensions:_,scrollingContainerId:l,itemCount:L,menuItems:e.getCardContextualMenuItems(t.commentFlags,e.allowedDraftingSession,e.isResolveSupported,Object(g.i)(t,j),!!e.taskState,d.w()),allowRootEditButton:!(t.commentFlags&c.a.EditRestricted||t.commentFlags&c.a.ReadOnly||Object(g.i)(t,j))&&e.allowedDraftingSession===v.a.Any,mentionEditorProps:e.mentionEditorProps,onCardLayout:e.onCardLayout,timestamp:u,restrictActionControls_deprecated:e.restrictActionControls_deprecated,preventReacting:C||e.allowedDraftingSession===v.a.None||!!(t.commentFlags&c.a.ReactionRestricted)||i===T.a.Resolved,contentBackgroundColor:e.contentBackgroundColor,maxDraftHeight:e.maxDraftHeight,availableScreenHeight:e.availableScreenHeight,extraPaddingLeft:e.extraPaddingLeft,extraPaddingRight:e.extraPaddingRight,preventDefaultKeyDownBehavior:e.preventDefaultKeyDownBehavior,highlightCard:e.isCardHighlighted,hideDraftBox:N||e.isCommentsContextReadOnly,hideHeader:N,disableScroll:N,style:e.cardStyle,richTextCapabilities:M,usersByReactionType:d.a()?t.usersByReactionType:void 0,userReactionSummary:d.a()?t.userReactionSummary:void 0,isUIAAnnotationPatternEnabled:e.isUIAAnnotationPatternEnabled,tabFocusTrapBehavior:x}),r)}(e,Q,V?function(e,t,n,r,o,i,s,l){if(d.b()){var c=t.completion;return r!==(c===ae.a)&&(Object(a.k)().assertConditionTag(!1,"Comment and task resolve state don't match",570826896),c=r?ae.a:0),{id:e,title:t.title,assignees:t.assignees,completion:c,onResolveTaskCheckboxPressed:i,localizationAPI:n,displayMode:o,preventDefaultKeyDownBehavior:s,isTabbable:l}}}(G,V,w,!!(Q.commentFlags&c.a.Resolved),ne?P.ReadOnly:ve?P.Disabled:P.Default,I.onTaskTopperCheckboxPressed,U,W&&!ve):void 0,X,Z,d.C()?Object(f.d)(M,Q.author):void 0,Object(zr.b)(x)?Object(ee.p)():void 0,$,te,re,se,ne,q,pe)}));function xo(e){return s.createElement(Oo,Object(o.__assign)({},e))}function So(e,t,n){return e.map((function(e){var r=fo.e(e);return t[r]||n&&n[r]}))}},2652:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(413))},2653:function(e,t,n){"use strict";(function(e){var r=n(2574),o=n(2741),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.a.Buffer:void 0,l=(s?s.isBuffer:void 0)||o.a;t.a=l}).call(this,n(2654)(e))},2654:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},2655:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9),o=n(1),i=n(635);function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.Children.toArray(t).reduce((function(e,t){if(!t)return e;if(i.isElement(t))return t.props.children&&Object(r.j)("Warning: wrapper elements should not contain children"),o.cloneElement(t,void 0,e);throw new Error("Expected element but got ".concat(t))}),e)}},2656:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2581);function o(e){return e===r.a.LowFidelityWarningDelete||e===r.a.LowFidelityWarningEdit}},2657:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(1).createContext(new Proxy({},{get:function(){throw new Error("LPPManagerContext undefined. Did you forget to render a LPPManagerContext context provider?")}}))},2658:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return b}));var r=n(3),o=n(8),i=n(260),a=n(272),s=n(35),l=n(1029),c=n(74),p=n(2600),u=n(2581),d=n(136),f=n(2656),h=function(e,t,n,r,o,i,l,d){if(Object(f.a)(t)&&n===c.a.Edit)return[e.proceedItemForLowFidelityWarningEdit,e.cancelLowFidelityWarningEditItem];if(Object(f.a)(t)&&n===c.a.DeleteReply)return[e.deleteItemForLowFidelityWarningDelete,e.cancelLowFidelityWarningDeleteItem];if(t===u.a.Error)return[e.retry,o?e.deleteRootItem:e.deleteItem];if(t===u.a.Resolved)return[];if(s.l()&&t===u.a.EditPreCommitPending)return i?[]:[e.saveItemPending,e.cancelEditItem];if(t===u.a.Editing||t===u.a.EditPreCommitPending)return i?[]:[e.saveItem,e.cancelEditItem];var h=[];return d&&h.push(e.linkToCommentMenuItem),i||r===p.a.None||(r!==p.a.Any||s.D()||l&a.a.EditRestricted||h.push(e.editItem),l&a.a.DeleteRestricted||o||h.push(e.deleteItem)),h};function m(e,t,n,r,i,l,c){var u=[];if(c&&u.push(e.linkToComment),n===p.a.None||t&a.a.ReadOnly)return u;var d=(t&a.a.Resolved)>0,f=l?e.resolveTask:e.resolveThread,h=l?e.deleteTask:e.deleteThread;return Object(o.k)().assertConditionTag(r||!d,"Card cannot be resolved when resolved is not supported",593764383),d&&r?(u.push(e.reopenThread),t&a.a.DeleteRestricted||u.push(h),u):(n!==p.a.Any||!s.l()||s.D()||t&a.a.EditRestricted||i||u.push(e.editRootPost),c&&r&&u.push(f),t&a.a.DeleteRestricted||u.push(h),!c&&r&&u.push(f),u)}function y(e,t){var n={text:e.getString(5),icon:3,onClick:t.onDeleteThread,isDestructive:!0,tooltipText:e.getString(5)},o={text:e.getString(3),icon:5,onClick:t.onResolveThread},i=e.getString(4);return{deleteThread:n,resolveThread:o,reopenThread:{id:Object(d.Q)(),text:i,icon:s.l()?16:4,onClick:t.onReopenThread,tooltipText:i},editRootPost:{text:e.getString(120),onClick:t.onEditRootPost,icon:6,accessibilityLabel:e.getString(120)},linkToComment:{text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25,tooltipText:e.getString(207)},deleteTask:Object(r.__assign)(Object(r.__assign)({},n),{text:e.getString(206),tooltipText:e.getString(206)}),resolveTask:{text:e.getString(126),icon:5,onClick:t.onResolveThread}}}function b(e,t){var n=s.l(),a=e.getString(15),c=e.getString(121),p={text:e.getString(184),onClick:t.onClearError,icon:19,accessibilityLabel:e.getStringOrUndefined(184)},u={text:e.getString(5),onClick:t.onDelete,icon:3,accessibilityLabel:e.getStringOrUndefined(5),isDestructive:!0},d=n?c:e.getString(2),f={text:d,onClick:t.onDelete,icon:3,accessibilityLabel:d,isDestructive:!0},h=n?e.getString(120):e.getString(1),m={text:h,onClick:t.onEdit,icon:6,accessibilityLabel:h},y={text:a,icon:1,onClick:t.onCancel,onKeyDown:function(e,n){n?Object(i.f)(e.key)===i.b.Enter&&t.onCancel(n):Object(o.k)().assertConditionTag(!1,"CommentPostInterface ref is undefined for cancelEditItem.",544477844)},accessibilityLabel:a,isCancelItem:!0,usePrimaryButtonStyling:!1,tooltipText:a},b={text:e.getString(14),icon:24,onClick:function(e){return t.onCommit(e,l.a.CommitButton)},onKeyDown:function(e,n){n?Object(i.f)(e.key)===i.b.Enter&&t.onCommit(n,l.a.CommitButton):Object(o.k)().assertConditionTag(!1,"CommentPostInterface ref is undefined for saveItem.",544477845)},accessibilityLabel:e.getString(173),usePrimaryButtonStyling:!0,tooltipText:e.getString(173)},g=Object(r.__assign)(Object(r.__assign)({},b),{showDelayedSpinner:!0}),v=n?c:e.getString(2),C={text:v,onClick:t.onLowFidelityWarningConfirm,icon:3,accessibilityLabel:v,isDestructive:!0},T={text:a,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:a,icon:0,isCancelItem:!0},O={text:e.getString(37),onClick:t.onLowFidelityWarningConfirm,accessibilityLabel:e.getStringOrUndefined(42),icon:0};return{retry:p,deleteRootItem:u,cancelEditItem:y,cancelLowFidelityWarningDeleteItem:T,cancelLowFidelityWarningEditItem:{text:a,icon:1,onClick:t.onLowFidelityWarningCancel,accessibilityLabel:a,isCancelItem:!0,tooltipText:a},deleteItem:f,deleteItemForLowFidelityWarningDelete:C,editItem:m,proceedItemForLowFidelityWarningEdit:O,saveItem:b,saveItemPending:g,linkToCommentMenuItem:{text:e.getString(207),onClick:t.onPresentLinkToComment,icon:25}}}},2659:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(3),o=n(456),i=n(5),a=n(143),s=n(696),l=n(1157),c=n(1),p=n(2116),u=n(821),d=function(e){var t=Object(o.a)(),n=Object(r.__read)(c.useState(matchMedia(i.m).matches),2),d=n[0],f=n[1],h=c.useRef(matchMedia(i.m)),m=function(e){f(e.matches)};c.useEffect((function(){var e=h.current;return e.addEventListener("change",m),function(){e.removeEventListener("change",m)}}),[h]);var y=c.useMemo((function(){return d?void 0:{colors:Object(u.b)(t),styles:Object(u.c)(t)}}),[d,t]),b=Object(a.a)()?"rtl":"ltr";return c.createElement(l.a,{dir:b,style:{background:"transparent",height:"100%",lineHeight:"normal"},theme:Object(u.d)()},c.createElement(s.a,{style:{background:"transparent"},as:c.Fragment,theme:t},c.createElement(p.a.Provider,{value:y},e.children)))}},2685:function(e,t,n){"use strict";n.d(t,"b",(function(){return Xe})),n.d(t,"h",(function(){return Ze})),n.d(t,"j",(function(){return et})),n.d(t,"a",(function(){return tt})),n.d(t,"c",(function(){return nt})),n.d(t,"e",(function(){return rt})),n.d(t,"m",(function(){return ot})),n.d(t,"l",(function(){return it})),n.d(t,"f",(function(){return at})),n.d(t,"d",(function(){return st})),n.d(t,"n",(function(){return lt})),n.d(t,"k",(function(){return ct})),n.d(t,"i",(function(){return pt})),n.d(t,"g",(function(){return ut}));var r=n(49),o=function(e,t){return e===t||e!=e&&t!=t},i=function(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1},a=Array.prototype.splice;function s(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}s.prototype.clear=function(){this.__data__=[],this.size=0},s.prototype.delete=function(e){var t=this.__data__,n=i(t,e);return!(n<0||(n==t.length-1?t.pop():a.call(t,n,1),--this.size,0))},s.prototype.get=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]},s.prototype.has=function(e){return i(this.__data__,e)>-1},s.prototype.set=function(e,t){var n=this.__data__,r=i(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var l,c=s,p=n(2574),u=p.a.Symbol,d=Object.prototype,f=d.hasOwnProperty,h=d.toString,m=u?u.toStringTag:void 0,y=Object.prototype.toString,b=u?u.toStringTag:void 0,g=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":b&&b in Object(e)?function(e){var t=f.call(e,m),n=e[m];try{e[m]=void 0;var r=!0}catch(e){}var o=h.call(e);return r&&(t?e[m]=n:delete e[m]),o}(e):function(e){return y.call(e)}(e)},v=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},C=function(e){if(!v(e))return!1;var t=g(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},T=p.a["__core-js_shared__"],O=(l=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"",x=Function.prototype.toString,S=function(e){if(null!=e){try{return x.call(e)}catch(e){}try{return e+""}catch(e){}}return""},k=/^\[object .+?Constructor\]$/,P=Function.prototype,E=Object.prototype,j=P.toString,I=E.hasOwnProperty,w=RegExp("^"+j.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=function(e){return!(!v(e)||(t=e,O&&O in t))&&(C(e)?w:k).test(S(e));var t},R=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return A(n)?n:void 0},D=R(p.a,"Map"),_=R(Object,"create"),N=Object.prototype.hasOwnProperty,M=Object.prototype.hasOwnProperty;function B(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}B.prototype.clear=function(){this.__data__=_?_(null):{},this.size=0},B.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},B.prototype.get=function(e){var t=this.__data__;if(_){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return N.call(t,e)?t[e]:void 0},B.prototype.has=function(e){var t=this.__data__;return _?void 0!==t[e]:M.call(t,e)},B.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=_&&void 0===t?"__lodash_hash_undefined__":t,this};var L=B,F=function(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map};function H(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}H.prototype.clear=function(){this.size=0,this.__data__={hash:new L,map:new(D||c),string:new L}},H.prototype.delete=function(e){var t=F(this,e).delete(e);return this.size-=t?1:0,t},H.prototype.get=function(e){return F(this,e).get(e)},H.prototype.has=function(e){return F(this,e).has(e)},H.prototype.set=function(e,t){var n=F(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var U=H;function z(e){var t=this.__data__=new c(e);this.size=t.size}z.prototype.clear=function(){this.__data__=new c,this.size=0},z.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},z.prototype.get=function(e){return this.__data__.get(e)},z.prototype.has=function(e){return this.__data__.has(e)},z.prototype.set=function(e,t){var n=this.__data__;if(n instanceof c){var r=n.__data__;if(!D||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new U(r)}return n.set(e,t),this.size=n.size,this};var K=z;function V(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new U;++t<n;)this.add(e[t])}V.prototype.add=V.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},V.prototype.has=function(e){return this.__data__.has(e)};var W=V,q=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},Q=function(e,t,n,r,o,i){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=i.get(e),p=i.get(t);if(c&&p)return c==t&&p==e;var u=-1,d=!0,f=2&n?new W:void 0;for(i.set(e,t),i.set(t,e);++u<s;){var h=e[u],m=t[u];if(r)var y=a?r(m,h,u,t,e,i):r(h,m,u,e,t,i);if(void 0!==y){if(y)continue;d=!1;break}if(f){if(!q(t,(function(e,t){if(a=t,!f.has(a)&&(h===e||o(h,e,n,r,i)))return f.push(t);var a}))){d=!1;break}}else if(h!==m&&!o(h,m,n,r,i)){d=!1;break}}return i.delete(e),i.delete(t),d},G=p.a.Uint8Array,Y=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},J=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n},$=u?u.prototype:void 0,X=$?$.valueOf:void 0,Z=Array.isArray,ee=Object.prototype.propertyIsEnumerable,te=Object.getOwnPropertySymbols,ne=te?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var a=e[n];t(a,n,e)&&(i[o++]=a)}return i}(te(e),(function(t){return ee.call(e,t)})))}:function(){return[]},re=function(e){return null!=e&&"object"==typeof e},oe=function(e){return re(e)&&"[object Arguments]"==g(e)},ie=Object.prototype,ae=ie.hasOwnProperty,se=ie.propertyIsEnumerable,le=oe(function(){return arguments}())?oe:function(e){return re(e)&&ae.call(e,"callee")&&!se.call(e,"callee")},ce=n(2653),pe=/^(?:0|[1-9]\d*)$/,ue=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&pe.test(e))&&e>-1&&e%1==0&&e<t},de=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},fe={};fe["[object Float32Array]"]=fe["[object Float64Array]"]=fe["[object Int8Array]"]=fe["[object Int16Array]"]=fe["[object Int32Array]"]=fe["[object Uint8Array]"]=fe["[object Uint8ClampedArray]"]=fe["[object Uint16Array]"]=fe["[object Uint32Array]"]=!0,fe["[object Arguments]"]=fe["[object Array]"]=fe["[object ArrayBuffer]"]=fe["[object Boolean]"]=fe["[object DataView]"]=fe["[object Date]"]=fe["[object Error]"]=fe["[object Function]"]=fe["[object Map]"]=fe["[object Number]"]=fe["[object Object]"]=fe["[object RegExp]"]=fe["[object Set]"]=fe["[object String]"]=fe["[object WeakMap]"]=!1;var he,me=n(2742),ye=me.a&&me.a.isTypedArray,be=ye?(he=ye,function(e){return he(e)}):function(e){return re(e)&&de(e.length)&&!!fe[g(e)]},ge=Object.prototype.hasOwnProperty,ve=function(e,t){var n=Z(e),r=!n&&le(e),o=!n&&!r&&Object(ce.a)(e),i=!n&&!r&&!o&&be(e),a=n||r||o||i,s=a?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=s.length;for(var c in e)!t&&!ge.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ue(c,l))||s.push(c);return s},Ce=Object.prototype,Te=function(e,t){return function(n){return e(t(n))}}(Object.keys,Object),Oe=Object.prototype.hasOwnProperty,xe=function(e){if(n=(t=e)&&t.constructor,t!==("function"==typeof n&&n.prototype||Ce))return Te(e);var t,n,r=[];for(var o in Object(e))Oe.call(e,o)&&"constructor"!=o&&r.push(o);return r},Se=function(e){return null!=(t=e)&&de(t.length)&&!C(t)?ve(e):xe(e);var t},ke=function(e){return function(e,t,n){var r=t(e);return Z(e)?r:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,Se,ne)},Pe=Object.prototype.hasOwnProperty,Ee=R(p.a,"DataView"),je=R(p.a,"Promise"),Ie=R(p.a,"Set"),we=R(p.a,"WeakMap"),Ae=S(Ee),Re=S(D),De=S(je),_e=S(Ie),Ne=S(we),Me=g;(Ee&&"[object DataView]"!=Me(new Ee(new ArrayBuffer(1)))||D&&"[object Map]"!=Me(new D)||je&&"[object Promise]"!=Me(je.resolve())||Ie&&"[object Set]"!=Me(new Ie)||we&&"[object WeakMap]"!=Me(new we))&&(Me=function(e){var t=g(e),n="[object Object]"==t?e.constructor:void 0,r=n?S(n):"";if(r)switch(r){case Ae:return"[object DataView]";case Re:return"[object Map]";case De:return"[object Promise]";case _e:return"[object Set]";case Ne:return"[object WeakMap]"}return t});var Be=Me,Le=Object.prototype.hasOwnProperty,Fe=function(e,t,n,r,i,a){var s=Z(e),l=Z(t),c=s?"[object Array]":Be(e),p=l?"[object Array]":Be(t),u="[object Object]"==(c="[object Arguments]"==c?"[object Object]":c),d="[object Object]"==(p="[object Arguments]"==p?"[object Object]":p),f=c==p;if(f&&Object(ce.a)(e)){if(!Object(ce.a)(t))return!1;s=!0,u=!1}if(f&&!u)return a||(a=new K),s||be(e)?Q(e,t,n,r,i,a):function(e,t,n,r,i,a,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new G(e),new G(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var l=Y;case"[object Set]":var c=1&r;if(l||(l=J),e.size!=t.size&&!c)return!1;var p=s.get(e);if(p)return p==t;r|=2,s.set(e,t);var u=Q(l(e),l(t),r,i,a,s);return s.delete(e),u;case"[object Symbol]":if(X)return X.call(e)==X.call(t)}return!1}(e,t,c,n,r,i,a);if(!(1&n)){var h=u&&Le.call(e,"__wrapped__"),m=d&&Le.call(t,"__wrapped__");if(h||m){var y=h?e.value():e,b=m?t.value():t;return a||(a=new K),i(y,b,n,r,a)}}return!!f&&(a||(a=new K),function(e,t,n,r,o,i){var a=1&n,s=ke(e),l=s.length;if(l!=ke(t).length&&!a)return!1;for(var c=l;c--;){var p=s[c];if(!(a?p in t:Pe.call(t,p)))return!1}var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var f=!0;i.set(e,t),i.set(t,e);for(var h=a;++c<l;){var m=e[p=s[c]],y=t[p];if(r)var b=a?r(y,m,p,t,e,i):r(m,y,p,e,t,i);if(!(void 0===b?m===y||o(m,y,n,r,i):b)){f=!1;break}h||(h="constructor"==p)}if(f&&!h){var g=e.constructor,v=t.constructor;g==v||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof v&&v instanceof v||(f=!1)}return i.delete(e),i.delete(t),f}(e,t,n,r,i,a))},He=function(e,t){return function e(t,n,r,o,i){return t===n||(null==t||null==n||!re(t)&&!re(n)?t!=t&&n!=n:Fe(t,n,r,o,e,i))}(e,t)},Ue=n(120),ze=n(849),Ke=n(1209),Ve=n(665),We=n(130),qe=n(23),Qe=n(388);function Ge(){return Ye||(Ye=Object(Ue.b)(ze.a,He)),Ye}var Ye=void 0,Je=function(e,t){var n,r;return null!==(r=null===(n=t.resource)||void 0===n?void 0:n.id)&&void 0!==r?r:""},$e=function(e,t){return t.componentTree.componentTreeId.renderContextType},Xe=function(){return Object(Ue.a)([Je,qe.c],(function(e,t){return t[e]}))},Ze=function(){return Object(Ue.a)([Je,qe.n],(function(e,t){return t===e}))},et=function(){return Ge()([Je,qe.t],(function(e,t){return(null==t?void 0:t.selectedCardId)===e?t:void 0}))},tt=function(){return Object(Ue.a)([Je,$e,qe.h],(function(e,t,n){return Object(Ke.a)(e,t,n)}))},nt=function(){return Object(Ue.a)([Je,qe.a,qe.c],(function(e,t,n){return Object(Ve.d)(e,t,n)}))},rt=function(){return Object(Ue.a)([Je,qe.h],(function(e,t){return t.drafts[e]}))},ot=function(e,t,n,r){return Object(Ue.a)([Je,qe.d,qe.b,r,e,n,t],(function(e,t,n,r,o,i,a){return Object(Ve.c)(e,t,n,r,o,i,a)}))},it=function(e){return Ge()([e,qe.s],(function(e,t){return e.thread.reduce((function(e,n){return e[n.commentId]=t[n.commentId],e}),{})}))},at=function(e){return Ge()([e,Qe.a],(function(e,t){var n={};return e&&e.history.forEach((function(r){r.records.forEach((function(r){var o=We.a(e.id,r.recordId);n[o]=t[o]}))})),n}))},st=function(e,t){return Object(Ue.a)([Je,e,qe.h,$e,t],(function(e,t,n,r,o){return Object(Ve.a)(e,t,n,r,o)}))},lt=function(e){return Object(Ue.a)([e],(function(e){return Object(r.h)(e)}))},ct=function(){return Object(Ue.a)([Je,Qe.b],(function(e,t){return t[e]}))},pt=function(e,t){return Ge()([e,t],(function(e,t){return Object(We.l)(e.thread,t)}))},ut=function(){return Object(Ue.a)([Je,qe.h],(function(e,t){return t.cardIdToDraftIdMap[e]===e}))}},2687:function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var r=n(185),o=n(23),i=n(2685),a=n(3),s=n(1),l=n(9),c=n(2979),p=n(1569),u=n(2464),d=n(333),f=n(8),h=n(76),m=n(90),y=n(35),b=n(47),g=n(86),v=n(24),C=n(2600),T=n(325),O=n(42),x=n(2620),S=n(313),k=n(2631),P=s.createContext(new Proxy({},{get:function(){throw new Error("BaseCommentAPI undefined. Did you forget to configure comment api context?")}})),E=n(2575),j=n(2657),I=n(130),w=n(2658),A=n(265),R=function(e){function t(t){var n=e.call(this,t)||this;return n.memoGetActionBarItems=Object(c.a)(w.a,20,(function(){Object(f.k)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875360)})),n.memoGetCardContextualMenuItems=Object(c.a)(w.c,20,(function(){Object(f.k)().assertConditionTag(!1,"Cache invalidated, memoization or parameters configured incorrectly?",557875361)})),n.getMentionableCommentEditorProps=Object(p.a)((function(e,t){if(e===h.b.Enabled)return{onMentionCreated:n.onMentionCreated,onMentioneesStillInDraftUpdated:n.onMentioneesStillInDraftUpdated,getAuthToken:n.getAuthToken,correlationId:n.props.correlationId,suggestionsDetails:t}})),n.getRenderableItemActionBarItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!n.renderableItemActionBarItems||void 0===n.memoGetActionBarItems)throw new l.c("Function should not be called when DeleteRestricted gate is off.",l.d.reserveTag(557601689));return n.memoGetActionBarItems.apply(n,Object(a.__spreadArray)([n.renderableItemActionBarItems],Object(a.__read)(e),!1))},n.getCardContextualMenuItems=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!n.cardContextMenuItems||void 0===n.memoGetCardContextualMenuItems)throw new l.c("Function should not be called when DeleteRestricted gate is off.",l.d.reserveTag(557601690));return n.memoGetCardContextualMenuItems.apply(n,Object(a.__spreadArray)([n.cardContextMenuItems],Object(a.__read)(e),!1))},n.onPostDelete=function(e){S.D({trackback:l.d.reserveTag(593826139),id:e,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onPostEdit=function(e){S.E({trackback:l.d.reserveTag(593801875),id:e,data:n.props.dataItems,selectedComment:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCommit=function(e,t){S.C({trackback:l.d.reserveTag(593826141),id:e.getId(),data:n.props.dataItems,draftState:n.props.draftState,contentPromise:e.getContentsAsync(),atMentionsEnabled:n.props.modelCapabilities.atMention===h.b.Enabled,componentTree:n.props.componentTree,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor,commitSource:t,localizationAPI:n.props.localizationAPI}).catch(Object(m.a)(l.d.reserveTag(593826142)))},n.onPostDraftEmptinessChanged=function(e,t){S.q({trackback:l.d.reserveTag(592041679),contentId:e.getId(),isEmpty:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostSaveDraft=function(e,t){S.x({trackback:l.d.reserveTag(592720402),id:e,editor:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.postIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onPostCancel=function(e){S.z({trackback:l.d.reserveTag(593826145),commentId:e.getId(),setContents:e.setContents.bind(e),data:n.props.dataItems,draftState:n.props.draftState,shouldClosePaneAfterDiscardDraft:!1,onWillDiscardCallback:void 0,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI})},n.onLowFidelityWarningCancel=function(){S.r({selectedState:n.props.selectedState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onLowFidelityWarningConfirm=function(){S.s({selectedState:n.props.selectedState,onCardDelete:n.cardOnDelete,onPostDelete:n.onPostDelete,onPostEdit:n.onPostEdit})},n.onPostReactionUpdated=function(e,t,r){S.w(l.d.reserveTag(587994052),e,t,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor,r)},n.onPresentLinkToComment=function(e){S.v(l.d.reserveTag(578852485),e,n.props.componentTree.componentTreeId.renderContextType,n.props,n.props.telemetryVisitor)},n.onRenderableItemSelect=function(e,t){var r=n.getRenderableItemFromRef(e);r?S.J({trackback:l.d.reserveTag(593826147),renderableItem:r,selectedComment:n.props.selectedState,cardCollapsedState:n.props.cardCollapsedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,shouldFocusAfter:t,draftState_deprecated:n.props.draftState}).catch(Object(m.a)(l.d.reserveTag(590123736))):Object(f.k)().assertConditionTag(!1,"Comment not rendered within Card. Is something incorrect in the tree?",593826146)},n.onPostCollapse=function(e){var t=n.getRenderableItemFromRef(e);t?S.B(l.d.reserveTag(589940442),t,n.props,n.props.telemetryVisitor,n.props.componentTree):Object(f.k)().assertConditionTag(!1,"Collapse from an unknown post?",589940441)},n.onPostFocusParent=function(e){var t=n.getRenderableItemFromRef(e);t?S.H(t,n.props.componentTree,n.props.focusManager,n.props.draftState):Object(f.k)().assertConditionTag(!1,"Focus parent from unknown post?",545867680)},n.cardOnResolveThread=function(e){S.m({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:l.d.reserveTag(593826176),id:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnReopenThread=function(e){S.l({trackback:l.d.reserveTag(593826177),id:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,isTask:!!n.props.threadTaskState})},n.cardOnDelete=function(e){Object(f.k)().assertConditionTag(n.props.componentTree.componentTreeId.renderContextType!==O.a.HalfPane,"Discard not yet fully supported for HalfPane in DHC",593826178),S.d({trackback:l.d.reserveTag(592840777),id:e,data:n.props.dataItems,selectedComment:n.props.selectedState,componentTree:n.props.componentTree,invokeModalDialog:void 0,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,isTask:!!n.props.threadTaskState,threadIndex:0,shouldCheckForLowFidelity:n.shouldCheckForLowFidelityOnCardDelete()})},n.cardOnPost=function(e,t){var r=n.props.isDraftThread?{type:"CREATE"}:{type:"REPLY",parentId:e.getId()};S.c({trackback:l.d.reserveTag(593622431),commentCardRef:e,draftState:n.props.draftState,areMentionsEnabled:n.props.modelCapabilities.atMention===h.b.Enabled,session:r,componentTree:n.props.componentTree,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,commitSource:t}).catch(Object(m.a)(l.d.reserveTag(593622432)))},n.cardOnCollapseCallback=function(e){S.b({trackback:l.d.reserveTag(562918285),commentCardRef:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnSelectCallback=function(e){S.n({trackback:l.d.reserveTag(571281792),commentCardRef:e,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:b.SelectActionType.SelectCard}})},n.cardOnSelectExpandCallback=function(e,t,r){S.n({trackback:l.d.reserveTag(571281763),commentCardRef:e,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:b.SelectActionType.ExpandCard,relativeDraftingState:n.props.cardRelativeDraftingState,draftState:n.props.draftState,shouldFocusAfter:r,selectRootPost:t}})},n.cardOnFocusCallback=function(e){S.i({trackback:l.d.reserveTag(571340120),commentCardRef:e,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,componentTree:n.props.componentTree,options:{selectActionType:b.SelectActionType.Polite},focusManager:n.props.focusManager,isDraftThread:n.props.isDraftThread})},n.cardOnBeginReplyCallback=function(e){S.a({trackback:l.d.reserveTag(593826189),threadId:e.getId(),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnHighlight=function(e,t){S.j({trackback:l.d.reserveTag(593826190),commentCardRef:e,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,shouldHighlightCard:t})},n.cardOnDraftingInputSizeChange=function(e,t){S.f({trackback:l.d.reserveTag(593826191),focusManager:n.props.focusManager,componentTree:n.props.componentTree,cardId:e.getId(),isCardLie:n.props.isDraftThread,newHeight:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,selectedComment:n.props.selectedState,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnDraftEmptinessChanged=function(e,t){S.q({trackback:l.d.reserveTag(592213847),contentId:e.getId(),isEmpty:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnEditorFocusLost=function(e){S.g({trackback:l.d.reserveTag(592065734),id:e.getId(),draftState:n.props.draftState,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnTaskTopperCheckboxPressed=function(){n.props.threadTaskState?S.o({componentTree:n.props.componentTree,focusManager:n.props.focusManager,trackback:l.d.reserveTag(593826194),id:n.props.threadId,renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI}):Object(f.k)().assertConditionTag(!1,"props.threadTaskState is undefined",593826193)},n.cardOnSaveDraft=function(e,t){S.x({trackback:l.d.reserveTag(592720403),id:e,editor:t,renderContextType:n.props.componentTree.componentTreeId.renderContextType,draftIdMap:n.props.draftState.cardIdToDraftIdMap,draftMap:n.props.draftState.drafts,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.cardOnCancel=function(e){Object(f.k)().assertConditionTag(n.props.isDraftThread||n.props.cardRelativeDraftingState===T.a.InCard,"Mismatch between selectedComment state and cancel reply callback.",593826196),S.e({trackback:l.d.reserveTag(592840778),showDiscardDialog:!1,invokeModalDialog:void 0,componentTree:n.props.componentTree,dispatchProps:n.props,closeOnDiscard:!1,cardId:n.props.threadId,draftState:n.props.draftState,telemetryVisitor:n.props.telemetryVisitor,localizationAPI:n.props.localizationAPI,focusManager:n.props.focusManager,lieIndex:0})},n.commentEditorOnKeyDown=function(e){n.commentEditorKeyDownHandler.onKeyDown(e)},n.onPostError=function(e){S.G({trackback:l.d.reserveTag(593764370),id:e.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onClearPostError=function(e){S.A({trackback:l.d.reserveTag(593764371),id:e.getId(),data:n.props.dataItems,renderContextType:n.props.componentTree.componentTreeId.renderContextType,actionDispatchers:n.props,telemetryVisitor:n.props.telemetryVisitor})},n.onCardMounted=function(e){S.k({cardProps:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardEditorMounted=function(e){S.h({cardId:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostMounted=function(e){S.I({postId:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onPostEditorMounted=function(e){S.F({postId:e,componentTree:n.props.componentTree,focusManager:n.props.focusManager})},n.onCardRendered=Object(u.a)((function(e){n.props.onInitialRender({commentId:e.id,renderContextType:n.props.componentTree.componentTreeId.renderContextType})})),n.onSelectedTaskAssigneeUpdated=function(e){S.y({trackback:l.d.reserveTag(593826204),renderContextType:n.props.componentTree.componentTreeId.renderContextType,dispatchProps:n.props,telemetryVisitor:n.props.telemetryVisitor,selectedAssignee:e})},n.getPostOrHistoryRecordStates=Object(p.b)(k.c,(function(){return[n.props.dataItems,n.props.threadPostStates,n.props.historyRecordViewStates]})),n.onMentionCreated=n.onMentionCreated.bind(n),n.onMentioneesStillInDraftUpdated=n.onMentioneesStillInDraftUpdated.bind(n),n.getAuthToken=n.getAuthToken.bind(n),n.commentPostCallbackProps={onDelete:n.onPostDelete,onEdit:n.onPostEdit,onCommit:n.onPostCommit,onCancel:n.onPostCancel,onSelect:n.onRenderableItemSelect,onDraftEmptinessChanged:n.onPostDraftEmptinessChanged,onSaveDraft:n.onPostSaveDraft,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onPostMounted:n.onPostMounted,onPostEditorMounted:n.onPostEditorMounted,onError:n.onPostError,onClearError:n.onClearPostError,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onCollapseParent:n.onPostCollapse,onFocusParent:n.onPostFocusParent,onReactionUpdated:n.onPostReactionUpdated,onPresentLinkToComment:n.onPresentLinkToComment,onClickableTextClicked:n.props.onClickableTextClicked},n.commentCardCallbackProps={onEditorPress:n.cardOnBeginReplyCallback,onCardCollapse:n.cardOnCollapseCallback,onCardSelect:n.cardOnSelectCallback,onCardSelectExpand:n.cardOnSelectExpandCallback,onCardFocus:n.cardOnFocusCallback,onCardHighlightChange:n.cardOnHighlight,onDraftingInputSizeChange:n.cardOnDraftingInputSizeChange,onDraftEmptinessChanged:n.cardOnDraftEmptinessChanged,onEditorBlur:n.cardOnEditorFocusLost,onCancel:n.cardOnCancel,onPost:n.cardOnPost,onSaveDraft:n.cardOnSaveDraft,onSelectedTaskAssigneeUpdated:n.onSelectedTaskAssigneeUpdated,onCardMounted:n.onCardMounted,onCardEditorMounted:n.onCardEditorMounted,onCardRendered:n.onCardRendered,onLowFidelityWarningConfirm:n.onLowFidelityWarningConfirm,onLowFidelityWarningCancel:n.onLowFidelityWarningCancel,onTaskTopperCheckboxPressed:n.cardOnTaskTopperCheckboxPressed,commentEditorAdditionalKeyDownHandler:n.commentEditorOnKeyDown,onReactionUpdated:n.onPostReactionUpdated,onEditRootPost:n.onPostEdit},n.contextualMenuCallbackProps={onReopenThread:n.cardOnReopenThread,onResolveThread:n.cardOnResolveThread,onDeleteThread:n.cardOnDelete,onEditRootPost:n.onPostEdit,onPresentLinkToComment:n.onPresentLinkToComment},n.renderableItemActionBarItems=w.d(n.props.localizationAPI,n.commentPostCallbackProps),n.cardContextMenuItems=w.b(n.props.localizationAPI,n.contextualMenuCallbackProps),n.commentContentsKeyDownHandler=n.props.focusManager.commentContentsKeyDown((function(){return n.props.componentTree}),y.b()?function(){return n.props.dataItems}:void 0),n.commentEditorKeyDownHandler=n.props.focusManager.commentEditorKeyDown((function(){return n.props.componentTree})),n}return Object(a.__extends)(t,e),t.prototype.focus=function(){this.props.focusManager.focusCommentCardCommand(this.props.componentTree,this.props.threadId),this.props.selectComment(this.props.componentTree,{renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:l.d.reserveTag(590205772),telemetryVisitor:this.props.telemetryVisitor},{selectedCard:this.props.threadId,selectType:b.SelectActionType.ExpandCard,source:g.a.Canvas},!1).catch(Object(m.a)(l.d.reserveTag(590104656)))},t.prototype.getInstanceId=function(){return this.props.componentInstanceId},t.prototype.shouldComponentUpdate=function(e,n){return t.havePropsMeaningfullyChanged(e,this.props)},t.prototype.updateDraftRenderLockIfApplicable=function(e){var t=Object(v.K)(this.props.draftState);t&&t.threadId===this.props.threadId&&this.props.updateRenderLockForDraft({renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:l.d.reserveTag(593826137),telemetryVisitor:this.props.telemetryVisitor},e,t.commentDraft.sessionConfiguration.draftId)},t.prototype.componentDidMount=function(){var e,t,n,r;null===(t=(e=this.props).componentRef)||void 0===t||t.call(e,this),null===(r=(n=this.props).setComponentRef)||void 0===r||r.call(n,this.props.componentInstanceId,this),this.updateDraftRenderLockIfApplicable(!0)},t.prototype.componentWillUnmount=function(){var e,t;null===(t=(e=this.props).setComponentRef)||void 0===t||t.call(e,this.props.componentInstanceId,null)},t.prototype.componentDidUpdate=function(e,t){if(this.props.draftState!==e.draftState){var n=Object(v.K)(e.draftState),r=Object(v.K)(this.props.draftState);!r||r.renderContextType===this.props.componentTree.componentTreeId.renderContextType||void 0!==n&&n.renderContextType===r.renderContextType||this.updateDraftRenderLockIfApplicable(!0)}this.props.focusManager.discreteCommentCardPropsUpdated(this.props.componentTree,e,this.props)},t.havePropsMeaningfullyChanged=function(e,t){var n=Object.keys(e),r=Object.keys(t);return n.length!==r.length||n.some((function(n){if(t[n]===e[n])return!1;if("dataItems"===n){if(t.dataItems.length!==e.dataItems.length)return!0;for(var r=0;r<t.dataItems.length;r++){var o=t.dataItems[r],i=e.dataItems[r];if(Object(A.a)(o)&&Object(A.a)(i)&&o.commentModel!==i.commentModel||!!o.historyItem!=!!i.historyItem)return!0}return!1}return"object"!=typeof t[n]||!function(e,t){if(!e&&t||e&&!t)return!1;if(!e&&!t)return!0;var n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every((function(n){return e[n]===t[n]}))}(t[n],e[n])}))},t.prototype.getAuthToken=function(){return this.props.peopleAPI.getAuthToken(d.c.Loki)},t.prototype.getRenderableItemFromRef=function(e){var t=e.getId();return this.props.dataItems.find((function(e){return I.e(e)===t}))},t.prototype.shouldCheckForLowFidelityOnCardDelete=function(){return!1},t.prototype.getKeyboardingOptions=function(){return{cardTabbingMode:x.a.ExpandedCardOrFirstCardTabbable,postTabbingMode:x.b.ExpandedCardRootPostTabbable}},t.prototype.onMentionCreated=function(e){S.t({failTag:l.d.reserveTag(593826199),successTag:l.d.reserveTag(593826200),person:e,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor,renderContextType:this.props.componentTree.componentTreeId.renderContextType,trackback:l.d.reserveTag(593826201)})},t.prototype.onMentioneesStillInDraftUpdated=function(e){S.u({trackback:l.d.reserveTag(593826203),emailsStillInDraft:e,renderContextType:this.props.componentTree.componentTreeId.renderContextType,dispatchProps:this.props,telemetryVisitor:this.props.telemetryVisitor})},t.prototype.renderThread=function(e){return e},t.prototype.onQueueLoadThread=function(){this.props.modelCapabilities.virtualized&&!this.props.isDraftThread&&this.props.queueLoadThread({renderContextType:this.props.componentTree.componentTreeId.renderContextType,telemetryVisitor:this.props.telemetryVisitor,trackback:l.d.reserveTag(573145492)})},t.prototype.render=function(){var e,t;this.onQueueLoadThread();var n=this.getMentionableCommentEditorProps(this.props.modelCapabilities.atMention,this.props.suggestionsDetails),r=void 0!==this.props.cardRelativeDraftingState,o=r||this.props.readOnly?C.a.None:C.a.Any,i=this.props.dataItems.length>1,a=k.e({thread:this.props.dataItems,renderContextType:this.props.componentTree.componentTreeId.renderContextType,cardState:this.props.cardState,postCallbacks:this.commentPostCallbackProps,mentionableEditorProps:n,cardCallbacks:this.commentCardCallbackProps,localizationAPI:this.props.localizationAPI,getActionBarItems:this.getRenderableItemActionBarItems,selectedState:this.props.selectedState,isolationEdit:this.props.componentTree.componentTreeId.renderContextType===O.a.HalfPane,isAtMentionEnabled:this.props.modelCapabilities.atMention===h.b.Enabled,isTaskCreationEnabled:Object(v.c)(this.props.modelCapabilities),isDraftThread:this.props.isDraftThread,isCommentsContextReadOnly:this.props.readOnly,keyboardingOptions:this.getKeyboardingOptions(),personaIconPropertiesMap:this.props.personaIconPropertiesMap,draftState:this.props.draftState,cardCollapsedState:this.props.cardCollapsedState,cardRelativeDraftingState:this.props.cardRelativeDraftingState,accessibilitySetSize:this.props.accessibilitySetSize,accessibilityPositionInSet:this.props.accessibilityPositionInSet,accessibilityLevel:this.props.accessibilityLevel,maximumDimensions:this.props.maximumDimensions,getCardContextualMenuItems:this.getCardContextualMenuItems,mentionEditorProps:n,restrictActionControls_deprecated:r,allowedDraftingSession:o,availableScreenHeight:void 0,contentBackgroundColor:i?"CardReplyBackground":"CardBackground",extraPaddingLeft:void 0,extraPaddingRight:void 0,preventDefaultKeyDownBehavior:this.getContentsPreventDefaultKeyDownBehavior(),isCardHighlighted:this.props.isHighlighted,maxDraftHeight:void 0,taskState:this.props.threadTaskState,cardStyle:void 0,onCardLayout:void 0,isCardTabbable:k.b(this.getKeyboardingOptions().cardTabbingMode,this.props.threadId,!1,this.props.cardCollapsedState,this.props.selectedState),postOrHistoryRecordStates:this.getPostOrHistoryRecordStates(),richTextCapabilities:this.props.modelCapabilities.richTextCapabilities,isUIAAnnotationPatternEnabled:this.props.modelCapabilities.UIAAnnotationPattern,isResolveSupported:this.props.modelCapabilities.resolve,tabFocusTrapBehavior:null===(t=null===(e=this.props)||void 0===e?void 0:e.accessibilityMetadata)||void 0===t?void 0:t.tabFocusTrapBehavior});return s.createElement(j.a.Provider,{value:this.props.lppManager},s.createElement(E.a.Provider,{value:this.props.componentTree.componentTreeId},s.createElement(P.Provider,{value:this.props.commentAPI},this.renderThread(a))))},t}(s.Component),D=n(17),_=n(5),N=Object(D.c)((function(e,t){return{cardContainer:Object(_.eb)({position:"relative",zIndex:Object(k.d)(e,t)||Object(k.a)(e,t)?1:0})}})),M=function(e){function t(t){var n=e.call(this,t)||this;return n.rootRef=s.createRef(),n.componentTree=n.props.componentTree,n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.focusManager.discreteCommentCardRootRefMounted(this.rootRef),e.prototype.componentDidMount.call(this)},t.prototype.getContentsPreventDefaultKeyDownBehavior=function(){},t.prototype.renderThread=function(e){var t=N(e.props.id,this.props.selectedState).cardContainer;return s.createElement("div",{ref:this.rootRef,className:t,onKeyDown:this.commentContentsKeyDownHandler.onKeyDown},e)},t}(R),B=n(535),L=n(760),F=Object(r.connect)((function(){var e,t=i.e(),n=i.c(),r=i.m((function(e){return o.g(e,!0)}),(function(e){return o.i(e,!0)}),t,n),a=i.l(r),s=i.j(),l=i.h(),c=i.b(),p=i.a(),u=i.k(),d=i.i(r,u),f=i.f(u);return function(t,n){if(n.isVirtualized&&e)return e;var i=r(t,n),h=u(t,n),m=i.thread[0].commentId;return e={threadId:m,dataItems:d(t,n),threadTaskState:h&&h.currentState,threadPostStates:a(t,n),historyRecordViewStates:f(t,n),selectedState:s(t,n),cardCollapsedState:Object(B.a)(m,o.j(t),n.componentTree.componentTreeId.renderContextType),readOnly:o.o(t),cardState:c(t,n),isHighlighted:l(t,n),personaIconPropertiesMap:o.r(t),isDraftThread:i.isDraftThread,draftState:o.h(t),cardRelativeDraftingState:p(t,n),modelCapabilities:o.p(t),suggestionsDetails:o.w(t)}}}),L.a)(M)},2741:function(e,t,n){"use strict";t.a=function(){return!1}},2742:function(e,t,n){"use strict";(function(e){var r=n(2652),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.a.process,s=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();t.a=s}).call(this,n(2654)(e))},2743:function(e,t,n){(function(t){var n;self,n=()=>(()=>{var e={6996:(e,t,n)=>{"use strict";var r=n(9976),o=n(9536),i=o(r("String.prototype.indexOf"));e.exports=function(e,t){var n=r(e,!!t);return"function"==typeof n&&i(e,".prototype.")>-1?o(n):n}},9536:(e,t,n)=>{"use strict";var r=n(3592),o=n(9976),i=n(2544),a=n(3704),s=o("%Function.prototype.apply%"),l=o("%Function.prototype.call%"),c=o("%Reflect.apply%",!0)||r.call(l,s),p=n(496),u=o("%Math.max%");e.exports=function(e){if("function"!=typeof e)throw new a("a function is required");var t=c(r,l,arguments);return i(t,1+u(0,e.length-(arguments.length-1)),!0)};var d=function(){return c(r,s,arguments)};p?p(e.exports,"apply",{value:d}):e.exports.apply=d},3520:(e,n,r)=>{function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e=r.nmd(e);var i=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var n,r,i;try{n=Map}catch(e){n=function(){}}try{r=Set}catch(e){r=function(){}}try{i=Promise}catch(e){i=function(){}}function a(s,c,p,u,d){"object"===o(c)&&(p=c.depth,u=c.prototype,d=c.includeNonEnumerable,c=c.circular);var f=[],h=[],m=void 0!==t;return void 0===c&&(c=!0),void 0===p&&(p=1/0),function s(p,y){if(null===p)return null;if(0===y)return p;var b,g;if("object"!=o(p))return p;if(e(p,n))b=new n;else if(e(p,r))b=new r;else if(e(p,i))b=new i((function(e,t){p.then((function(t){e(s(t,y-1))}),(function(e){t(s(e,y-1))}))}));else if(a.__isArray(p))b=[];else if(a.__isRegExp(p))b=new RegExp(p.source,l(p)),p.lastIndex&&(b.lastIndex=p.lastIndex);else if(a.__isDate(p))b=new Date(p.getTime());else{if(m&&t.isBuffer(p))return b=t.allocUnsafe?t.allocUnsafe(p.length):new t(p.length),p.copy(b),b;e(p,Error)?b=Object.create(p):void 0===u?(g=Object.getPrototypeOf(p),b=Object.create(g)):(b=Object.create(u),g=u)}if(c){var v=f.indexOf(p);if(-1!=v)return h[v];f.push(p),h.push(b)}for(var C in e(p,n)&&p.forEach((function(e,t){var n=s(t,y-1),r=s(e,y-1);b.set(n,r)})),e(p,r)&&p.forEach((function(e){var t=s(e,y-1);b.add(t)})),p){var T;g&&(T=Object.getOwnPropertyDescriptor(g,C)),T&&null==T.set||(b[C]=s(p[C],y-1))}if(Object.getOwnPropertySymbols){var O=Object.getOwnPropertySymbols(p);for(C=0;C<O.length;C++){var x=O[C];(!(k=Object.getOwnPropertyDescriptor(p,x))||k.enumerable||d)&&(b[x]=s(p[x],y-1),k.enumerable||Object.defineProperty(b,x,{enumerable:!1}))}}if(d){var S=Object.getOwnPropertyNames(p);for(C=0;C<S.length;C++){var k,P=S[C];(k=Object.getOwnPropertyDescriptor(p,P))&&k.enumerable||(b[P]=s(p[P],y-1),Object.defineProperty(b,P,{enumerable:!1}))}}return b}(s,p)}function s(e){return Object.prototype.toString.call(e)}function l(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return a.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},a.__objToStr=s,a.__isDate=function(e){return"object"===o(e)&&"[object Date]"===s(e)},a.__isArray=function(e){return"object"===o(e)&&"[object Array]"===s(e)},a.__isRegExp=function(e){return"object"===o(e)&&"[object RegExp]"===s(e)},a.__getRegExpFlags=l,a}();"object"===o(e)&&e.exports&&(e.exports=i)},888:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(9688),i=n(700),a=n(5768),s=n(3148),l=n(1544),c=n(4088),p=Date.prototype.getTime;function u(e){return null==e}function d(e){return!(!e||"object"!==r(e)||"number"!=typeof e.length||"function"!=typeof e.copy||"function"!=typeof e.slice||e.length>0&&"number"!=typeof e[0])}e.exports=function e(t,n,f){var h=f||{};return!!(h.strict?a(t,n):t===n)||(!t||!n||"object"!==r(t)&&"object"!==r(n)?h.strict?a(t,n):t==n:function(t,n,a){var f,h;if(r(t)!==r(n))return!1;if(u(t)||u(n))return!1;if(t.prototype!==n.prototype)return!1;if(i(t)!==i(n))return!1;var m=s(t),y=s(n);if(m!==y)return!1;if(m||y)return t.source===n.source&&l(t)===l(n);if(window["6ff612ab-3392-44a5-86ac-d2d82005ae77-deep-equal-patch"]){if(Object.prototype.toString.call(t)===Object.prototype.toString.call(n)==="[object Date]")return+t==+n}else if(c(t)&&c(n))return p.call(t)===p.call(n);var b=d(t),g=d(n);if(b!==g)return!1;if(b||g){if(t.length!==n.length)return!1;for(f=0;f<t.length;f++)if(t[f]!==n[f])return!1;return!0}if(r(t)!==r(n))return!1;try{var v=o(t),C=o(n)}catch(e){return!1}if(v.length!==C.length)return!1;for(v.sort(),C.sort(),f=v.length-1;f>=0;f--)if(v[f]!=C[f])return!1;for(f=v.length-1;f>=0;f--)if(!e(t[h=v[f]],n[h],a))return!1;return!0}(t,n,h))}},9549:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(496),i=n(6772),a=n(3704),s=n(3877);e.exports=function(e,t,n){if(!e||"object"!==r(e)&&"function"!=typeof e)throw new a("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!==r(t))throw new a("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new a("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new a("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new a("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new a("`loose`, if provided, must be a boolean");var l=arguments.length>3?arguments[3]:null,c=arguments.length>4?arguments[4]:null,p=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],d=!!s&&s(e,t);if(o)o(e,t,{configurable:null===p&&d?d.configurable:!p,enumerable:null===l&&d?d.enumerable:!l,value:n,writable:null===c&&d?d.writable:!c});else{if(!u&&(l||c||p))throw new i("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");e[t]=n}}},9464:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(9688),i="function"==typeof Symbol&&"symbol"===r(Symbol("foo")),a=Object.prototype.toString,s=Array.prototype.concat,l=n(9549),c=n(5767)(),p=function(e,t,n,r){if(t in e)if(!0===r){if(e[t]===n)return}else if("function"!=typeof(o=r)||"[object Function]"!==a.call(o)||!r())return;var o;c?l(e,t,n,!0):l(e,t,n)},u=function(e,t){var n=arguments.length>2?arguments[2]:{},r=o(t);i&&(r=s.call(r,Object.getOwnPropertySymbols(t)));for(var a=0;a<r.length;a+=1)p(e,r[a],t[r[a]],n[r[a]])};u.supportsDescriptors=!!c,e.exports=u},496:(e,t,n)=>{"use strict";var r=n(9976)("%Object.defineProperty%",!0)||!1;if(r)try{r({},"a",{value:1})}catch(e){r=!1}e.exports=r},6469:e=>{"use strict";e.exports=EvalError},3552:e=>{"use strict";e.exports=Error},2368:e=>{"use strict";e.exports=RangeError},2668:e=>{"use strict";e.exports=ReferenceError},6772:e=>{"use strict";e.exports=SyntaxError},3704:e=>{"use strict";e.exports=TypeError},2904:e=>{"use strict";e.exports=URIError},8208:e=>{"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),i.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},i.prototype.listeners=function(e,t){var r=n?n+e:e,o=this._events[r];if(t)return!!o;if(!o)return[];if(o.fn)return[o.fn];for(var i=0,a=o.length,s=new Array(a);i<a;i++)s[i]=o[i].fn;return s},i.prototype.emit=function(e,t,r,o,i,a){var s=n?n+e:e;if(!this._events[s])return!1;var l,c,p=this._events[s],u=arguments.length;if(p.fn){switch(p.once&&this.removeListener(e,p.fn,void 0,!0),u){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,t),!0;case 3:return p.fn.call(p.context,t,r),!0;case 4:return p.fn.call(p.context,t,r,o),!0;case 5:return p.fn.call(p.context,t,r,o,i),!0;case 6:return p.fn.call(p.context,t,r,o,i,a),!0}for(c=1,l=new Array(u-1);c<u;c++)l[c-1]=arguments[c];p.fn.apply(p.context,l)}else{var d,f=p.length;for(c=0;c<f;c++)switch(p[c].once&&this.removeListener(e,p[c].fn,void 0,!0),u){case 1:p[c].fn.call(p[c].context);break;case 2:p[c].fn.call(p[c].context,t);break;case 3:p[c].fn.call(p[c].context,t,r);break;case 4:p[c].fn.call(p[c].context,t,r,o);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];p[c].fn.apply(p[c].context,l)}}return!0},i.prototype.on=function(e,t,r){var i=new o(t,r||this),a=n?n+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],i]:this._events[a].push(i):(this._events[a]=i,this._eventsCount++),this},i.prototype.once=function(e,t,r){var i=new o(t,r||this,!0),a=n?n+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],i]:this._events[a].push(i):(this._events[a]=i,this._eventsCount++),this},i.prototype.removeListener=function(e,t,o,i){var a=n?n+e:e;if(!this._events[a])return this;if(!t)return 0==--this._eventsCount?this._events=new r:delete this._events[a],this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||o&&s.context!==o||(0==--this._eventsCount?this._events=new r:delete this._events[a]);else{for(var l=0,c=[],p=s.length;l<p;l++)(s[l].fn!==t||i&&!s[l].once||o&&s[l].context!==o)&&c.push(s[l]);c.length?this._events[a]=1===c.length?c[0]:c:0==--this._eventsCount?this._events=new r:delete this._events[a]}return this},i.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new r:delete this._events[t])):(this._events=new r,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prototype.setMaxListeners=function(){return this},i.prefixed=n,i.EventEmitter=i,e.exports=i},136:e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=Object.prototype.hasOwnProperty,r=Object.prototype.toString,o=Object.defineProperty,i=Object.getOwnPropertyDescriptor,a=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===r.call(e)},s=function(e){if(!e||"[object Object]"!==r.call(e))return!1;var t,o=n.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&n.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!o&&!i)return!1;for(t in e);return void 0===t||n.call(e,t)},l=function(e,t){o&&"__proto__"===t.name?o(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},c=function(e,t){if("__proto__"===t){if(!n.call(e,t))return;if(i)return i(e,t).value}return e[t]};e.exports=function e(){var n,r,o,i,p,u,d=arguments[0],f=1,h=arguments.length,m=!1;for("boolean"==typeof d&&(m=d,d=arguments[1]||{},f=2),(null==d||"object"!==t(d)&&"function"!=typeof d)&&(d={});f<h;++f)if(null!=(n=arguments[f]))for(r in n)o=c(d,r),d!==(i=c(n,r))&&(m&&i&&(s(i)||(p=a(i)))?(p?(p=!1,u=o&&a(o)?o:[]):u=o&&s(o)?o:{},l(d,{name:r,newValue:e(m,u,i)})):void 0!==i&&l(d,{name:r,newValue:i}));return d}},8612:e=>{function t(e,i,s){if(e==i)return e?[[0,e]]:[];(s<0||e.length<s)&&(s=null);var l=r(e,i),c=e.substring(0,l);l=o(e=e.substring(l),i=i.substring(l));var p=e.substring(e.length-l),u=function(e,i){var a;if(!e)return[[1,i]];if(!i)return[[-1,e]];var s=e.length>i.length?e:i,l=e.length>i.length?i:e,c=s.indexOf(l);if(-1!=c)return a=[[1,s.substring(0,c)],[0,l],[1,s.substring(c+l.length)]],e.length>i.length&&(a[0][0]=a[2][0]=-1),a;if(1==l.length)return[[-1,e],[1,i]];var p=function(e,t){var n=e.length>t.length?e:t,i=e.length>t.length?t:e;if(n.length<4||2*i.length<n.length)return null;function a(e,t,n){for(var i,a,s,l,c=e.substring(n,n+Math.floor(e.length/4)),p=-1,u="";-1!=(p=t.indexOf(c,p+1));){var d=r(e.substring(n),t.substring(p)),f=o(e.substring(0,n),t.substring(0,p));u.length<f+d&&(u=t.substring(p-f,p)+t.substring(p,p+d),i=e.substring(0,n-f),a=e.substring(n+d),s=t.substring(0,p-f),l=t.substring(p+d))}return 2*u.length>=e.length?[i,a,s,l,u]:null}var s,l,c,p,u,d=a(n,i,Math.ceil(n.length/4)),f=a(n,i,Math.ceil(n.length/2));return d||f?(s=f?d&&d[4].length>f[4].length?d:f:d,e.length>t.length?(l=s[0],c=s[1],p=s[2],u=s[3]):(p=s[0],u=s[1],l=s[2],c=s[3]),[l,c,p,u,s[4]]):null}(e,i);if(p){var u=p[0],d=p[1],f=p[2],h=p[3],m=p[4],y=t(u,f),b=t(d,h);return y.concat([[0,m]],b)}return function(e,t){for(var r=e.length,o=t.length,i=Math.ceil((r+o)/2),a=i,s=2*i,l=new Array(s),c=new Array(s),p=0;p<s;p++)l[p]=-1,c[p]=-1;l[a+1]=0,c[a+1]=0;for(var u=r-o,d=u%2!=0,f=0,h=0,m=0,y=0,b=0;b<i;b++){for(var g=-b+f;g<=b-h;g+=2){for(var v=a+g,C=(k=g==-b||g!=b&&l[v-1]<l[v+1]?l[v+1]:l[v-1]+1)-g;k<r&&C<o&&e.charAt(k)==t.charAt(C);)k++,C++;if(l[v]=k,k>r)h+=2;else if(C>o)f+=2;else if(d&&(x=a+u-g)>=0&&x<s&&-1!=c[x]){var T=r-c[x];if(k>=T)return n(e,t,k,C)}}for(var O=-b+m;O<=b-y;O+=2){for(var x=a+O,S=(T=O==-b||O!=b&&c[x-1]<c[x+1]?c[x+1]:c[x-1]+1)-O;T<r&&S<o&&e.charAt(r-T-1)==t.charAt(o-S-1);)T++,S++;if(c[x]=T,T>r)y+=2;else if(S>o)m+=2;else if(!d&&(v=a+u-O)>=0&&v<s&&-1!=l[v]){var k=l[v];if(C=a+k-v,k>=(T=r-T))return n(e,t,k,C)}}}return[[-1,e],[1,t]]}(e,i)}(e=e.substring(0,e.length-l),i=i.substring(0,i.length-l));return c&&u.unshift([0,c]),p&&u.push([0,p]),function e(t){t.push([0,""]);for(var n,i=0,a=0,s=0,l="",c="";i<t.length;)switch(t[i][0]){case 1:s++,c+=t[i][1],i++;break;case-1:a++,l+=t[i][1],i++;break;case 0:a+s>1?(0!==a&&0!==s&&(0!==(n=r(c,l))&&(i-a-s>0&&0==t[i-a-s-1][0]?t[i-a-s-1][1]+=c.substring(0,n):(t.splice(0,0,[0,c.substring(0,n)]),i++),c=c.substring(n),l=l.substring(n)),0!==(n=o(c,l))&&(t[i][1]=c.substring(c.length-n)+t[i][1],c=c.substring(0,c.length-n),l=l.substring(0,l.length-n))),0===a?t.splice(i-s,a+s,[1,c]):0===s?t.splice(i-a,a+s,[-1,l]):t.splice(i-a-s,a+s,[-1,l],[1,c]),i=i-a-s+(a?1:0)+(s?1:0)+1):0!==i&&0==t[i-1][0]?(t[i-1][1]+=t[i][1],t.splice(i,1)):i++,s=0,a=0,l="",c=""}""===t[t.length-1][1]&&t.pop();var p=!1;for(i=1;i<t.length-1;)0==t[i-1][0]&&0==t[i+1][0]&&(t[i][1].substring(t[i][1].length-t[i-1][1].length)==t[i-1][1]?(t[i][1]=t[i-1][1]+t[i][1].substring(0,t[i][1].length-t[i-1][1].length),t[i+1][1]=t[i-1][1]+t[i+1][1],t.splice(i-1,1),p=!0):t[i][1].substring(0,t[i+1][1].length)==t[i+1][1]&&(t[i-1][1]+=t[i+1][1],t[i][1]=t[i][1].substring(t[i+1][1].length)+t[i+1][1],t.splice(i+1,1),p=!0)),i++;p&&e(t)}(u),null!=s&&(u=function(e,t){var n=function(e,t){if(0===t)return[0,e];for(var n=0,r=0;r<e.length;r++){var o=e[r];if(-1===o[0]||0===o[0]){var i=n+o[1].length;if(t===i)return[r+1,e];if(t<i){e=e.slice();var a=t-n,s=[o[0],o[1].slice(0,a)],l=[o[0],o[1].slice(a)];return e.splice(r,1,s,l),[r+1,e]}n=i}}throw new Error("cursor_pos is out of bounds!")}(e,t),r=n[1],o=n[0],i=r[o],s=r[o+1];if(null==i)return e;if(0!==i[0])return e;if(null!=s&&i[1]+s[1]===s[1]+i[1])return r.splice(o,2,s,i),a(r,o,2);if(null!=s&&0===s[1].indexOf(i[1])){r.splice(o,2,[s[0],i[1]],[0,i[1]]);var l=s[1].slice(i[1].length);return l.length>0&&r.splice(o+2,0,[s[0],l]),a(r,o,3)}return e}(u,s)),function(e){for(var t=!1,n=function(e){return e.charCodeAt(0)>=56320&&e.charCodeAt(0)<=57343},r=2;r<e.length;r+=1)0===e[r-2][0]&&(o=e[r-2][1]).charCodeAt(o.length-1)>=55296&&o.charCodeAt(o.length-1)<=56319&&-1===e[r-1][0]&&n(e[r-1][1])&&1===e[r][0]&&n(e[r][1])&&(t=!0,e[r-1][1]=e[r-2][1].slice(-1)+e[r-1][1],e[r][1]=e[r-2][1].slice(-1)+e[r][1],e[r-2][1]=e[r-2][1].slice(0,-1));var o;if(!t)return e;var i=[];for(r=0;r<e.length;r+=1)e[r][1].length>0&&i.push(e[r]);return i}(u)}function n(e,n,r,o){var i=e.substring(0,r),a=n.substring(0,o),s=e.substring(r),l=n.substring(o),c=t(i,a),p=t(s,l);return c.concat(p)}function r(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(i,o)==t.substring(i,o)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o}function o(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),o=r,i=0;n<o;)e.substring(e.length-o,e.length-i)==t.substring(t.length-o,t.length-i)?i=n=o:r=o,o=Math.floor((r-n)/2+n);return o}var i=t;function a(e,t,n){for(var r=t+n-1;r>=0&&r>=t-1;r--)if(r+1<e.length){var o=e[r],i=e[r+1];o[0]===i[1]&&e.splice(r,2,[o[0],o[1]+i[1]])}return e}i.INSERT=1,i.DELETE=-1,i.EQUAL=0,e.exports=i},1912:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",n=Object.prototype.toString,r=Math.max,o=function(e,t){for(var n=[],r=0;r<e.length;r+=1)n[r]=e[r];for(var o=0;o<t.length;o+=1)n[o+e.length]=t[o];return n},i=function(e,t){for(var n=[],r=t||0,o=0;r<e.length;r+=1,o+=1)n[o]=e[r];return n},a=function(e,t){for(var n="",r=0;r<e.length;r+=1)n+=e[r],r+1<e.length&&(n+=t);return n};e.exports=function(e){var s=this;if("function"!=typeof s||"[object Function]"!==n.apply(s))throw new TypeError(t+s);for(var l,c=i(arguments,1),p=function(){if(this instanceof l){var t=s.apply(this,o(c,arguments));return Object(t)===t?t:this}return s.apply(e,o(c,arguments))},u=r(0,s.length-c.length),d=[],f=0;f<u;f++)d[f]="$"+f;if(l=Function("binder","return function ("+a(d,",")+"){ return binder.apply(this,arguments); }")(p),s.prototype){var h=function(){};h.prototype=s.prototype,l.prototype=new h,h.prototype=null}return l}},3592:(e,t,n)=>{"use strict";var r=n(1912);e.exports=Function.prototype.bind||r},9152:e=>{"use strict";var t=function(){return"string"==typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(e){n=null}t.functionsHaveConfigurableNames=function(){if(!t()||!n)return!1;var e=n((function(){}),"name");return!!e&&!!e.configurable};var r=Function.prototype.bind;t.boundFunctionsHaveNames=function(){return t()&&"function"==typeof r&&""!==function(){}.bind().name},e.exports=t},9976:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(3552),i=n(6469),a=n(2368),s=n(2668),l=n(6772),c=n(3704),p=n(2904),u=Function,d=function(e){try{return u('"use strict"; return ('+e+").constructor;")()}catch(e){}},f=Object.getOwnPropertyDescriptor;if(f)try{f({},"")}catch(e){f=null}var h=function(){throw new c},m=f?function(){try{return h}catch(e){try{return f(arguments,"callee").get}catch(e){return h}}}():h,y=n(3467)(),b=n(1228)(),g=Object.getPrototypeOf||(b?function(e){return e.__proto__}:null),v={},C="undefined"!=typeof Uint8Array&&g?g(Uint8Array):void 0,T={__proto__:null,"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":y&&g?g([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":v,"%AsyncGenerator%":v,"%AsyncGeneratorFunction%":v,"%AsyncIteratorPrototype%":v,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?void 0:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?void 0:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":o,"%eval%":eval,"%EvalError%":i,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":u,"%GeneratorFunction%":v,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":y&&g?g(g([][Symbol.iterator]())):void 0,"%JSON%":"object"===("undefined"==typeof JSON?"undefined":r(JSON))?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&y&&g?g((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":a,"%ReferenceError%":s,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&y&&g?g((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":y&&g?g(""[Symbol.iterator]()):void 0,"%Symbol%":y?Symbol:void 0,"%SyntaxError%":l,"%ThrowTypeError%":m,"%TypedArray%":C,"%TypeError%":c,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":p,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet};if(g)try{null.error}catch(e){var O=g(g(e));T["%Error.prototype%"]=O}var x={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},S=n(3592),k=n(6807),P=S.call(Function.call,Array.prototype.concat),E=S.call(Function.apply,Array.prototype.splice),j=S.call(Function.call,String.prototype.replace),I=S.call(Function.call,String.prototype.slice),w=S.call(Function.call,RegExp.prototype.exec),A=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,R=/\\(\\)?/g,D=function(e){var t=I(e,0,1),n=I(e,-1);if("%"===t&&"%"!==n)throw new l("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new l("invalid intrinsic syntax, expected opening `%`");var r=[];return j(e,A,(function(e,t,n,o){r[r.length]=n?j(o,R,"$1"):t||e})),r},_=function(e,t){var n,r=e;if(k(x,r)&&(r="%"+(n=x[r])[0]+"%"),k(T,r)){var o=T[r];if(o===v&&(o=function e(t){var n;if("%AsyncFunction%"===t)n=d("async function () {}");else if("%GeneratorFunction%"===t)n=d("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=d("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var o=e("%AsyncGenerator%");o&&g&&(n=g(o.prototype))}return T[t]=n,n}(r)),void 0===o&&!t)throw new c("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new l("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new c("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new c('"allowMissing" argument must be a boolean');if(null===w(/^%?[^%]*%?$/,e))throw new l("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=D(e),r=n.length>0?n[0]:"",o=_("%"+r+"%",t),i=o.name,a=o.value,s=!1,p=o.alias;p&&(r=p[0],E(n,P([0,1],p)));for(var u=1,d=!0;u<n.length;u+=1){var h=n[u],m=I(h,0,1),y=I(h,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new l("property names with quotes must have matching quotes");if("constructor"!==h&&d||(s=!0),k(T,i="%"+(r+="."+h)+"%"))a=T[i];else if(null!=a){if(!(h in a)){if(!t)throw new c("base intrinsic for "+e+" exists, but the property is not available.");return}if(f&&u+1>=n.length){var b=f(a,h);a=(d=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:a[h]}else d=k(a,h),a=a[h];d&&!s&&(T[i]=a)}}return a}},3877:(e,t,n)=>{"use strict";var r=n(9976)("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r},5767:(e,t,n)=>{"use strict";var r=n(496),o=function(){return!!r};o.hasArrayLengthDefineBug=function(){if(!r)return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=o},1228:e=>{"use strict";var t={__proto__:null,foo:{}},n=Object;e.exports=function(){return{__proto__:t}.foo===t.foo&&!(t instanceof n)}},3467:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o="undefined"!=typeof Symbol&&Symbol,i=n(9448);e.exports=function(){return"function"==typeof o&&"function"==typeof Symbol&&"symbol"===r(o("foo"))&&"symbol"===r(Symbol("bar"))&&i()}},9448:e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"===t(Symbol.iterator))return!0;var e={},n=Symbol("test"),r=Object(n);if("string"==typeof n)return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(n in e[n]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var o=Object.getOwnPropertySymbols(e);if(1!==o.length||o[0]!==n)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,n);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},8824:(e,t,n)=>{"use strict";var r=n(9448);e.exports=function(){return r()&&!!Symbol.toStringTag}},6807:(e,t,n)=>{"use strict";var r=Function.prototype.call,o=Object.prototype.hasOwnProperty,i=n(3592);e.exports=i.call(r,o)},700:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(8824)(),i=n(6996)("Object.prototype.toString"),a=function(e){return!(o&&e&&"object"===r(e)&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},s=function(e){return!!a(e)||null!==e&&"object"===r(e)&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},l=function(){return a(arguments)}();a.isLegacyArguments=s,e.exports=l?a:s},4088:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=Date.prototype.getDay,i=Object.prototype.toString,a=n(8824)();e.exports=function(e){return"object"===r(e)&&null!==e&&(a?function(e){try{return o.call(e),!0}catch(e){return!1}}(e):"[object Date]"===i.call(e))}},3148:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o,i,a,s,l=n(6996),c=n(8824)();if(c){o=l("Object.prototype.hasOwnProperty"),i=l("RegExp.prototype.exec"),a={};var p=function(){throw a};s={toString:p,valueOf:p},"symbol"===r(Symbol.toPrimitive)&&(s[Symbol.toPrimitive]=p)}var u=l("Object.prototype.toString"),d=Object.getOwnPropertyDescriptor;e.exports=c?function(e){if(!e||"object"!==r(e))return!1;var t=d(e,"lastIndex");if(!t||!o(t,"value"))return!1;try{i(e,s)}catch(e){return e===a}}:function(e){return!(!e||"object"!==r(e)&&"function"!=typeof e)&&"[object RegExp]"===u(e)}},7596:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,n){return 0===e&&0===n?1/e==1/n:e===n||!(!t(e)||!t(n))}},5768:(e,t,n)=>{"use strict";var r=n(9464),o=n(9536),i=n(7596),a=n(3672),s=n(1224),l=o(a(),Object);r(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},3672:(e,t,n)=>{"use strict";var r=n(7596);e.exports=function(){return"function"==typeof Object.is?Object.is:r}},1224:(e,t,n)=>{"use strict";var r=n(3672),o=n(9464);e.exports=function(){var e=r();return o(Object,{is:e},{is:function(){return Object.is!==e}}),e}},240:(e,t,n)=>{"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o;if(!Object.keys){var i=Object.prototype.hasOwnProperty,a=Object.prototype.toString,s=n(3376),l=Object.prototype.propertyIsEnumerable,c=!l.call({toString:null},"toString"),p=l.call((function(){}),"prototype"),u=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},h=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!f["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"===r(window[e]))try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();o=function(e){var t=null!==e&&"object"===r(e),n="[object Function]"===a.call(e),o=s(e),l=t&&"[object String]"===a.call(e),f=[];if(!t&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var m=p&&n;if(l&&e.length>0&&!i.call(e,0))for(var y=0;y<e.length;++y)f.push(String(y));if(o&&e.length>0)for(var b=0;b<e.length;++b)f.push(String(b));else for(var g in e)m&&"prototype"===g||!i.call(e,g)||f.push(String(g));if(c)for(var v=function(e){if("undefined"==typeof window||!h)return d(e);try{return d(e)}catch(e){return!1}}(e),C=0;C<u.length;++C)v&&"constructor"===u[C]||!i.call(e,u[C])||f.push(u[C]);return f}}e.exports=o},9688:(e,t,n)=>{"use strict";var r=Array.prototype.slice,o=n(3376),i=Object.keys,a=i?function(e){return i(e)}:n(240),s=Object.keys;a.shim=function(){return Object.keys?function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2)||(Object.keys=function(e){return o(e)?s(r.call(e)):s(e)}):Object.keys=a,Object.keys||a},e.exports=a},3376:e=>{"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=Object.prototype.toString;e.exports=function(e){var r=n.call(e),o="[object Arguments]"===r;return o||(o="[object Array]"!==r&&null!==e&&"object"===t(e)&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),o}},3292:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(8612),i=n(888),a=n(136),s=n(9772),l=String.fromCharCode(0),c=function(e){Array.isArray(e)?this.ops=e:null!=e&&Array.isArray(e.ops)?this.ops=e.ops:this.ops=[]};c.prototype.insert=function(e,t){var n={};return 0===e.length?this:(n.insert=e,null!=t&&"object"===r(t)&&Object.keys(t).length>0&&(n.attributes=t),this.push(n))},c.prototype.delete=function(e){return e<=0?this:this.push({delete:e})},c.prototype.retain=function(e,t){if(e<=0)return this;var n={retain:e};return null!=t&&"object"===r(t)&&Object.keys(t).length>0&&(n.attributes=t),this.push(n)},c.prototype.push=function(e){var t=this.ops.length,n=this.ops[t-1];if(e=a(!0,{},e),"object"===r(n)){if("number"==typeof e.delete&&"number"==typeof n.delete)return this.ops[t-1]={delete:n.delete+e.delete},this;if("number"==typeof n.delete&&null!=e.insert&&(t-=1,"object"!==r(n=this.ops[t-1])))return this.ops.unshift(e),this;if(i(e.attributes,n.attributes)){if("string"==typeof e.insert&&"string"==typeof n.insert)return this.ops[t-1]={insert:n.insert+e.insert},"object"===r(e.attributes)&&(this.ops[t-1].attributes=e.attributes),this;if("number"==typeof e.retain&&"number"==typeof n.retain)return this.ops[t-1]={retain:n.retain+e.retain},"object"===r(e.attributes)&&(this.ops[t-1].attributes=e.attributes),this}}return t===this.ops.length?this.ops.push(e):this.ops.splice(t,0,e),this},c.prototype.chop=function(){var e=this.ops[this.ops.length-1];return e&&e.retain&&!e.attributes&&this.ops.pop(),this},c.prototype.filter=function(e){return this.ops.filter(e)},c.prototype.forEach=function(e){this.ops.forEach(e)},c.prototype.map=function(e){return this.ops.map(e)},c.prototype.partition=function(e){var t=[],n=[];return this.forEach((function(r){(e(r)?t:n).push(r)})),[t,n]},c.prototype.reduce=function(e,t){return this.ops.reduce(e,t)},c.prototype.changeLength=function(){return this.reduce((function(e,t){return t.insert?e+s.length(t):t.delete?e-t.delete:e}),0)},c.prototype.length=function(){return this.reduce((function(e,t){return e+s.length(t)}),0)},c.prototype.slice=function(e,t){e=e||0,"number"!=typeof t&&(t=1/0);for(var n=[],r=s.iterator(this.ops),o=0;o<t&&r.hasNext();){var i;o<e?i=r.next(e-o):(i=r.next(t-o),n.push(i)),o+=s.length(i)}return new c(n)},c.prototype.compose=function(e){var t=s.iterator(this.ops),n=s.iterator(e.ops),r=[],o=n.peek();if(null!=o&&"number"==typeof o.retain&&null==o.attributes){for(var a=o.retain;"insert"===t.peekType()&&t.peekLength()<=a;)a-=t.peekLength(),r.push(t.next());o.retain-a>0&&n.next(o.retain-a)}for(var l=new c(r);t.hasNext()||n.hasNext();)if("insert"===n.peekType())l.push(n.next());else if("delete"===t.peekType())l.push(t.next());else{var p=Math.min(t.peekLength(),n.peekLength()),u=t.next(p),d=n.next(p);if("number"==typeof d.retain){var f={};"number"==typeof u.retain?f.retain=p:f.insert=u.insert;var h=s.attributes.compose(u.attributes,d.attributes,"number"==typeof u.retain);if(h&&(f.attributes=h),l.push(f),!n.hasNext()&&i(l.ops[l.ops.length-1],f)){var m=new c(t.rest());return l.concat(m).chop()}}else"number"==typeof d.delete&&"number"==typeof u.retain&&l.push(d)}return l.chop()},c.prototype.concat=function(e){var t=new c(this.ops.slice());return e.ops.length>0&&(t.push(e.ops[0]),t.ops=t.ops.concat(e.ops.slice(1))),t},c.prototype.diff=function(e,t){if(this.ops===e.ops)return new c;var n=[this,e].map((function(t){return t.map((function(n){if(null!=n.insert)return"string"==typeof n.insert?n.insert:l;throw new Error("diff() called "+(t===e?"on":"with")+" non-document")})).join("")})),r=new c,a=o(n[0],n[1],t),p=s.iterator(this.ops),u=s.iterator(e.ops);return a.forEach((function(e){for(var t=e[1].length;t>0;){var n=0;switch(e[0]){case o.INSERT:n=Math.min(u.peekLength(),t),r.push(u.next(n));break;case o.DELETE:n=Math.min(t,p.peekLength()),p.next(n),r.delete(n);break;case o.EQUAL:n=Math.min(p.peekLength(),u.peekLength(),t);var a=p.next(n),l=u.next(n);i(a.insert,l.insert)?r.retain(n,s.attributes.diff(a.attributes,l.attributes)):r.push(l).delete(n)}t-=n}})),r.chop()},c.prototype.eachLine=function(e,t){t=t||"\n";for(var n=s.iterator(this.ops),r=new c,o=0;n.hasNext();){if("insert"!==n.peekType())return;var i=n.peek(),a=s.length(i)-n.peekLength(),l="string"==typeof i.insert?i.insert.indexOf(t,a)-a:-1;if(l<0)r.push(n.next());else if(l>0)r.push(n.next(l));else{if(!1===e(r,n.next(1).attributes||{},o))return;o+=1,r=new c}}r.length()>0&&e(r,{},o)},c.prototype.transform=function(e,t){if(t=!!t,"number"==typeof e)return this.transformPosition(e,t);for(var n=s.iterator(this.ops),r=s.iterator(e.ops),o=new c;n.hasNext()||r.hasNext();)if("insert"!==n.peekType()||!t&&"insert"===r.peekType())if("insert"===r.peekType())o.push(r.next());else{var i=Math.min(n.peekLength(),r.peekLength()),a=n.next(i),l=r.next(i);if(a.delete)continue;l.delete?o.push(l):o.retain(i,s.attributes.transform(a.attributes,l.attributes,t))}else o.retain(s.length(n.next()));return o.chop()},c.prototype.transformPosition=function(e,t){t=!!t;for(var n=s.iterator(this.ops),r=0;n.hasNext()&&r<=e;){var o=n.peekLength(),i=n.peekType();n.next(),"delete"!==i?("insert"===i&&(r<e||!t)&&(e+=o),r+=o):e-=Math.min(o,e-r)}return e},e.exports=c},9772:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=n(888),i=n(136),a={attributes:{compose:function(e,t,n){"object"!==r(e)&&(e={}),"object"!==r(t)&&(t={});var o=i(!0,{},t);for(var a in n||(o=Object.keys(o).reduce((function(e,t){return null!=o[t]&&(e[t]=o[t]),e}),{})),e)void 0!==e[a]&&void 0===t[a]&&(o[a]=e[a]);return Object.keys(o).length>0?o:void 0},diff:function(e,t){"object"!==r(e)&&(e={}),"object"!==r(t)&&(t={});var n=Object.keys(e).concat(Object.keys(t)).reduce((function(n,r){return o(e[r],t[r])||(n[r]=void 0===t[r]?null:t[r]),n}),{});return Object.keys(n).length>0?n:void 0},transform:function(e,t,n){if("object"!==r(e))return t;if("object"===r(t)){if(!n)return t;var o=Object.keys(t).reduce((function(n,r){return void 0===e[r]&&(n[r]=t[r]),n}),{});return Object.keys(o).length>0?o:void 0}}},iterator:function(e){return new s(e)},length:function(e){return"number"==typeof e.delete?e.delete:"number"==typeof e.retain?e.retain:"string"==typeof e.insert?e.insert.length:1}};function s(e){this.ops=e,this.index=0,this.offset=0}s.prototype.hasNext=function(){return this.peekLength()<1/0},s.prototype.next=function(e){e||(e=1/0);var t=this.ops[this.index];if(t){var n=this.offset,r=a.length(t);if(e>=r-n?(e=r-n,this.index+=1,this.offset=0):this.offset+=e,"number"==typeof t.delete)return{delete:e};var o={};return t.attributes&&(o.attributes=t.attributes),"number"==typeof t.retain?o.retain=e:"string"==typeof t.insert?o.insert=t.insert.substr(n,e):o.insert=t.insert,o}return{retain:1/0}},s.prototype.peek=function(){return this.ops[this.index]},s.prototype.peekLength=function(){return this.ops[this.index]?a.length(this.ops[this.index])-this.offset:1/0},s.prototype.peekType=function(){return this.ops[this.index]?"number"==typeof this.ops[this.index].delete?"delete":"number"==typeof this.ops[this.index].retain?"retain":"insert":"retain"},s.prototype.rest=function(){if(this.hasNext()){if(0===this.offset)return this.ops.slice(this.index);var e=this.offset,t=this.index,n=this.next(),r=this.ops.slice(this.index);return this.offset=e,this.index=t,[n].concat(r)}return[]},e.exports=a},6620:()=>{var e=document.createElement("div");if(e.classList.toggle("test-class",!1),e.classList.contains("test-class")){var t=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,n){return arguments.length>1&&!this.contains(e)==!n?n:t.call(this,e)}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof e)throw new TypeError("predicate must be a function");for(var t,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(t=n[i],e.call(o,t,i,n))return t}}),document.addEventListener("DOMContentLoaded",(function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)}))},7608:(e,t,n)=>{"use strict";var r=n(6048),o=n(3704),i=Object;e.exports=r((function(){if(null==this||this!==i(this))throw new o("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.unicodeSets&&(e+="v"),this.sticky&&(e+="y"),e}),"get flags",!0)},1544:(e,t,n)=>{"use strict";var r=n(9464),o=n(9536),i=n(7608),a=n(128),s=n(9568),l=o(a());r(l,{getPolyfill:a,implementation:i,shim:s}),e.exports=l},128:(e,t,n)=>{"use strict";var r=n(7608),o=n(9464).supportsDescriptors,i=Object.getOwnPropertyDescriptor;e.exports=function(){if(o&&"gim"===/a/gim.flags){var e=i(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var t="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(n,"sticky",{get:function(){t+="y"}}),"dy"===t)return e.get}}return r}},9568:(e,t,n)=>{"use strict";var r=n(9464).supportsDescriptors,o=n(128),i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,s=TypeError,l=Object.getPrototypeOf,c=/a/;e.exports=function(){if(!r||!l)throw new s("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=o(),t=l(c),n=i(t,"flags");return n&&n.get===e||a(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},2544:(e,t,n)=>{"use strict";var r=n(9976),o=n(9549),i=n(5767)(),a=n(3877),s=n(3704),l=r("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new s("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||l(t)!==t)throw new s("`length` must be a positive 32-bit integer");var n=arguments.length>2&&!!arguments[2],r=!0,c=!0;if("length"in e&&a){var p=a(e,"length");p&&!p.configurable&&(r=!1),p&&!p.writable&&(c=!1)}return(r||c||!n)&&(i?o(e,"length",t,!0,!0):o(e,"length",t)),e}},6048:(e,t,n)=>{"use strict";var r=n(9549),o=n(5767)(),i=n(9152).functionsHaveConfigurableNames(),a=TypeError;e.exports=function(e,t){if("function"!=typeof e)throw new a("`fn` is not a function");var n=arguments.length>2&&!!arguments[2];return n&&!i||(o?r(e,"name",t,!0,!0):r(e,"name",t)),e}},9588:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6788),o=function(){function e(e,t,n){void 0===n&&(n={}),this.attrName=e,this.keyName=t;var o=r.Scope.TYPE&r.Scope.ATTRIBUTE;null!=n.scope?this.scope=n.scope&r.Scope.LEVEL|o:this.scope=r.Scope.ATTRIBUTE,null!=n.whitelist&&(this.whitelist=n.whitelist)}return e.keys=function(e){return[].map.call(e.attributes,(function(e){return e.name}))},e.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(e.setAttribute(this.keyName,t),!0)},e.prototype.canAdd=function(e,t){return null!=r.query(e,r.Scope.BLOT&(this.scope|r.Scope.TYPE))&&(null==this.whitelist||("string"==typeof t?this.whitelist.indexOf(t.replace(/["']/g,""))>-1:this.whitelist.indexOf(t)>-1))},e.prototype.remove=function(e){e.removeAttribute(this.keyName)},e.prototype.value=function(e){var t=e.getAttribute(this.keyName);return this.canAdd(e,t)&&t?t:""},e}();t.default=o},9371:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function i(e,t){return(e.getAttribute("class")||"").split(/\s+/).filter((function(e){return 0===e.indexOf("".concat(t,"-"))}))}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.keys=function(e){return(e.getAttribute("class")||"").split(/\s+/).map((function(e){return e.split("-").slice(0,-1).join("-")}))},t.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(this.remove(e),e.classList.add("".concat(this.keyName,"-").concat(t)),!0)},t.prototype.remove=function(e){i(e,this.keyName).forEach((function(t){e.classList.remove(t)})),0===e.classList.length&&e.removeAttribute("class")},t.prototype.value=function(e){var t=(i(e,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(e,t)?t:""},t}(n(9588).default);t.default=a},1024:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9588),o=n(9371),i=n(3800),a=n(6788),s=function(){function e(e){this.attributes={},this.domNode=e,this.build()}return e.prototype.attribute=function(e,t){t?e.add(this.domNode,t)&&(null!=e.value(this.domNode)?this.attributes[e.attrName]=e:delete this.attributes[e.attrName]):(e.remove(this.domNode),delete this.attributes[e.attrName])},e.prototype.build=function(){var e=this;this.attributes={};var t=r.default.keys(this.domNode),n=o.default.keys(this.domNode),s=i.default.keys(this.domNode);t.concat(n).concat(s).forEach((function(t){var n=a.query(t,a.Scope.ATTRIBUTE);n instanceof r.default&&(e.attributes[n.attrName]=n)}))},e.prototype.copy=function(e){var t=this;Object.keys(this.attributes).forEach((function(n){var r=t.attributes[n].value(t.domNode);e.format(n,r)}))},e.prototype.move=function(e){var t=this;this.copy(e),Object.keys(this.attributes).forEach((function(e){t.attributes[e].remove(t.domNode)})),this.attributes={}},e.prototype.values=function(){var e=this;return Object.keys(this.attributes).reduce((function(t,n){return t[n]=e.attributes[n].value(e.domNode),t}),{})},e}();t.default=s},3800:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function i(e){var t=e.split("-"),n=t.slice(1).map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("");return t[0]+n}Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.keys=function(e){return(e.getAttribute("style")||"").split(";").map((function(e){return e.split(":")[0].trim()}))},t.prototype.add=function(e,t){return!!this.canAdd(e,t)&&(e.style[i(this.keyName)]=t,!0)},t.prototype.remove=function(e){e.style[i(this.keyName)]="",e.getAttribute("style")||e.removeAttribute("style")},t.prototype.value=function(e){var t=e.style[i(this.keyName)];return this.canAdd(e,t)?t:""},t}(n(9588).default);t.default=a},2212:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(6844),a=n(4356),s=n(6788),l=function(e){function t(t){var n=e.call(this,t)||this;return n.build(),n}return o(t,e),t.prototype.appendChild=function(e){this.insertBefore(e)},t.prototype.attach=function(){e.prototype.attach.call(this),this.children.forEach((function(e){e.attach()}))},t.prototype.build=function(){var e=this;this.children=new i.default,[].slice.call(this.domNode.childNodes).reverse().forEach((function(t){try{var n=c(t);e.insertBefore(n,e.children.head||void 0)}catch(e){if(e instanceof s.ParchmentError)return;throw e}}))},t.prototype.deleteAt=function(e,t){if(0===e&&t===this.length())return this.remove();this.children.forEachAt(e,t,(function(e,t,n){e.deleteAt(t,n)}))},t.prototype.descendant=function(e,n){var r=this.children.find(n),o=r[0],i=r[1];return null==e.blotName&&e(o)||null!=e.blotName&&o instanceof e?[o,i]:o instanceof t?o.descendant(e,i):[null,-1]},t.prototype.descendants=function(e,n,r){void 0===n&&(n=0),void 0===r&&(r=Number.MAX_VALUE);var o=[],i=r;return this.children.forEachAt(n,r,(function(n,r,a){(null==e.blotName&&e(n)||null!=e.blotName&&n instanceof e)&&o.push(n),n instanceof t&&(o=o.concat(n.descendants(e,r,i))),i-=a})),o},t.prototype.detach=function(){this.children.forEach((function(e){e.detach()})),e.prototype.detach.call(this)},t.prototype.formatAt=function(e,t,n,r){this.children.forEachAt(e,t,(function(e,t,o){e.formatAt(t,o,n,r)}))},t.prototype.insertAt=function(e,t,n){var r=this.children.find(e),o=r[0],i=r[1];if(o)o.insertAt(i,t,n);else{var a=null==n?s.create("text",t):s.create(t,n);this.appendChild(a)}},t.prototype.insertBefore=function(e,t){if(null!=this.statics.allowedChildren&&!this.statics.allowedChildren.some((function(t){return e instanceof t})))throw new s.ParchmentError("Cannot insert ".concat(e.statics.blotName," into ").concat(this.statics.blotName));e.insertInto(this,t)},t.prototype.length=function(){return this.children.reduce((function(e,t){return e+t.length()}),0)},t.prototype.moveChildren=function(e,t){this.children.forEach((function(n){e.insertBefore(n,t)}))},t.prototype.optimize=function(t){if(e.prototype.optimize.call(this,t),0===this.children.length)if(null!=this.statics.defaultChild){var n=s.create(this.statics.defaultChild);this.appendChild(n),n.optimize(t)}else this.remove()},t.prototype.path=function(e,n){void 0===n&&(n=!1);var r=this.children.find(e,n),o=r[0],i=r[1],a=[[this,e]];return o instanceof t?a.concat(o.path(i,n)):(null!=o&&a.push([o,i]),a)},t.prototype.removeChild=function(e){this.children.remove(e)},t.prototype.replace=function(n){n instanceof t&&n.moveChildren(this),e.prototype.replace.call(this,n)},t.prototype.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=this.clone();return this.parent.insertBefore(n,this.next),this.children.forEachAt(e,this.length(),(function(e,r,o){e=e.split(r,t),n.appendChild(e)})),n},t.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},t.prototype.update=function(e,t){var n=this,r=[],o=[];e.forEach((function(e){e.target===n.domNode&&"childList"===e.type&&(r.push.apply(r,e.addedNodes),o.push.apply(o,e.removedNodes))})),o.forEach((function(e){if(!(null!=e.parentNode&&"IFRAME"!==e.tagName&&document.body.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var t=s.find(e);null!=t&&(null!=t.domNode.parentNode&&t.domNode.parentNode!==n.domNode||t.detach())}})),r.filter((function(e){return e.parentNode==n.domNode})).sort((function(e,t){return e===t?0:e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1})).forEach((function(e){var t=null;null!=e.nextSibling&&(t=s.find(e.nextSibling));var r=c(e);r.next==t&&null!=r.next||(null!=r.parent&&r.parent.removeChild(n),n.insertBefore(r,t||void 0))}))},t}(a.default);function c(e){var t=s.find(e);if(null==t)try{t=s.create(e)}catch(n){t=s.create(s.Scope.INLINE),[].slice.call(e.childNodes).forEach((function(e){t.domNode.appendChild(e)})),e.parentNode&&e.parentNode.replaceChild(t.domNode,e),t.attach()}return t}t.default=l},8656:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(9588),a=n(1024),s=n(2212),l=n(6788),c=function(e){function t(t){var n=e.call(this,t)||this;return n.attributes=new a.default(n.domNode),n}return o(t,e),t.formats=function(e){return"string"==typeof this.tagName||(Array.isArray(this.tagName)?e.tagName.toLowerCase():void 0)},t.prototype.format=function(e,t){var n=l.query(e);n instanceof i.default?this.attributes.attribute(n,t):t&&(null==n||e===this.statics.blotName&&this.formats()[e]===t||this.replaceWith(e,t))},t.prototype.formats=function(){var e=this.attributes.values(),t=this.statics.formats(this.domNode);return null!=t&&(e[this.statics.blotName]=t),e},t.prototype.replaceWith=function(t,n){var r=e.prototype.replaceWith.call(this,t,n);return this.attributes.copy(r),r},t.prototype.update=function(t,n){var r=this;e.prototype.update.call(this,t,n),t.some((function(e){return e.target===r.domNode&&"attributes"===e.type}))&&this.attributes.build()},t.prototype.wrap=function(n,r){var o=e.prototype.wrap.call(this,n,r);return o instanceof t&&o.statics.scope===this.statics.scope&&this.attributes.move(o),o},t}(s.default);t.default=c},4184:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(4356),a=n(6788),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.value=function(e){return!0},t.prototype.index=function(e,t){return this.domNode===e||this.domNode.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(t,1):-1},t.prototype.position=function(e,t){var n=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return e>0&&(n+=1),[this.parent.domNode,n]},t.prototype.value=function(){var e;return(e={})[this.statics.blotName]=this.statics.value(this.domNode)||!0,e},t.scope=a.Scope.INLINE_BLOT,t}(i.default);t.default=s},4356:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(6788),o=function(){function e(e){this.domNode=e,this.domNode[r.DATA_KEY]={blot:this}}return Object.defineProperty(e.prototype,"statics",{get:function(){return this.constructor},enumerable:!1,configurable:!0}),e.create=function(e){if(null==this.tagName)throw new r.ParchmentError("Blot definition missing tagName");var t;return Array.isArray(this.tagName)?("string"==typeof e&&(e=e.toUpperCase(),parseInt(e).toString()===e&&(e=parseInt(e))),t="number"==typeof e?document.createElement(this.tagName[e-1]):this.tagName.indexOf(e)>-1?document.createElement(e):document.createElement(this.tagName[0])):t=document.createElement(this.tagName),this.className&&t.classList.add(this.className),t},e.prototype.attach=function(){null!=this.parent&&(this.scroll=this.parent.scroll)},e.prototype.clone=function(){var e=this.domNode.cloneNode(!1);return r.create(e)},e.prototype.detach=function(){null!=this.parent&&this.parent.removeChild(this),delete this.domNode[r.DATA_KEY]},e.prototype.deleteAt=function(e,t){this.isolate(e,t).remove()},e.prototype.formatAt=function(e,t,n,o){var i=this.isolate(e,t);if(null!=r.query(n,r.Scope.BLOT)&&o)i.wrap(n,o);else if(null!=r.query(n,r.Scope.ATTRIBUTE)){var a=r.create(this.statics.scope);i.wrap(a),a.format(n,o)}},e.prototype.insertAt=function(e,t,n){var o=null==n?r.create("text",t):r.create(t,n),i=this.split(e);this.parent.insertBefore(o,i)},e.prototype.insertInto=function(e,t){void 0===t&&(t=null),null!=this.parent&&this.parent.children.remove(this);var n=null;e.children.insertBefore(this,t),null!=t&&(n=t.domNode),this.domNode.parentNode==e.domNode&&this.domNode.nextSibling==n||e.domNode.insertBefore(this.domNode,n),this.parent=e,this.attach()},e.prototype.isolate=function(e,t){var n=this.split(e);return n.split(t),n},e.prototype.length=function(){return 1},e.prototype.offset=function(e){return void 0===e&&(e=this.parent),null==this.parent||this==e?0:this.parent.children.offset(this)+this.parent.offset(e)},e.prototype.optimize=function(e){null!=this.domNode[r.DATA_KEY]&&delete this.domNode[r.DATA_KEY].mutations},e.prototype.remove=function(){null!=this.domNode.parentNode&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},e.prototype.replace=function(e){null!=e.parent&&(e.parent.insertBefore(this,e.next),e.remove())},e.prototype.replaceWith=function(e,t){var n="string"==typeof e?r.create(e,t):e;return n.replace(this),n},e.prototype.split=function(e,t){return 0===e?this:this.next},e.prototype.update=function(e,t){},e.prototype.wrap=function(e,t){var n="string"==typeof e?r.create(e,t):e;return null!=this.parent&&this.parent.insertBefore(n,this.next),n.appendChild(this),n},e.blotName="abstract",e}();t.default=o},8040:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(8656),a=n(6788),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.formats=function(n){var r=a.query(t.blotName).tagName;if(n.tagName!==r)return e.formats.call(this,n)},t.prototype.format=function(n,r){null!=a.query(n,a.Scope.BLOCK)&&(n!==this.statics.blotName||r?e.prototype.format.call(this,n,r):this.replaceWith(t.blotName))},t.prototype.formatAt=function(t,n,r,o){null!=a.query(r,a.Scope.BLOCK)?this.format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.insertAt=function(t,n,r){if(null==r||null!=a.query(n,a.Scope.INLINE))e.prototype.insertAt.call(this,t,n,r);else{var o=this.split(t),i=a.create(n,r);o.parent.insertBefore(i,o)}},t.prototype.update=function(t,n){navigator.userAgent.match(/Trident/)?this.build():e.prototype.update.call(this,t,n)},t.blotName="block",t.scope=a.Scope.BLOCK_BLOT,t.tagName="P",t}(i.default);t.default=s},6356:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.formats=function(e){},t.prototype.format=function(t,n){e.prototype.formatAt.call(this,0,this.length(),t,n)},t.prototype.formatAt=function(t,n,r,o){0===t&&n===this.length()?this.format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.formats=function(){return this.statics.formats(this.domNode)},t}(n(4184).default);t.default=i},6324:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(8656),a=n(6788),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.formats=function(n){if(n.tagName!==t.tagName)return e.formats.call(this,n)},t.prototype.format=function(n,r){var o=this;n!==this.statics.blotName||r?e.prototype.format.call(this,n,r):(this.children.forEach((function(e){e instanceof i.default||(e=e.wrap(t.blotName,!0)),o.attributes.copy(e)})),this.unwrap())},t.prototype.formatAt=function(t,n,r,o){null!=this.formats()[r]||a.query(r,a.Scope.ATTRIBUTE)?this.isolate(t,n).format(r,o):e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.optimize=function(n){e.prototype.optimize.call(this,n);var r=this.formats();if(0===Object.keys(r).length)return this.unwrap();var o=this.next;o instanceof t&&o.prev===this&&function(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}(r,o.formats())&&(o.moveChildren(this),o.remove())},t.blotName="inline",t.scope=a.Scope.INLINE_BLOT,t.tagName="SPAN",t}(i.default);t.default=s},560:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(2212),a=n(6788),s={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},l=function(e){function t(t){var n=e.call(this,t)||this;return n.scroll=n,n.observer=new MutationObserver((function(e){n.update(e)})),n.observer.observe(n.domNode,s),n.attach(),n}return o(t,e),t.prototype.detach=function(){e.prototype.detach.call(this),this.observer.disconnect()},t.prototype.deleteAt=function(t,n){this.update(),0===t&&n===this.length()?this.children.forEach((function(e){e.remove()})):e.prototype.deleteAt.call(this,t,n)},t.prototype.formatAt=function(t,n,r,o){this.update(),e.prototype.formatAt.call(this,t,n,r,o)},t.prototype.insertAt=function(t,n,r){this.update(),e.prototype.insertAt.call(this,t,n,r)},t.prototype.optimize=function(t,n){var r=this;void 0===t&&(t=[]),void 0===n&&(n={}),e.prototype.optimize.call(this,n);for(var o=[].slice.call(this.observer.takeRecords());o.length>0;)t.push(o.pop());for(var s=function(e,t){void 0===t&&(t=!0),null!=e&&e!==r&&null!=e.domNode.parentNode&&(null==e.domNode[a.DATA_KEY].mutations&&(e.domNode[a.DATA_KEY].mutations=[]),t&&s(e.parent))},l=function(e){null!=e.domNode[a.DATA_KEY]&&null!=e.domNode[a.DATA_KEY].mutations&&(e instanceof i.default&&e.children.forEach(l),e.optimize(n))},c=t,p=0;c.length>0;p+=1){if(p>=100)throw new Error("[Parchment] Maximum optimize iterations reached");for(c.forEach((function(e){var t=a.find(e.target,!0);null!=t&&(t.domNode===e.target&&("childList"===e.type?(s(a.find(e.previousSibling,!1)),[].forEach.call(e.addedNodes,(function(e){var t=a.find(e,!1);s(t,!1),t instanceof i.default&&t.children.forEach((function(e){s(e,!1)}))}))):"attributes"===e.type&&s(t.prev)),s(t))})),this.children.forEach(l),o=(c=[].slice.call(this.observer.takeRecords())).slice();o.length>0;)t.push(o.pop())}},t.prototype.update=function(t,n){var r=this;void 0===n&&(n={}),(t=t||this.observer.takeRecords()).map((function(e){var t=a.find(e.target,!0);return null==t?null:null==t.domNode[a.DATA_KEY].mutations?(t.domNode[a.DATA_KEY].mutations=[e],t):(t.domNode[a.DATA_KEY].mutations.push(e),null)})).forEach((function(e){null!=e&&e!==r&&null!=e.domNode[a.DATA_KEY]&&e.update(e.domNode[a.DATA_KEY].mutations||[],n)})),null!=this.domNode[a.DATA_KEY].mutations&&e.prototype.update.call(this,this.domNode[a.DATA_KEY].mutations,n),this.optimize(t,n)},t.blotName="scroll",t.defaultChild="block",t.scope=a.Scope.BLOCK_BLOT,t.tagName="DIV",t}(i.default);t.default=l},5192:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(4184),a=n(6788),s=function(e){function t(t){var n=e.call(this,t)||this;return n.text=n.statics.value(n.domNode),n}return o(t,e),t.create=function(e){return document.createTextNode(e)},t.value=function(e){var t=e.data;return t.normalize&&(t=t.normalize()),t},t.prototype.deleteAt=function(e,t){this.domNode.data=this.text=this.text.slice(0,e)+this.text.slice(e+t)},t.prototype.index=function(e,t){return this.domNode===e?t:-1},t.prototype.insertAt=function(t,n,r){null==r?(this.text=this.text.slice(0,t)+n+this.text.slice(t),this.domNode.data=this.text):e.prototype.insertAt.call(this,t,n,r)},t.prototype.length=function(){return this.text.length},t.prototype.optimize=function(n){e.prototype.optimize.call(this,n),this.text=this.statics.value(this.domNode),0===this.text.length?this.remove():this.next instanceof t&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},t.prototype.position=function(e,t){return void 0===t&&(t=!1),[this.domNode,e]},t.prototype.split=function(e,t){if(void 0===t&&(t=!1),!t){if(0===e)return this;if(e===this.length())return this.next}var n=a.create(this.domNode.splitText(e));return this.parent.insertBefore(n,this.next),this.text=this.statics.value(this.domNode),n},t.prototype.update=function(e,t){var n=this;e.some((function(e){return"characterData"===e.type&&e.target===n.domNode}))&&(this.text=this.statics.value(this.domNode))},t.prototype.value=function(){return this.text},t.blotName="text",t.scope=a.Scope.INLINE_BLOT,t}(i.default);t.default=s},6844:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.head=this.tail=null,this.length=0}return e.prototype.append=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.insertBefore(e[0],null),e.length>1&&this.append.apply(this,e.slice(1))},e.prototype.contains=function(e){for(var t,n=this.iterator();t=n();)if(t===e)return!0;return!1},e.prototype.insertBefore=function(e,t){e&&(e.next=t,null!=t?(e.prev=t.prev,null!=t.prev&&(t.prev.next=e),t.prev=e,t===this.head&&(this.head=e)):null!=this.tail?(this.tail.next=e,e.prev=this.tail,this.tail=e):(e.prev=null,this.head=this.tail=e),this.length+=1)},e.prototype.offset=function(e){for(var t=0,n=this.head;null!=n;){if(n===e)return t;t+=n.length(),n=n.next}return-1},e.prototype.remove=function(e){this.contains(e)&&(null!=e.prev&&(e.prev.next=e.next),null!=e.next&&(e.next.prev=e.prev),e===this.head&&(this.head=e.next),e===this.tail&&(this.tail=e.prev),this.length-=1)},e.prototype.iterator=function(e){return void 0===e&&(e=this.head),function(){var t=e;return null!=e&&(e=e.next),t}},e.prototype.find=function(e,t){void 0===t&&(t=!1);for(var n,r=this.iterator();n=r();){var o=n.length();if(e<o||t&&e===o&&(null==n.next||0!==n.next.length()))return[n,e];e-=o}return[null,0]},e.prototype.forEach=function(e){for(var t,n=this.iterator();t=n();)e(t)},e.prototype.forEachAt=function(e,t,n){if(!(t<=0))for(var r,o=this.find(e),i=o[0],a=e-o[1],s=this.iterator(i);(r=s())&&a<e+t;){var l=r.length();e>a?n(r,e-a,Math.min(t,a+l-e)):n(r,0,Math.min(l,e+t-a)),a+=l}},e.prototype.map=function(e){return this.reduce((function(t,n){return t.push(e(n)),t}),[])},e.prototype.reduce=function(e,t){for(var n,r=this.iterator();n=r();)t=e(t,n);return t},e}();t.default=n},6688:(e,t,n)=>{"use strict";var r=n(2212),o=n(8656),i=n(4184),a=n(560),s=n(6324),l=n(8040),c=n(6356),p=n(5192),u=n(9588),d=n(9371),f=n(3800),h=n(1024),m=n(6788),y={Scope:m.Scope,create:m.create,find:m.find,query:m.query,register:m.register,Container:r.default,Format:o.default,Leaf:i.default,Embed:c.default,Scroll:a.default,Block:l.default,Inline:s.default,Text:p.default,Attributor:{Attribute:u.default,Class:d.default,Style:f.default,Store:h.default}};t.c=y},6788:function(e,t){"use strict";var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.register=t.query=t.find=t.create=t.Scope=t.DATA_KEY=t.ParchmentError=void 0;var o=function(e){function t(t){var n=this;return t="[Parchment] "+t,(n=e.call(this,t)||this).message=t,n.name=n.constructor.name,n}return r(t,e),t}(Error);t.ParchmentError=o;var i,a={},s={},l={},c={};function p(e,t){var n;if(void 0===t&&(t=i.ANY),"string"==typeof e)n=c[e]||a[e];else if(e instanceof Text||e.nodeType===Node.TEXT_NODE)n=c.text;else if("number"==typeof e)e&i.LEVEL&i.BLOCK?n=c.block:e&i.LEVEL&i.INLINE&&(n=c.inline);else if(e instanceof HTMLElement){var r=(e.getAttribute("class")||"").split(/\s+/);for(var o in r)if(n=s[r[o]])break;n=n||l[e.tagName]}return null==n?null:t&i.LEVEL&n.scope&&t&i.TYPE&n.scope?n:null}t.DATA_KEY="__blot",function(e){e[e.TYPE=3]="TYPE",e[e.LEVEL=12]="LEVEL",e[e.ATTRIBUTE=13]="ATTRIBUTE",e[e.BLOT=14]="BLOT",e[e.INLINE=7]="INLINE",e[e.BLOCK=11]="BLOCK",e[e.BLOCK_BLOT=10]="BLOCK_BLOT",e[e.INLINE_BLOT=6]="INLINE_BLOT",e[e.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",e[e.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",e[e.ANY=15]="ANY"}(i||(t.Scope=i={})),t.create=function(e,t){var n=p(e);if(null==n)throw new o("Unable to create ".concat(e," blot"));var r=n,i=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:r.create(t);return new r(i,t)},t.find=function e(n,r){return void 0===r&&(r=!1),null==n?null:null!=n[t.DATA_KEY]?n[t.DATA_KEY].blot:r?e(n.parentNode,r):null},t.query=p,t.register=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(t.length>1)return t.map((function(t){return e(t)}));var r=t[0];if("string"!=typeof r.blotName&&"string"!=typeof r.attrName)throw new o("Invalid definition");if("abstract"===r.blotName)throw new o("Cannot register abstract class");if(c[r.blotName||r.attrName]=r,"string"==typeof r.keyName)a[r.keyName]=r;else if(null!=r.className&&(s[r.className]=r),null!=r.tagName){Array.isArray(r.tagName)?r.tagName=r.tagName.map((function(e){return e.toUpperCase()})):r.tagName=r.tagName.toUpperCase();var i=Array.isArray(r.tagName)?r.tagName:[r.tagName];i.forEach((function(e){null!=l[e]&&null!=r.className||(l[e]=r)}))}return r}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var o={};return(()=>{"use strict";r.r(o),r.d(o,{default:()=>Vo});var e=r(6688),t=(r(6620),r(3292)),n=r.n(t),i=r(9772),a=r.n(i),s=r(136),l=r.n(s);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==c(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}function d(){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(o);if(i){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function s(){return p(this,s),a.apply(this,arguments)}return t=s,r=[{key:"value",value:function(){}}],(n=[{key:"insertInto",value:function(e,t){0===e.children.length?d(y(s.prototype),"insertInto",this).call(this,e,t):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}])&&u(t.prototype,n),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(e.c.Embed);b.blotName="break",b.tagName="BR";const g=b;function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){return(T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(e,t){if(t&&("object"===v(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&T(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=x(n);if(r){var o=x(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return O(this,e)});function i(){return C(this,i),o.apply(this,arguments)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(e.c.Text);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==k(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===k(o)?o:String(o)),r)}var o}function j(){return(j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=I(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function I(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=R(e)););return e}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function A(e,t){if(t&&("object"===k(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w(e,t)}(l,t);var n,r,o,i,a,s=(i=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(i);if(a){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return A(this,e)});function l(){return P(this,l),s.apply(this,arguments)}return n=l,o=[{key:"compare",value:function(e,t){var n=l.order.indexOf(e),r=l.order.indexOf(t);return n>=0||r>=0?n-r:e===t?0:e<t?-1:1}}],(r=[{key:"formatAt",value:function(t,n,r,o){if(l.compare(this.statics.blotName,r)<0&&e.c.query(r,e.c.Scope.BLOT)){var i=this.isolate(t,n);o&&i.wrap(r,o)}else j(R(l.prototype),"formatAt",this).call(this,t,n,r,o)}},{key:"optimize",value:function(e){if(j(R(l.prototype),"optimize",this).call(this,e),this.parent instanceof l&&l.compare(this.statics.blotName,this.parent.statics.blotName)>0){var t=this.parent.isolate(this.offset(),this.length());this.moveChildren(t),t.wrap(this)}}}])&&E(n.prototype,r),o&&E(n,o),Object.defineProperty(n,"prototype",{writable:!1}),l}(e.c.Inline);D.allowedChildren=[D,e.c.Embed,S],D.order=["cursor","inline","underline","strike","italic","bold","script","link","code"];const _=D;function N(e){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==N(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==N(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===N(o)?o:String(o)),r)}var o}function L(e,t,n){return t&&B(e.prototype,t),n&&B(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function F(){return(F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=H(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function H(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=V(e)););return e}function U(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");var n,r;e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(n=e,r=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,r))}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=V(e);if(t){var o=V(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return K(this,n)}}function K(e,t){if(t&&("object"===N(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function V(e){return(V=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var W=function(t){U(o,t);var r=z(o);function o(){return M(this,o),r.apply(this,arguments)}return L(o,[{key:"attach",value:function(){F(V(o.prototype),"attach",this).call(this),this.attributes=new e.c.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return(new(n())).insert(this.value(),l()(this.formats(),this.attributes.values()))}},{key:"format",value:function(t,n){var r=e.c.query(t,e.c.Scope.BLOCK_ATTRIBUTE);null!=r&&this.attributes.attribute(r,n)}},{key:"formatAt",value:function(e,t,n,r){this.format(n,r)}},{key:"insertAt",value:function(t,n,r){if("string"==typeof n&&n.endsWith("\n")){var i=e.c.create(q.blotName);this.parent.insertBefore(i,0===t?this:this.next),i.insertAt(0,n.slice(0,-1))}else F(V(o.prototype),"insertAt",this).call(this,t,n,r)}}]),o}(e.c.Embed);W.scope=e.c.Scope.BLOCK_BLOT;var q=function(t){U(o,t);var r=z(o);function o(e){var t;return M(this,o),(t=r.call(this,e)).cache={},t}return L(o,[{key:"delta",value:function(){return null==this.cache.delta&&(this.cache.delta=this.descendants(e.c.Leaf).reduce((function(e,t){return 0===t.length()?e:e.insert(t.value(),Q(t))}),new(n())).insert("\n",Q(this))),this.cache.delta}},{key:"deleteAt",value:function(e,t){F(V(o.prototype),"deleteAt",this).call(this,e,t),this.cache={}}},{key:"formatAt",value:function(t,n,r,i){n<=0||(e.c.query(r,e.c.Scope.BLOCK)?t+n===this.length()&&this.format(r,i):F(V(o.prototype),"formatAt",this).call(this,t,Math.min(n,this.length()-t-1),r,i),this.cache={})}},{key:"insertAt",value:function(e,t,n){if(null!=n)return F(V(o.prototype),"insertAt",this).call(this,e,t,n);if(0!==t.length){var r=t.split("\n"),i=r.shift();i.length>0&&(e<this.length()-1||null==this.children.tail?F(V(o.prototype),"insertAt",this).call(this,Math.min(e,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});var a=this;r.reduce((function(e,t){return(a=a.split(e,!0)).insertAt(0,t),t.length}),e+i.length)}}},{key:"insertBefore",value:function(e,t){var n=this.children.head;F(V(o.prototype),"insertBefore",this).call(this,e,t),n instanceof g&&n.remove(),this.cache={}}},{key:"length",value:function(){return null==this.cache.length&&(this.cache.length=F(V(o.prototype),"length",this).call(this)+1),this.cache.length}},{key:"moveChildren",value:function(e,t){F(V(o.prototype),"moveChildren",this).call(this,e,t),this.cache={}}},{key:"optimize",value:function(e){F(V(o.prototype),"optimize",this).call(this,e),this.cache={}}},{key:"path",value:function(e){return F(V(o.prototype),"path",this).call(this,e,!0)}},{key:"removeChild",value:function(e){F(V(o.prototype),"removeChild",this).call(this,e),this.cache={}}},{key:"split",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t&&(0===e||e>=this.length()-1)){var n=this.clone();return 0===e?(this.parent.insertBefore(n,this),this):(this.parent.insertBefore(n,this.next),n)}var r=F(V(o.prototype),"split",this).call(this,e,t);return this.cache={},r}}]),o}(e.c.Block);function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?t:("function"==typeof e.formats&&(t=l()(t,e.formats())),null==e.parent||"scroll"==e.parent.blotName||e.parent.statics.scope!==e.statics.scope?t:Q(e.parent,t))}function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $(){return($="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=X(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function X(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ie(e)););return e}function Z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==G(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==G(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===G(o)?o:String(o)),r)}var o}function ee(e,t,n){return t&&Z(e.prototype,t),n&&Z(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ne(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");var n,r;e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(n=e,r=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,r))}function re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie(e);if(t){var o=ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oe(this,n)}}function oe(e,t){if(t&&("object"===G(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}q.blotName="block",q.tagName="P",q.defaultChild="break",q.allowedChildren=[_,e.c.Embed,S];var ae=function(e){ne(n,e);var t=re(n);function n(){return te(this,n),t.apply(this,arguments)}return ee(n)}(_);ae.blotName="code",ae.tagName="CODE";var se=function(t){ne(o,t);var r=re(o);function o(){return te(this,o),r.apply(this,arguments)}return ee(o,[{key:"delta",value:function(){var e=this,t=this.domNode.textContent;return t.endsWith("\n")&&(t=t.slice(0,-1)),t.split("\n").reduce((function(t,n){return t.insert(n).insert("\n",e.formats())}),new(n()))}},{key:"format",value:function(e,t){if(e!==this.statics.blotName||!t){var n=Y(this.descendant(S,this.length()-1),1)[0];null!=n&&n.deleteAt(n.length()-1,1),$(ie(o.prototype),"format",this).call(this,e,t)}}},{key:"formatAt",value:function(t,n,r,i){if(0!==n&&null!=e.c.query(r,e.c.Scope.BLOCK)&&(r!==this.statics.blotName||i!==this.statics.formats(this.domNode))){var a=this.newlineIndex(t);if(!(a<0||a>=t+n)){var s=this.newlineIndex(t,!0)+1,l=a-s+1,c=this.isolate(s,l),p=c.next;c.format(r,i),p instanceof o&&p.formatAt(0,t-s+n-l,r,i)}}}},{key:"insertAt",value:function(e,t,n){if(null==n){var r=Y(this.descendant(S,e),2),o=r[0],i=r[1];o.insertAt(i,t)}}},{key:"length",value:function(){var e=this.domNode.textContent.length;return this.domNode.textContent.endsWith("\n")?e:e+1}},{key:"newlineIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return this.domNode.textContent.slice(0,e).lastIndexOf("\n");var n=this.domNode.textContent.slice(e).indexOf("\n");return n>-1?e+n:-1}},{key:"optimize",value:function(t){this.domNode.textContent.endsWith("\n")||this.appendChild(e.c.create("text","\n")),$(ie(o.prototype),"optimize",this).call(this,t);var n=this.next;null!=n&&n.prev===this&&n.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===n.statics.formats(n.domNode)&&(n.optimize(t),n.moveChildren(this),n.remove())}},{key:"replace",value:function(t){$(ie(o.prototype),"replace",this).call(this,t),[].slice.call(this.domNode.querySelectorAll("*")).forEach((function(t){var n=e.c.find(t);null==n?t.parentNode.removeChild(t):n instanceof e.c.Embed?n.remove():n.unwrap()}))}}],[{key:"create",value:function(e){var t=$(ie(o),"create",this).call(this,e);return t.setAttribute("spellcheck",!1),t}},{key:"formats",value:function(){return!0}}]),o}(q);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==le(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===le(o)?o:String(o)),r)}var o}function ue(){return(ue="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=de(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function de(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=me(e)););return e}function fe(e,t){return(fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function he(e,t){if(t&&("object"===le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}se.blotName="code-block",se.tagName="PRE",se.TAB="  ";var ye=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fe(e,t)}(l,t);var n,r,o,i,a,s=(i=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=me(i);if(a){var n=me(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return he(this,e)});function l(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(n=s.call(this,e)).selection=t,n.textNode=document.createTextNode(l.CONTENTS),n.domNode.appendChild(n.textNode),n._length=0,n}return n=l,o=[{key:"value",value:function(){}}],(r=[{key:"detach",value:function(){null!=this.parent&&this.parent.removeChild(this)}},{key:"format",value:function(t,n){if(0!==this._length)return ue(me(l.prototype),"format",this).call(this,t,n);for(var r=this,o=0;null!=r&&r.statics.scope!==e.c.Scope.BLOCK_BLOT;)o+=r.offset(r.parent),r=r.parent;null!=r&&(this._length=l.CONTENTS.length,r.optimize(),r.formatAt(o,l.CONTENTS.length,t,n),this._length=0)}},{key:"index",value:function(e,t){return e===this.textNode?0:ue(me(l.prototype),"index",this).call(this,e,t)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){ue(me(l.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!this.selection.composing&&null!=this.parent){var t,n,r,o=this.textNode,i=this.selection.getNativeRange();if(null!=i&&i.start.node===o&&i.end.node===o){var a=[o,i.start.offset,i.end.offset];t=a[0],n=a[1],r=a[2]}for(;null!=this.domNode.lastChild&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==l.CONTENTS){var s=this.textNode.data.split(l.CONTENTS).join("");this.next instanceof S?(t=this.next.domNode,this.next.insertAt(0,s),this.textNode.data=l.CONTENTS):(this.textNode.data=s,this.parent.insertBefore(e.c.create(this.textNode),this),this.textNode=document.createTextNode(l.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),null!=n){var c=(p=[n,r].map((function(e){return Math.max(0,Math.min(t.data.length,e-1))})),u=2,function(e){if(Array.isArray(e))return e}(p)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(p,u)||function(e,t){if(e){if("string"==typeof e)return ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ce(e,t):void 0}}(p,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return n=c[0],r=c[1],{startNode:t,startOffset:n,endNode:t,endOffset:r}}}var p,u}},{key:"update",value:function(e,t){var n=this;if(e.some((function(e){return"characterData"===e.type&&e.target===n.textNode}))){var r=this.restore();r&&(t.range=r)}}},{key:"value",value:function(){return""}}])&&pe(n.prototype,r),o&&pe(n,o),Object.defineProperty(n,"prototype",{writable:!1}),l}(e.c.Embed);ye.blotName="cursor",ye.className="ql-cursor",ye.tagName="span",ye.CONTENTS="\ufeff";const be=ye;var ge=r(3520),ve=r.n(ge),Ce=r(888),Te=r.n(Ce);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ke(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Pe(r.key),r)}}function Pe(e){var t=function(e,t){if("object"!==Oe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Oe(t)?t:String(t)}var Ee=/^[ -~]*$/;function je(e,t){return Object.keys(t).reduce((function(n,r){return null==e[r]||(t[r]===e[r]?n[r]=t[r]:Array.isArray(t[r])?t[r].indexOf(e[r])<0&&(n[r]=t[r].concat([e[r]])):n[r]=[t[r],e[r]]),n}),{})}const Ie=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.scroll=e,this.delta=this.getDelta()}var r,o;return r=t,(o=[{key:"applyDelta",value:function(t){var r=this,o=!1;this.scroll.update();var i=this.scroll.length();return this.scroll.batchStart(),(t=function(e){return e.reduce((function(e,t){if(1===t.insert){var n=ve()(t.attributes);return delete n.image,e.insert({image:t.attributes.image},n)}if(null==t.attributes||!0!==t.attributes.list&&!0!==t.attributes.bullet||((t=ve()(t)).attributes.list?t.attributes.list="ordered":(t.attributes.list="bullet",delete t.attributes.bullet)),"string"==typeof t.insert){var r=t.insert.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return e.insert(r,t.attributes)}return e.push(t)}),new(n()))}(t)).reduce((function(t,n){var s=n.retain||n.delete||n.insert.length||1,c=n.attributes||{};if(null!=n.insert){if("string"==typeof n.insert){var p=n.insert;p.endsWith("\n")&&o&&(o=!1,p=p.slice(0,-1)),t>=i&&!p.endsWith("\n")&&(o=!0),r.scroll.insertAt(t,p);var u=xe(r.scroll.line(t),2),d=u[0],f=u[1],h=l()({},Q(d));if(d instanceof q){var m=xe(d.descendant(e.c.Leaf,f),1)[0];h=l()(h,Q(m))}c=a().attributes.diff(h,c)||{}}else if("object"===Oe(n.insert)){var y=Object.keys(n.insert)[0];if(null==y)return t;r.scroll.insertAt(t,y,n.insert[y])}i+=s}return Object.keys(c).forEach((function(e){r.scroll.formatAt(t,s,e,c[e])})),t+s}),0),t.reduce((function(e,t){return"number"==typeof t.delete?(r.scroll.deleteAt(e,t.delete),e):e+(t.retain||t.insert.length||1)}),0),this.scroll.batchEnd(),this.update(t)}},{key:"deleteText",value:function(e,t){return this.scroll.deleteAt(e,t),this.update((new(n())).retain(e).delete(t))}},{key:"formatLine",value:function(e,t){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.scroll.update(),Object.keys(o).forEach((function(n){if(null==r.scroll.whitelist||r.scroll.whitelist[n]){var i=r.scroll.lines(e,Math.max(t,1)),a=t;i.forEach((function(t){var i=t.length();if(t instanceof se){var s=e-t.offset(r.scroll),l=t.newlineIndex(s+a)-s+1;t.formatAt(s,l,n,o[n])}else t.format(n,o[n]);a-=i}))}})),this.scroll.optimize(),this.update((new(n())).retain(e).retain(t,ve()(o)))}},{key:"formatText",value:function(e,t){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.keys(o).forEach((function(n){r.scroll.formatAt(e,t,n,o[n])})),this.update((new(n())).retain(e).retain(t,ve()(o)))}},{key:"getContents",value:function(e,t){return this.delta.slice(e,e+t)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce((function(e,t){return e.concat(t.delta())}),new(n()))}},{key:"getFormat",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],o=[];0===n?this.scroll.path(t).forEach((function(t){var n=xe(t,1)[0];n instanceof q?r.push(n):n instanceof e.c.Leaf&&o.push(n)})):(r=this.scroll.lines(t,n),o=this.scroll.descendants(e.c.Leaf,t,n));var i=[r,o].map((function(e){if(0===e.length)return{};for(var t=Q(e.shift());Object.keys(t).length>0;){var n=e.shift();if(null==n)return t;t=je(Q(n),t)}return t}));return l().apply(l(),i)}},{key:"getText",value:function(e,t){return this.getContents(e,t).filter((function(e){return"string"==typeof e.insert})).map((function(e){return e.insert})).join("")}},{key:"insertEmbed",value:function(e,t,r){return this.scroll.insertAt(e,t,r),this.update((new(n())).retain(e).insert(function(e,t,n){return(t=Pe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,r)))}},{key:"insertText",value:function(e,t){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),this.scroll.insertAt(e,t),Object.keys(o).forEach((function(n){r.scroll.formatAt(e,t.length,n,o[n])})),this.update((new(n())).retain(e).insert(t,ve()(o)))}},{key:"isBlank",value:function(){if(0==this.scroll.children.length)return!0;if(this.scroll.children.length>1)return!1;var e=this.scroll.children.head;return e.statics.blotName===q.blotName&&!(e.children.length>1)&&e.children.head instanceof g}},{key:"removeFormat",value:function(e,t){var r=this.getText(e,t),o=xe(this.scroll.line(e+t),2),i=o[0],a=o[1],s=0,l=new(n());null!=i&&(s=i instanceof se?i.newlineIndex(a)-a+1:i.length()-a,l=i.delta().slice(a,a+s-1).insert("\n"));var c=this.getContents(e,t+s).diff((new(n())).insert(r).concat(l)),p=(new(n())).retain(e).concat(c);return this.applyDelta(p)}},{key:"update",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this.delta;if(1===r.length&&"characterData"===r[0].type&&r[0].target.data.match(Ee)&&e.c.find(r[0].target)){var a=e.c.find(r[0].target),s=Q(a),l=a.offset(this.scroll),c=r[0].oldValue.replace(be.CONTENTS,""),p=(new(n())).insert(c),u=(new(n())).insert(a.value()),d=(new(n())).retain(l).concat(p.diff(u,o));t=d.reduce((function(e,t){return t.insert?e.insert(t.insert,s):e.push(t)}),new(n())),this.delta=i.compose(t)}else this.delta=this.getDelta(),t&&Te()(i.compose(t),this.delta)||(t=i.diff(this.delta,o));return t}}])&&ke(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();var we=r(8208),Ae=r.n(we),Re=["error","warn","log","info"],De="warn";function _e(e){if(Re.indexOf(e)<=Re.indexOf(De)){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];(t=console)[e].apply(t,r)}}function Ne(e){return Re.reduce((function(t,n){return t[n]=_e.bind(console,n,e),t}),{})}_e.level=Ne.level=function(e){De=e};const Me=Ne;function Be(e){return(Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Be(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Be(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Be(o)?o:String(o)),r)}var o}function Fe(){return(Fe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=He(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function He(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ke(e)););return e}function Ue(e,t){return(Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function ze(e,t){if(t&&("object"===Be(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ve=Me("quill:events");["selectionchange","mousedown","mouseup","click"].forEach((function(e){document.addEventListener(e,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];[].slice.call(document.querySelectorAll(".ql-container")).forEach((function(e){var n;e.__quill&&e.__quill.emitter&&(n=e.__quill.emitter).handleDOM.apply(n,t)}))}))}));var We=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ue(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ke(r);if(o){var n=Ke(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ze(this,e)});function a(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this)).listeners={},e.on("error",Ve.error),e}return t=a,(n=[{key:"emit",value:function(){Ve.log.apply(Ve,arguments),Fe(Ke(a.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(this.listeners[e.type]||[]).forEach((function(t){var r=t.node,o=t.handler;(e.target===r||r.contains(e.target))&&o.apply(void 0,[e].concat(n))}))}},{key:"listenDOM",value:function(e,t,n){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push({node:t,handler:n})}}])&&Le(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Ae());We.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},We.sources={API:"api",SILENT:"silent",USER:"user"};const qe=We;function Qe(e){return(Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Qe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Qe(o)?o:String(o)),r)}var o}function Ye(e,t,n){return t&&Ge(e.prototype,t),n&&Ge(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var $e=Ye((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Je(this,e),this.quill=t,this.options=n}));$e.DEFAULTS={};const Xe=$e;function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function et(e){return function(e){if(Array.isArray(e))return rt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||nt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||nt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){if(e){if("string"==typeof e)return rt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rt(e,t):void 0}}function rt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ot(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Ze(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ze(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ze(o)?o:String(o)),r)}var o}function it(e,t,n){return t&&ot(e.prototype,t),n&&ot(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function at(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var st=Me("quill:selection"),lt=it((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;at(this,e),this.index=t,this.length=n})),ct=function(){function t(n,r){var o=this;at(this,t),this.emitter=r,this.scroll=n,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=e.c.create("cursor",this),this.lastRange=this.savedRange=new lt(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,(function(){o.mouseDown||setTimeout(o.update.bind(o,qe.sources.USER),1)})),this.emitter.on(qe.events.EDITOR_CHANGE,(function(e,t){e===qe.events.TEXT_CHANGE&&t.length()>0&&o.update(qe.sources.SILENT)})),this.emitter.on(qe.events.SCROLL_BEFORE_UPDATE,(function(){if(o.hasFocus()){var e=o.getNativeRange();null!=e&&e.start.node!==o.cursor.textNode&&o.emitter.once(qe.events.SCROLL_UPDATE,(function(){try{o.setNativeRange(e.start.node,e.start.offset,e.end.node,e.end.offset)}catch(e){}}))}})),this.emitter.on(qe.events.SCROLL_OPTIMIZE,(function(e,t){if(t.range){var n=t.range,r=n.startNode,i=n.startOffset,a=n.endNode,s=n.endOffset;o.setNativeRange(r,i,a,s)}})),this.update(qe.sources.SILENT)}return it(t,[{key:"handleComposition",value:function(){var e=this;this.root.addEventListener("compositionstart",(function(){e.composing=!0})),this.root.addEventListener("compositionend",(function(){if(e.composing=!1,e.cursor.parent){var t=e.cursor.restore();if(!t)return;setTimeout((function(){e.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)}),1)}}))}},{key:"handleDragging",value:function(){var e=this;this.emitter.listenDOM("mousedown",document.body,(function(){e.mouseDown=!0})),this.emitter.listenDOM("mouseup",document.body,(function(){e.mouseDown=!1,e.update(qe.sources.USER)}))}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(t,n){if(null==this.scroll.whitelist||this.scroll.whitelist[t]){this.scroll.update();var r=this.getNativeRange();if(null!=r&&r.native.collapsed&&!e.c.query(t,e.c.Scope.BLOCK)){if(r.start.node!==this.cursor.textNode){var o=e.c.find(r.start.node,!1);if(null==o)return;if(o instanceof e.c.Leaf){var i=o.split(r.start.offset);o.parent.insertBefore(this.cursor,i)}else o.insertBefore(this.cursor,r.start.node);this.cursor.attach()}this.cursor.format(t,n),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.scroll.length();e=Math.min(e,n-1),t=Math.min(e+t,n-1)-e;var r,o=this.scroll.leaf(e),i=tt(o,2),a=i[0],s=i[1];if(null==a)return null;var l=a.position(s,!0),c=tt(l,2);r=c[0],s=c[1];var p=document.createRange();if(t>0){p.setStart(r,s);var u=this.scroll.leaf(e+t),d=tt(u,2);if(a=d[0],s=d[1],null==a)return null;var f=a.position(s,!0),h=tt(f,2);return r=h[0],s=h[1],p.setEnd(r,s),p.getBoundingClientRect()}var m,y="left";return r instanceof Text?(s<r.data.length?(p.setStart(r,s),p.setEnd(r,s+1)):(p.setStart(r,s-1),p.setEnd(r,s),y="right"),m=p.getBoundingClientRect()):(m=a.domNode.getBoundingClientRect(),s>0&&(y="right")),{bottom:m.top+m.height,height:m.height,left:m[y],right:m[y],top:m.top,width:0}}},{key:"getNativeRange",value:function(){var e=document.getSelection();if(null==e||e.rangeCount<=0)return null;var t=e.getRangeAt(0);if(null==t)return null;var n=this.normalizeNative(t);return st.info("getNativeRange",n),n}},{key:"getRange",value:function(){var e=this.getNativeRange();return null==e?[null,null]:[this.normalizedToRange(e),e]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(t){var n=this,r=[[t.start.node,t.start.offset]];t.native.collapsed||r.push([t.end.node,t.end.offset]);var o=r.map((function(t){var r=tt(t,2),o=r[0],i=r[1],a=e.c.find(o,!0),s=a.offset(n.scroll);return 0===i?s:a instanceof e.c.Container?s+a.length():s+a.index(o,i)})),i=Math.min(Math.max.apply(Math,et(o)),this.scroll.length()-1),a=Math.min.apply(Math,[i].concat(et(o)));return new lt(a,i-a)}},{key:"normalizeNative",value:function(e){if(!pt(this.root,e.startContainer)||!e.collapsed&&!pt(this.root,e.endContainer))return null;var t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach((function(e){for(var t=e.node,n=e.offset;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>n)t=t.childNodes[n],n=0;else{if(t.childNodes.length!==n)break;n=(t=t.lastChild)instanceof Text?t.data.length:t.childNodes.length+1}e.node=t,e.offset=n})),t}},{key:"rangeToNative",value:function(e){var t=this,n=e.collapsed?[e.index]:[e.index,e.index+e.length],r=[],o=this.scroll.length();return n.forEach((function(e,n){e=Math.min(o-1,e);var i,a=tt(t.scroll.leaf(e),2),s=a[0],l=a[1],c=tt(s.position(l,0!==n),2);i=c[0],l=c[1],r.push(i,l)})),r.length<2&&(r=r.concat(r)),r}},{key:"scrollIntoView",value:function(e){var t=this.lastRange;if(null!=t){var n=this.getBounds(t.index,t.length);if(null!=n){var r=this.scroll.length()-1,o=tt(this.scroll.line(Math.min(t.index,r)),1)[0],i=o;if(t.length>0&&(i=tt(this.scroll.line(Math.min(t.index+t.length,r)),1)[0]),null!=o&&null!=i){var a=e.getBoundingClientRect();n.top<a.top?e.scrollTop-=a.top-n.top:n.bottom>a.bottom&&(e.scrollTop+=n.bottom-a.bottom)}}}}},{key:"setNativeRange",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(st.info("setNativeRange",e,t,n,r),null==e||null!=this.root.parentNode&&null!=e.parentNode&&null!=n.parentNode){var i=document.getSelection();if(null!=i)if(null!=e){this.hasFocus()||this.root.focus();var a=(this.getNativeRange()||{}).native;if(null==a||o||e!==a.startContainer||t!==a.startOffset||n!==a.endContainer||r!==a.endOffset){"BR"==e.tagName&&(t=[].indexOf.call(e.parentNode.childNodes,e),e=e.parentNode),"BR"==n.tagName&&(r=[].indexOf.call(n.parentNode.childNodes,n),n=n.parentNode);var s=document.createRange();s.setStart(e,t),s.setEnd(n,r),i.removeAllRanges(),i.addRange(s)}}else i.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qe.sources.API;if("string"==typeof t&&(n=t,t=!1),st.info("setRange",e),null!=e){var r=this.rangeToNative(e);this.setNativeRange.apply(this,et(r).concat([t]))}else this.setNativeRange(null);this.update(n)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe.sources.USER,t=this.lastRange,n=this.getRange(),r=tt(n,2),o=r[0],i=r[1];if(this.lastRange=o,null!=this.lastRange&&(this.savedRange=this.lastRange),!Te()(t,this.lastRange)){var a;!this.composing&&null!=i&&i.native.collapsed&&i.start.node!==this.cursor.textNode&&this.cursor.restore();var s,l=[qe.events.SELECTION_CHANGE,ve()(this.lastRange),ve()(t),e];(a=this.emitter).emit.apply(a,[qe.events.EDITOR_CHANGE].concat(l)),e!==qe.sources.SILENT&&(s=this.emitter).emit.apply(s,l)}}}]),t}();function pt(e,t){try{t.parentNode}catch(e){return!1}return t instanceof Text&&(t=t.parentNode),e.contains(t)}function ut(e){return(ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==ut(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==ut(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===ut(o)?o:String(o)),r)}var o}var ft=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quill=t,this.options=n,this.modules={}}var t,n;return t=e,(n=[{key:"init",value:function(){var e=this;Object.keys(this.options.modules).forEach((function(t){null==e.modules[t]&&e.addModule(t)}))}},{key:"addModule",value:function(e){var t=this.quill.constructor.import("modules/".concat(e));return this.modules[e]=new t(this.quill,this.options.modules[e]||{}),this.modules[e]}}])&&dt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();ft.DEFAULTS={modules:{}},ft.themes={default:ft};const ht=ft;function mt(e){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t,n){return(t=Tt(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tt(r.key),r)}}function Tt(e){var t=function(e,t){if("object"!==mt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==mt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===mt(t)?t:String(t)}var Ot=Me("quill"),xt=function(){function t(n){var r=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(vt(this,t),this.options=St(n,o),this.container=this.options.container,null==this.container)return Ot.error("Invalid Quill container",n);this.options.debug&&t.debug(this.options.debug);var i=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new qe,this.scroll=e.c.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new Ie(this.scroll),this.selection=new ct(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(qe.events.EDITOR_CHANGE,(function(e){e===qe.events.TEXT_CHANGE&&r.root.classList.toggle("ql-blank",r.editor.isBlank())})),this.emitter.on(qe.events.SCROLL_UPDATE,(function(e,t){var n=r.selection.lastRange,o=n&&0===n.length?n.index:void 0;kt.call(r,(function(){return r.editor.update(null,t,o)}),e)}));var a=this.clipboard.convert("<div class='ql-editor' style=\"white-space: normal;\">".concat(i,"<p><br></p></div>"));this.setContents(a),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}var r,o,i;return r=t,i=[{key:"debug",value:function(e){!0===e&&(e="log"),Me.level(e)}},{key:"find",value:function(t){return t.__quill||e.c.find(t)}},{key:"import",value:function(e){return null==this.imports[e]&&Ot.error("Cannot import ".concat(e,". Are you sure it was registered?")),this.imports[e]}},{key:"register",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"!=typeof t){var i=t.attrName||t.blotName;"string"==typeof i?this.register("formats/"+i,t,n):Object.keys(t).forEach((function(e){r.register(e,t[e],n)}))}else null==this.imports[t]||o||Ot.warn("Overwriting ".concat(t," with"),n),this.imports[t]=n,(t.startsWith("blots/")||t.startsWith("formats/"))&&"abstract"!==n.blotName?e.c.register(n):t.startsWith("modules")&&"function"==typeof n.register&&n.register()}}],(o=[{key:"addContainer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e){var n=e;(e=document.createElement("div")).classList.add(n)}return this.container.insertBefore(e,t),e}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(e,t,n){var r=this,o=bt(Pt(e,t,n),4);return e=o[0],t=o[1],n=o[3],kt.call(this,(function(){return r.editor.deleteText(e,t)}),n,e,-1*t)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scroll.enable(e),this.container.classList.toggle("ql-disabled",!e)}},{key:"focus",value:function(){var e=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=e,this.scrollIntoView()}},{key:"format",value:function(t,r){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qe.sources.API;return kt.call(this,(function(){var i=o.getSelection(!0),a=new(n());if(null==i)return a;if(e.c.query(t,e.c.Scope.BLOCK))a=o.editor.formatLine(i.index,i.length,yt({},t,r));else{if(0===i.length)return o.selection.format(t,r),a;a=o.editor.formatText(i.index,i.length,yt({},t,r))}return o.setSelection(i,qe.sources.SILENT),a}),i)}},{key:"formatLine",value:function(e,t,n,r,o){var i,a=this,s=bt(Pt(e,t,n,r,o),4);return e=s[0],t=s[1],i=s[2],o=s[3],kt.call(this,(function(){return a.editor.formatLine(e,t,i)}),o,e,0)}},{key:"formatText",value:function(e,t,n,r,o){var i,a=this,s=bt(Pt(e,t,n,r,o),4);return e=s[0],t=s[1],i=s[2],o=s[3],kt.call(this,(function(){return a.editor.formatText(e,t,i)}),o,e,0)}},{key:"getBounds",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t="number"==typeof e?this.selection.getBounds(e,n):this.selection.getBounds(e.index,e.length);var r=this.container.getBoundingClientRect();return{bottom:t.bottom-r.top,height:t.height,left:t.left-r.left,right:t.right-r.left,top:t.top-r.top,width:t.width}}},{key:"getContents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e,n=Pt(e,t),r=bt(n,2);return e=r[0],t=r[1],this.editor.getContents(e,t)}},{key:"getFormat",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection(!0),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return"number"==typeof e?this.editor.getFormat(e,t):this.editor.getFormat(e.index,e.length)}},{key:"getIndex",value:function(e){return e.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(e){return this.scroll.leaf(e)}},{key:"getLine",value:function(e){return this.scroll.line(e)}},{key:"getLines",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE;return"number"!=typeof e?this.scroll.lines(e.index,e.length):this.scroll.lines(e,t)}},{key:"getModule",value:function(e){return this.theme.modules[e]}},{key:"getSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLength()-e,n=Pt(e,t),r=bt(n,2);return e=r[0],t=r[1],this.editor.getText(e,t)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(e,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.sources.API;return kt.call(this,(function(){return o.editor.insertEmbed(e,n,r)}),i,e)}},{key:"insertText",value:function(e,t,n,r,o){var i,a=this,s=bt(Pt(e,0,n,r,o),4);return e=s[0],i=s[2],o=s[3],kt.call(this,(function(){return a.editor.insertText(e,t,i)}),o,e,t.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(e,t,n){this.clipboard.dangerouslyPasteHTML(e,t,n)}},{key:"removeFormat",value:function(e,t,n){var r=this,o=bt(Pt(e,t,n),4);return e=o[0],t=o[1],n=o[3],kt.call(this,(function(){return r.editor.removeFormat(e,t)}),n,e)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe.sources.API;return kt.call(this,(function(){e=new(n())(e);var r=t.getLength(),o=t.editor.deleteText(0,r),i=t.editor.applyDelta(e),a=i.ops[i.ops.length-1];return null!=a&&"string"==typeof a.insert&&"\n"===a.insert[a.insert.length-1]&&(t.editor.deleteText(t.getLength()-1,1),i.delete(1)),o.compose(i)}),r)}},{key:"setSelection",value:function(e,n,r){if(null==e)this.selection.setRange(null,n||t.sources.API);else{var o=bt(Pt(e,n,r),4);e=o[0],n=o[1],r=o[3],this.selection.setRange(new lt(e,n),r),r!==qe.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe.sources.API,r=(new(n())).insert(e);return this.setContents(r,t)}},{key:"update",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qe.sources.USER,t=this.scroll.update(e);return this.selection.update(e),t}},{key:"updateContents",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:qe.sources.API;return kt.call(this,(function(){return e=new(n())(e),t.editor.applyDelta(e,r)}),r,!0)}}])&&Ct(r.prototype,o),i&&Ct(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();function St(e,t){if((t=l()(!0,{container:e,modules:{clipboard:!0,keyboard:!0,history:!0}},t)).theme&&t.theme!==xt.DEFAULTS.theme){if(t.theme=xt.import("themes/".concat(t.theme)),null==t.theme)throw new Error("Invalid theme ".concat(t.theme,". Did you register it?"))}else t.theme=ht;var n=l()(!0,{},t.theme.DEFAULTS);[n,t].forEach((function(e){e.modules=e.modules||{},Object.keys(e.modules).forEach((function(t){!0===e.modules[t]&&(e.modules[t]={})}))}));var r=Object.keys(n.modules).concat(Object.keys(t.modules)).reduce((function(e,t){var n=xt.import("modules/".concat(t));return null==n?Ot.error("Cannot load ".concat(t," module. Are you sure you registered it?")):e[t]=n.DEFAULTS||{},e}),{});return null!=t.modules&&t.modules.toolbar&&t.modules.toolbar.constructor!==Object&&(t.modules.toolbar={container:t.modules.toolbar}),t=l()(!0,{},xt.DEFAULTS,{modules:r},n,t),["bounds","container","scrollingContainer"].forEach((function(e){"string"==typeof t[e]&&(t[e]=document.querySelector(t[e]))})),t.modules=Object.keys(t.modules).reduce((function(e,n){return t.modules[n]&&(e[n]=t.modules[n]),e}),{}),t}function kt(e,t,r,o){if(this.options.strict&&!this.isEnabled()&&t===qe.sources.USER)return new(n());var i=null==r?null:this.getSelection(),a=this.editor.delta,s=e();if(null!=i&&(!0===r&&(r=i.index),null==o?i=Et(i,s,t):0!==o&&(i=Et(i,r,o,t)),this.setSelection(i,qe.sources.SILENT)),s.length()>0){var l,c,p=[qe.events.TEXT_CHANGE,s,a,t];(l=this.emitter).emit.apply(l,[qe.events.EDITOR_CHANGE].concat(p)),t!==qe.sources.SILENT&&(c=this.emitter).emit.apply(c,p)}return s}function Pt(e,t,n,r,o){var i={};return"number"==typeof e.index&&"number"==typeof e.length?"number"!=typeof t?(o=r,r=n,n=t,t=e.length,e=e.index):(t=e.length,e=e.index):"number"!=typeof t&&(o=r,r=n,n=t,t=0),"object"===mt(n)?(i=n,o=r):"string"==typeof n&&(null!=r?i[n]=r:o=n),[e,t,i,o=o||qe.sources.API]}function Et(e,t,r,o){if(null==e)return null;var i,a;if(t instanceof n()){var s=bt([e.index,e.index+e.length].map((function(e){return t.transformPosition(e,o!==qe.sources.USER)})),2);i=s[0],a=s[1]}else{var l=bt([e.index,e.index+e.length].map((function(e){return e<t||e===t&&o===qe.sources.USER?e:r>=0?e+r:Math.max(t,e+r)})),2);i=l[0],a=l[1]}return new lt(i,a-i)}function jt(e){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wt(e,t){return(wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function At(e,t){if(t&&("object"===jt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}xt.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},xt.events=qe.events,xt.sources=qe.sources,xt.version="undefined"==typeof QUILL_VERSION?"dev":QUILL_VERSION,xt.imports={delta:n(),parchment:e.c,"core/module":Xe,"core/theme":ht};var Dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wt(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rt(n);if(r){var o=Rt(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return At(this,e)});function i(){return It(this,i),o.apply(this,arguments)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(e.c.Container);Dt.allowedChildren=[q,W,Dt];const _t=Dt;function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Nt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Nt(o)?o:String(o)),r)}var o}function Bt(){return(Bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Lt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Lt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ut(e)););return e}function Ft(e,t){return(Ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Ht(e,t){if(t&&("object"===Nt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}const zt=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ft(e,t)}(s,t);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ut(o);if(i){var n=Ut(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Ht(this,e)});function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=a.call(this,e)).contentNode=document.createElement("span"),t.contentNode.setAttribute("contenteditable",!1),[].slice.call(t.domNode.childNodes).forEach((function(e){t.contentNode.appendChild(e)})),t.leftGuard=document.createTextNode("\ufeff"),t.rightGuard=document.createTextNode("\ufeff"),t.domNode.appendChild(t.leftGuard),t.domNode.appendChild(t.contentNode),t.domNode.appendChild(t.rightGuard),t}return n=s,(r=[{key:"index",value:function(e,t){return e===this.leftGuard?0:e===this.rightGuard?1:Bt(Ut(s.prototype),"index",this).call(this,e,t)}},{key:"restore",value:function(t){var n,r,o=t.data.split("\ufeff").join("");if(t===this.leftGuard)if(this.prev instanceof S){var i=this.prev.length();this.prev.insertAt(i,o),n={startNode:this.prev.domNode,startOffset:i+o.length}}else r=document.createTextNode(o),this.parent.insertBefore(e.c.create(r),this),n={startNode:r,startOffset:o.length};else t===this.rightGuard&&(this.next instanceof S?(this.next.insertAt(0,o),n={startNode:this.next.domNode,startOffset:o.length}):(r=document.createTextNode(o),this.parent.insertBefore(e.c.create(r),this.next),n={startNode:r,startOffset:o.length}));return t.data="\ufeff",n}},{key:"update",value:function(e,t){var n=this;e.forEach((function(e){if("characterData"===e.type&&(e.target===n.leftGuard||e.target===n.rightGuard)){var r=n.restore(e.target);r&&(t.range=r)}}))}}])&&Mt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.c.Embed);function Kt(e){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Kt(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Kt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Kt(o)?o:String(o)),r)}var o}function qt(){return(qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Qt(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Qt(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Jt(e)););return e}function Gt(e,t){return(Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Yt(e,t){if(t&&("object"===Kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Jt(e){return(Jt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gt(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Jt(r);if(o){var n=Jt(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Yt(this,e)});function a(){return Vt(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"value",value:function(e){var t=qt(Jt(a.prototype),"value",this).call(this,e);return t.startsWith("rgb(")?"#"+(t=t.replace(/^[^\d]+/,"").replace(/[^\d]+$/,"")).split(",").map((function(e){return("00"+parseInt(e).toString(16)).slice(-2)})).join(""):t}}])&&Wt(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(e.c.Attributor.Style),Xt=(new e.c.Attributor.Class("color","ql-color",{scope:e.c.Scope.INLINE}),new $t("color","color",{scope:e.c.Scope.INLINE})),Zt=(new e.c.Attributor.Class("background","ql-bg",{scope:e.c.Scope.INLINE}),new $t("background","background-color",{scope:e.c.Scope.INLINE}));function en(e){return(en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==en(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==en(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===en(o)?o:String(o)),r)}var o}function rn(){return(rn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=on(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function on(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ln(e)););return e}function an(e,t){return(an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function sn(e,t){if(t&&("object"===en(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ln(e){return(ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&an(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ln(o);if(i){var n=ln(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return sn(this,e)});function s(){return tn(this,s),a.apply(this,arguments)}return t=s,r=[{key:"create",value:function(){return rn(ln(s),"create",this).call(this)}},{key:"formats",value:function(){return!0}}],(n=[{key:"optimize",value:function(e){rn(ln(s.prototype),"optimize",this).call(this,e),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}])&&nn(t.prototype,n),r&&nn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(_);cn.blotName="bold",cn.tagName=["STRONG","B"];const pn=cn;function un(e){return(un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==un(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==un(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===un(o)?o:String(o)),r)}var o}function hn(){return(hn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=mn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function mn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gn(e)););return e}function yn(e,t){return(yn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function bn(e,t){if(t&&("object"===un(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gn(e){return(gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vn={scope:e.c.Scope.INLINE,whitelist:["serif","monospace"]},Cn=(new e.c.Attributor.Class("font","ql-font",vn),new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yn(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gn(r);if(o){var n=gn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return bn(this,e)});function a(){return dn(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"value",value:function(e){return hn(gn(a.prototype),"value",this).call(this,e).replace(/["']/g,"")}}])&&fn(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(e.c.Attributor.Style))("font","font-family",vn));function Tn(e){return(Tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function On(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xn(e,t){return(xn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Sn(e,t){if(t&&("object"===Tn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function kn(e){return(kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Pn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xn(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kn(n);if(r){var o=kn(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Sn(this,e)});function i(){return On(this,i),o.apply(this,arguments)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(pn);Pn.blotName="italic",Pn.tagName=["EM","I"];const En=Pn;function jn(e){return(jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function In(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==jn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===jn(o)?o:String(o)),r)}var o}function An(){return(An="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Rn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Rn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Nn(e)););return e}function Dn(e,t){return(Dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _n(e,t){if(t&&("object"===jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Nn(e){return(Nn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Mn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dn(e,t)}(s,e);var t,n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Nn(o);if(i){var n=Nn(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _n(this,e)});function s(){return In(this,s),a.apply(this,arguments)}return t=s,r=[{key:"create",value:function(e){var t=An(Nn(s),"create",this).call(this,e);return e=this.sanitize(e),t.setAttribute("href",e),t.setAttribute("rel","noopener noreferrer"),t.setAttribute("target","_blank"),t}},{key:"formats",value:function(e){return e.getAttribute("href")}},{key:"sanitize",value:function(e){return function(e,t){var n=document.createElement("a");n.href=e;var r=n.href.slice(0,n.href.indexOf(":"));return t.indexOf(r)>-1}(e,this.PROTOCOL_WHITELIST)?e:this.SANITIZED_URL}}],(n=[{key:"format",value:function(e,t){if(e!==this.statics.blotName||!t)return An(Nn(s.prototype),"format",this).call(this,e,t);t=this.constructor.sanitize(t),this.domNode.setAttribute("href",t)}}])&&wn(t.prototype,n),r&&wn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(_);function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Un(r.key),r)}}function Hn(e,t,n){return t&&Fn(e.prototype,t),n&&Fn(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Un(e){var t=function(e,t){if("object"!==Bn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Bn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Bn(t)?t:String(t)}function zn(){return(zn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Kn(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Kn(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qn(e)););return e}function Vn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");var n,r;e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(n=e,r=t,(Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(n,r))}function Wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Qn(e);if(t){var o=Qn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qn(this,n)}}function qn(e,t){if(t&&("object"===Bn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Qn(e){return(Qn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Mn.blotName="link",Mn.tagName="A",Mn.SANITIZED_URL="about:blank",Mn.PROTOCOL_WHITELIST=["http","https","mailto","tel"];var Gn=function(t){Vn(r,t);var n=Wn(r);function r(){return Ln(this,r),n.apply(this,arguments)}return Hn(r,[{key:"format",value:function(t,n){t!==Yn.blotName||n?zn(Qn(r.prototype),"format",this).call(this,t,n):this.replaceWith(e.c.create(this.statics.scope))}},{key:"remove",value:function(){null==this.prev&&null==this.next?this.parent.remove():zn(Qn(r.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(e,t){return this.parent.isolate(this.offset(this.parent),this.length()),e===this.parent.statics.blotName?(this.parent.replaceWith(e,t),this):(this.parent.unwrap(),zn(Qn(r.prototype),"replaceWith",this).call(this,e,t))}}],[{key:"formats",value:function(e){return e.tagName===this.tagName?void 0:zn(Qn(r),"formats",this).call(this,e)}}]),r}(q);Gn.blotName="list-item",Gn.tagName="LI";var Yn=function(t){Vn(r,t);var n=Wn(r);function r(t){var o;Ln(this,r),o=n.call(this,t);var i=function(n){if(n.target.parentNode===t){var r=o.statics.formats(t),i=e.c.find(n.target);"checked"===r?i.format("list","unchecked"):"unchecked"===r&&i.format("list","checked")}};return t.addEventListener("touchstart",i),t.addEventListener("mousedown",i),o}return Hn(r,[{key:"format",value:function(e,t){this.children.length>0&&this.children.tail.format(e,t)}},{key:"formats",value:function(){return e={},t=this.statics.blotName,n=this.statics.formats(this.domNode),(t=Un(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e;var e,t,n}},{key:"insertBefore",value:function(e,t){if(e instanceof Gn)zn(Qn(r.prototype),"insertBefore",this).call(this,e,t);else{var n=null==t?this.length():t.offset(this),o=this.split(n);o.parent.insertBefore(e,o)}}},{key:"optimize",value:function(e){zn(Qn(r.prototype),"optimize",this).call(this,e);var t=this.next;null!=t&&t.prev===this&&t.statics.blotName===this.statics.blotName&&t.domNode.tagName===this.domNode.tagName&&t.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(t.moveChildren(this),t.remove())}},{key:"replace",value:function(t){if(t.statics.blotName!==this.statics.blotName){var n=e.c.create(this.statics.defaultChild);t.moveChildren(n),this.appendChild(n)}zn(Qn(r.prototype),"replace",this).call(this,t)}}],[{key:"create",value:function(e){var t="ordered"===e?"OL":"UL",n=zn(Qn(r),"create",this).call(this,t);return"checked"!==e&&"unchecked"!==e||n.setAttribute("data-checked","checked"===e),n}},{key:"formats",value:function(e){return"OL"===e.tagName?"ordered":"UL"===e.tagName?e.hasAttribute("data-checked")?"true"===e.getAttribute("data-checked")?"checked":"unchecked":"bullet":void 0}}]),r}(_t);function Jn(e){return(Jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Jn(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Jn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Jn(o)?o:String(o)),r)}var o}function Zn(){return(Zn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=er(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function er(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rr(e)););return e}function tr(e,t){return(tr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function nr(e,t){if(t&&("object"===Jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function rr(e){return(rr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Yn.blotName="list",Yn.scope=e.c.Scope.BLOCK_BLOT,Yn.tagName=["OL","UL"],Yn.defaultChild="list-item",Yn.allowedChildren=[Gn];var or=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tr(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=rr(r);if(o){var n=rr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return nr(this,e)});function a(){return $n(this,a),i.apply(this,arguments)}return t=a,n=[{key:"create",value:function(e){return"super"===e?document.createElement("sup"):"sub"===e?document.createElement("sub"):Zn(rr(a),"create",this).call(this,e)}},{key:"formats",value:function(e){return"SUB"===e.tagName?"sub":"SUP"===e.tagName?"super":void 0}}],null&&Xn(t.prototype,null),n&&Xn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(_);or.blotName="script",or.tagName=["SUB","SUP"];const ir=or;new e.c.Attributor.Class("size","ql-size",{scope:e.c.Scope.INLINE,whitelist:["small","large","huge"]});var ar=new e.c.Attributor.Style("size","font-size",{scope:e.c.Scope.INLINE,whitelist:["10px","18px","32px"]});function sr(e){return(sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function cr(e,t){return(cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function pr(e,t){if(t&&("object"===sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cr(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ur(n);if(r){var o=ur(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return pr(this,e)});function i(){return lr(this,i),o.apply(this,arguments)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(_);dr.blotName="strike",dr.tagName="S";const fr=dr;function hr(e){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yr(e,t){return(yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function br(e,t){if(t&&("object"===hr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function gr(e){return(gr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var vr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yr(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gr(n);if(r){var o=gr(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return br(this,e)});function i(){return mr(this,i),o.apply(this,arguments)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(_);vr.blotName="underline",vr.tagName="U";const Cr=vr;var Tr={scope:e.c.Scope.BLOCK,whitelist:["right","center","justify"]},Or=new e.c.Attributor.Attribute("align","align",Tr),xr=(new e.c.Attributor.Class("align","ql-align",Tr),new e.c.Attributor.Style("align","text-align",Tr)),Sr={scope:e.c.Scope.BLOCK,whitelist:["rtl"]},kr=new e.c.Attributor.Attribute("direction","dir",Sr),Pr=(new e.c.Attributor.Class("direction","ql-direction",Sr),new e.c.Attributor.Style("direction","direction",Sr));function Er(e){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jr(e,t,n){return(t=Rr(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return wr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Rr(r.key),r)}}function Rr(e){var t=function(e,t){if("object"!==Er(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Er(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Er(t)?t:String(t)}function Dr(e,t){return(Dr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function _r(e,t){if(t&&("object"===Er(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Nr(e)}function Nr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mr(e){return(Mr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Br=Me("quill:clipboard"),Lr="__ql-matcher",Fr=[[Node.TEXT_NODE,function(e,t){var n=e.data;if("O:P"===e.parentNode.tagName)return t.insert(n.trim());if(0===n.trim().length&&e.parentNode.classList.contains("ql-clipboard"))return t;if(!Vr(e.parentNode).whiteSpace.startsWith("pre")){var r=function(e,t){return(t=t.replace(/[^\u00a0]/g,"")).length<1&&e?" ":t};n=(n=n.replace(/\r\n/g," ").replace(/\n/g," ")).replace(/\s\s+/g,r.bind(r,!0)),(null==e.previousSibling&&qr(e.parentNode)||null!=e.previousSibling&&qr(e.previousSibling))&&(n=n.replace(/^\s+/,r.bind(r,!1))),(null==e.nextSibling&&qr(e.parentNode)||null!=e.nextSibling&&qr(e.nextSibling))&&(n=n.replace(/\s+$/,r.bind(r,!1)))}return t.insert(n)}],[Node.TEXT_NODE,Gr],["br",function(e,t){return Wr(t,"\n")||t.insert("\n"),t}],[Node.ELEMENT_NODE,Gr],[Node.ELEMENT_NODE,function(t,r){var o=e.c.query(t);if(null==o)return r;if(o.prototype instanceof e.c.Embed){var i={},a=o.value(t);null!=a&&(i[o.blotName]=a,r=(new(n())).insert(i,o.formats(t)))}else"function"==typeof o.formats&&(r=Kr(r,o.blotName,o.formats(t)));return r}],[Node.ELEMENT_NODE,Yr],[Node.ELEMENT_NODE,function(t,n){var r=e.c.Attributor.Attribute.keys(t),o=e.c.Attributor.Class.keys(t),i=e.c.Attributor.Style.keys(t),a={};return r.concat(o).concat(i).forEach((function(n){var r=e.c.query(n,e.c.Scope.ATTRIBUTE);null!=r&&(a[r.attrName]=r.value(t),a[r.attrName])||(null==(r=Hr[n])||r.attrName!==n&&r.keyName!==n||(a[r.attrName]=r.value(t)||void 0),null==(r=Ur[n])||r.attrName!==n&&r.keyName!==n||(r=Ur[n],a[r.attrName]=r.value(t)||void 0))})),Object.keys(a).length>0&&(n=Kr(n,a)),n}],[Node.ELEMENT_NODE,function(e,t){var r={},o=e.style||{};return o.fontStyle&&"italic"===Vr(e).fontStyle&&(r.italic=!0),o.fontWeight&&(Vr(e).fontWeight.startsWith("bold")||parseInt(Vr(e).fontWeight)>=700)&&(r.bold=!0),Object.keys(r).length>0&&(t=Kr(t,r)),parseFloat(o.textIndent||0)>0&&(t=(new(n())).insert("\t").concat(t)),t}],["li",function(t,r){var o=e.c.query(t);if(null==o||"list-item"!==o.blotName||!Wr(r,"\n"))return r;for(var i=-1,a=t.parentNode;!a.classList.contains("ql-clipboard");)"list"===(e.c.query(a)||{}).blotName&&(i+=1),a=a.parentNode;return i<=0?r:r.compose((new(n())).retain(r.length()-1).retain(1,{indent:i}))}],["b",Qr.bind(Qr,"bold")],["i",Qr.bind(Qr,"italic")],["style",function(){return new(n())}]],Hr=[Or,kr].reduce((function(e,t){return e[t.keyName]=t,e}),{}),Ur=[xr,Zt,Xt,Pr,Cn,ar].reduce((function(e,t){return e[t.keyName]=t,e}),{}),zr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dr(e,t)}(s,e);var t,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mr(o);if(i){var n=Mr(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _r(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).quill.root.addEventListener("paste",n.onPaste.bind(Nr(n))),n.container=n.quill.addContainer("ql-clipboard"),n.container.setAttribute("contenteditable",!0),n.container.setAttribute("tabindex",-1),n.matchers=[],Fr.concat(n.options.matchers).forEach((function(e){var r=Ir(e,2),o=r[0],i=r[1];(t.matchVisual||i!==Yr)&&n.addMatcher(o,i)})),n}return t=s,(r=[{key:"addMatcher",value:function(e,t){this.matchers.push([e,t])}},{key:"convert",value:function(e){if("string"==typeof e)return this.container.innerHTML=e.replace(/\>\r?\n +\</g,"><"),this.convert();var t=this.quill.getFormat(this.quill.selection.savedRange.index);if(t[se.blotName]){var r=this.container.innerText;return this.container.innerHTML="",(new(n())).insert(r,jr({},se.blotName,t[se.blotName]))}var o=Ir(this.prepareMatching(),2),i=o[0],a=o[1],s=function e(t,r,o){return t.nodeType===t.TEXT_NODE?o.reduce((function(e,n){return n(t,e)}),new(n())):t.nodeType===t.ELEMENT_NODE?[].reduce.call(t.childNodes||[],(function(n,i){var a=e(i,r,o);return i.nodeType===t.ELEMENT_NODE&&(a=r.reduce((function(e,t){return t(i,e)}),a),a=(i[Lr]||[]).reduce((function(e,t){return t(i,e)}),a)),n.concat(a)}),new(n())):new(n())}(this.container,i,a);return Wr(s,"\n")&&null==s.ops[s.ops.length-1].attributes&&(s=s.compose((new(n())).retain(s.length()-1).delete(1))),Br.log("convert",this.container.innerHTML,s),this.container.innerHTML="",s}},{key:"dangerouslyPasteHTML",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xt.sources.API;if("string"==typeof e)this.quill.setContents(this.convert(e),t),this.quill.setSelection(0,xt.sources.SILENT);else{var o=this.convert(t);this.quill.updateContents((new(n())).retain(e).concat(o),r),this.quill.setSelection(e+o.length(),xt.sources.SILENT)}}},{key:"onPaste",value:function(e){var t=this;if(!e.defaultPrevented&&this.quill.isEnabled()){var r=this.quill.getSelection(),o=(new(n())).retain(r.index),i=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(xt.sources.SILENT),setTimeout((function(){o=o.concat(t.convert()).delete(r.length),t.quill.updateContents(o,xt.sources.USER),t.quill.setSelection(o.length()-r.length,xt.sources.SILENT),t.quill.scrollingContainer.scrollTop=i,t.quill.focus()}),1)}}},{key:"prepareMatching",value:function(){var e=this,t=[],n=[];return this.matchers.forEach((function(r){var o=Ir(r,2),i=o[0],a=o[1];switch(i){case Node.TEXT_NODE:n.push(a);break;case Node.ELEMENT_NODE:t.push(a);break;default:[].forEach.call(e.container.querySelectorAll(i),(function(e){e[Lr]=e[Lr]||[],e[Lr].push(a)}))}})),[t,n]}}])&&Ar(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),s}(Xe);function Kr(e,t,r){return"object"===Er(t)?Object.keys(t).reduce((function(e,n){return Kr(e,n,t[n])}),e):e.reduce((function(e,n){return n.attributes&&n.attributes[t]?e.push(n):e.insert(n.insert,l()({},jr({},t,r),n.attributes))}),new(n()))}function Vr(e){return e.nodeType!==Node.ELEMENT_NODE?{}:e["__ql-computed-style"]||(e["__ql-computed-style"]=window.getComputedStyle(e))}function Wr(e,t){for(var n="",r=e.ops.length-1;r>=0&&n.length<t.length;--r){var o=e.ops[r];if("string"!=typeof o.insert)break;n=o.insert+n}return n.slice(-1*t.length)===t}function qr(e){if(0===e.childNodes.length)return!1;var t=Vr(e);return["block","list-item"].indexOf(t.display)>-1}function Qr(e,t,n){return Kr(n,e,!0)}function Gr(e,t){return Wr(t,"\n")||(qr(e)||t.length()>0&&e.nextSibling&&qr(e.nextSibling))&&t.insert("\n"),t}function Yr(e,t){if(qr(e)&&null!=e.nextElementSibling&&!Wr(t,"\n\n")){var n=e.offsetHeight+parseFloat(Vr(e).marginTop)+parseFloat(Vr(e).marginBottom);e.nextElementSibling.offsetTop>e.offsetTop+1.5*n&&t.insert("\n")}return t}function Jr(e){return(Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Jr(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Jr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Jr(o)?o:String(o)),r)}var o}function Xr(e,t){return(Xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Zr(e,t){if(t&&("object"===Jr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return eo(e)}function eo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function to(e){return(to=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}zr.DEFAULTS={matchers:[],matchVisual:!0};var no=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xr(e,t)}(s,t);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=to(o);if(i){var n=to(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Zr(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e,t)).lastRecorded=0,n.ignoreChange=!1,n.clear(),n.quill.on(xt.events.EDITOR_CHANGE,(function(e,t,r,o){e!==xt.events.TEXT_CHANGE||n.ignoreChange||(n.options.userOnly&&o!==xt.sources.USER?n.transform(t):n.record(t,r))})),n.quill.keyboard.addBinding({key:"Z",shortKey:!0},n.undo.bind(eo(n))),n.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},n.redo.bind(eo(n))),/Win/i.test(navigator.platform)&&n.quill.keyboard.addBinding({key:"Y",shortKey:!0},n.redo.bind(eo(n))),n}return n=s,(r=[{key:"change",value:function(t,n){if(0!==this.stack[t].length){var r=this.stack[t].pop();this.stack[n].push(r),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(r[t],xt.sources.USER),this.ignoreChange=!1;var o=function(t){var n=t.reduce((function(e,t){return e+(t.delete||0)}),0),r=t.length()-n;return function(t){var n=t.ops[t.ops.length-1];return null!=n&&(null!=n.insert?"string"==typeof n.insert&&n.insert.endsWith("\n"):null!=n.attributes&&Object.keys(n.attributes).some((function(t){return null!=e.c.query(t,e.c.Scope.BLOCK)})))}(t)&&(r-=1),r}(r[t]);this.quill.setSelection(o)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(e,t){if(0!==e.ops.length){this.stack.redo=[];var n=this.quill.getContents().diff(t),r=Date.now();if(this.lastRecorded+this.options.delay>r&&this.stack.undo.length>0){var o=this.stack.undo.pop();n=n.compose(o.undo),e=o.redo.compose(e)}else this.lastRecorded=r;this.stack.undo.push({redo:e,undo:n}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(e){this.stack.undo.forEach((function(t){t.undo=e.transform(t.undo,!0),t.redo=e.transform(t.redo,!0)})),this.stack.redo.forEach((function(t){t.undo=e.transform(t.undo,!0),t.redo=e.transform(t.redo,!0)}))}},{key:"undo",value:function(){this.change("undo","redo")}}])&&$r(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(Xe);function ro(e,t,n){return(t=lo(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oo(e){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function io(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ao(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ao(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function so(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,lo(r.key),r)}}function lo(e){var t=function(e,t){if("object"!==oo(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==oo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===oo(t)?t:String(t)}function co(e,t){return(co=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function po(e,t){if(t&&("object"===oo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function uo(e){return(uo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}no.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};var fo=Me("quill:keyboard"),ho=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",mo=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&co(e,t)}(c,t);var n,r,o,i,a,s=(i=c,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=uo(i);if(a){var n=uo(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return po(this,e)});function c(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(n=s.call(this,e,t)).bindings={},Object.keys(n.options.bindings).forEach((function(t){("list autofill"!==t||null==e.scroll.whitelist||e.scroll.whitelist.list)&&n.options.bindings[t]&&n.addBinding(n.options.bindings[t])})),n.addBinding({key:c.keys.ENTER,shiftKey:null},Co),n.addBinding({key:c.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},(function(){})),/Firefox/i.test(navigator.userAgent)?(n.addBinding({key:c.keys.BACKSPACE},{collapsed:!0},bo),n.addBinding({key:c.keys.DELETE},{collapsed:!0},go)):(n.addBinding({key:c.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},bo),n.addBinding({key:c.keys.DELETE},{collapsed:!0,suffix:/^.?$/},go)),n.addBinding({key:c.keys.BACKSPACE},{collapsed:!1},vo),n.addBinding({key:c.keys.DELETE},{collapsed:!1},vo),n.addBinding({key:c.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},bo),n.listen(),n}return n=c,o=[{key:"match",value:function(e,t){return t=xo(t),!["altKey","ctrlKey","metaKey","shiftKey"].some((function(n){return!!t[n]!==e[n]&&null!==t[n]}))&&t.key===(e.which||e.keyCode)}}],(r=[{key:"addBinding",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=xo(e);if(null==r||null==r.key)return fo.warn("Attempted to add invalid keyboard binding",r);"function"==typeof t&&(t={handler:t}),"function"==typeof n&&(n={handler:n}),r=l()(r,t,n),this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)}},{key:"listen",value:function(){var t=this;this.quill.root.addEventListener("keydown",(function(n){if(!n.defaultPrevented){var r=n.which||n.keyCode,o=(t.bindings[r]||[]).filter((function(e){return c.match(n,e)}));if(0!==o.length){var i=t.quill.getSelection();if(null!=i&&t.quill.hasFocus()){var a=io(t.quill.getLine(i.index),2),s=a[0],l=a[1],p=io(t.quill.getLeaf(i.index),2),u=p[0],d=p[1],f=io(0===i.length?[u,d]:t.quill.getLeaf(i.index+i.length),2),h=f[0],m=f[1],y=u instanceof e.c.Text?u.value().slice(0,d):"",b=h instanceof e.c.Text?h.value().slice(m):"",g={collapsed:0===i.length,empty:0===i.length&&s.length()<=1,format:t.quill.getFormat(i),offset:l,prefix:y,suffix:b};o.some((function(e){if(null!=e.collapsed&&e.collapsed!==g.collapsed)return!1;if(null!=e.empty&&e.empty!==g.empty)return!1;if(null!=e.offset&&e.offset!==g.offset)return!1;if(Array.isArray(e.format)){if(e.format.every((function(e){return null==g.format[e]})))return!1}else if("object"===oo(e.format)&&!Object.keys(e.format).every((function(t){return!0===e.format[t]?null!=g.format[t]:!1===e.format[t]?null==g.format[t]:Te()(e.format[t],g.format[t])})))return!1;return!(null!=e.prefix&&!e.prefix.test(g.prefix)||null!=e.suffix&&!e.suffix.test(g.suffix)||!0===e.handler.call(t,i,g))}))&&n.preventDefault()}}}}))}}])&&so(n.prototype,r),o&&so(n,o),Object.defineProperty(n,"prototype",{writable:!1}),c}(Xe);function yo(t,n){var r,o=t===mo.keys.LEFT?"prefix":"suffix";return ro(r={key:t,shiftKey:n,altKey:null},o,/^$/),ro(r,"handler",(function(r){var o=r.index;return t===mo.keys.RIGHT&&(o+=r.length+1),!(io(this.quill.getLeaf(o),1)[0]instanceof e.c.Embed&&(t===mo.keys.LEFT?n?this.quill.setSelection(r.index-1,r.length+1,xt.sources.USER):this.quill.setSelection(r.index-1,xt.sources.USER):n?this.quill.setSelection(r.index,r.length+1,xt.sources.USER):this.quill.setSelection(r.index+r.length+1,xt.sources.USER),1))})),r}function bo(e,t){if(!(0===e.index||this.quill.getLength()<=1)){var n=io(this.quill.getLine(e.index),1)[0],r={};if(0===t.offset){var o=io(this.quill.getLine(e.index-1),1)[0];if(null!=o&&o.length()>1){var i=n.formats(),s=this.quill.getFormat(e.index-1,1);r=a().attributes.diff(i,s)||{}}}var l=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(t.prefix)?2:1;this.quill.deleteText(e.index-l,l,xt.sources.USER),Object.keys(r).length>0&&this.quill.formatLine(e.index-l,l,r,xt.sources.USER),this.quill.focus()}}function go(e,t){var n=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(t.suffix)?2:1;if(!(e.index>=this.quill.getLength()-n)){var r={},o=0,i=io(this.quill.getLine(e.index),1)[0];if(t.offset>=i.length()-1){var s=io(this.quill.getLine(e.index+1),1)[0];if(s){var l=i.formats(),c=this.quill.getFormat(e.index,1);r=a().attributes.diff(l,c)||{},o=s.length()}}this.quill.deleteText(e.index,n,xt.sources.USER),Object.keys(r).length>0&&this.quill.formatLine(e.index+o-1,n,r,xt.sources.USER)}}function vo(e){var t=this.quill.getLines(e),n={};if(t.length>1){var r=t[0].formats(),o=t[t.length-1].formats();n=a().attributes.diff(o,r)||{}}this.quill.deleteText(e,xt.sources.USER),Object.keys(n).length>0&&this.quill.formatLine(e.index,1,n,xt.sources.USER),this.quill.setSelection(e.index,xt.sources.SILENT),this.quill.focus()}function Co(t,n){var r=this;t.length>0&&this.quill.scroll.deleteAt(t.index,t.length);var o=Object.keys(n.format).reduce((function(t,r){return e.c.query(r,e.c.Scope.BLOCK)&&!Array.isArray(n.format[r])&&(t[r]=n.format[r]),t}),{});this.quill.insertText(t.index,"\n",o,xt.sources.USER),this.quill.setSelection(t.index+1,xt.sources.SILENT),this.quill.focus(),Object.keys(n.format).forEach((function(e){null==o[e]&&(Array.isArray(n.format[e])||"link"!==e&&r.quill.format(e,n.format[e],xt.sources.USER))}))}function To(t){return{key:mo.keys.TAB,shiftKey:!t,format:{"code-block":!0},handler:function(n){var r=e.c.query("code-block"),o=n.index,i=n.length,a=io(this.quill.scroll.descendant(r,o),2),s=a[0],l=a[1];if(null!=s){var c=this.quill.getIndex(s),p=s.newlineIndex(l,!0)+1,u=s.newlineIndex(c+l+i),d=s.domNode.textContent.slice(p,u).split("\n");l=0,d.forEach((function(e,n){t?(s.insertAt(p+l,r.TAB),l+=r.TAB.length,0===n?o+=r.TAB.length:i+=r.TAB.length):e.startsWith(r.TAB)&&(s.deleteAt(p+l,r.TAB.length),l-=r.TAB.length,0===n?o-=r.TAB.length:i-=r.TAB.length),l+=e.length+1})),this.quill.update(xt.sources.USER),this.quill.setSelection(o,i,xt.sources.SILENT)}}}}function Oo(e){return{key:e[0].toUpperCase(),shortKey:!0,handler:function(t,n){this.quill.format(e,!n.format[e],xt.sources.USER)}}}function xo(e){if("string"==typeof e||"number"==typeof e)return xo({key:e});if("object"===oo(e)&&(e=ve()(e,!1)),"string"==typeof e.key)if(null!=mo.keys[e.key.toUpperCase()])e.key=mo.keys[e.key.toUpperCase()];else{if(1!==e.key.length)return null;e.key=e.key.toUpperCase().charCodeAt(0)}return e.shortKey&&(e[ho]=e.shortKey,delete e.shortKey),e}mo.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},mo.DEFAULTS={bindings:{bold:Oo("bold"),italic:Oo("italic"),underline:Oo("underline"),indent:{key:mo.keys.TAB,format:["blockquote","indent","list"],handler:function(e,t){if(t.collapsed&&0!==t.offset)return!0;this.quill.format("indent","+1",xt.sources.USER)}},outdent:{key:mo.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(e,t){if(t.collapsed&&0!==t.offset)return!0;this.quill.format("indent","-1",xt.sources.USER)}},"outdent backspace":{key:mo.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(e,t){null!=t.format.indent?this.quill.format("indent","-1",xt.sources.USER):null!=t.format.list&&this.quill.format("list",!1,xt.sources.USER)}},"indent code-block":To(!0),"outdent code-block":To(!1),"remove tab":{key:mo.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(e){this.quill.deleteText(e.index-1,1,xt.sources.USER)}},tab:{key:mo.keys.TAB,handler:function(e){this.quill.history.cutoff();var t=(new(n())).retain(e.index).delete(e.length).insert("\t");this.quill.updateContents(t,xt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index+1,xt.sources.SILENT)}},"list empty enter":{key:mo.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(e,t){this.quill.format("list",!1,xt.sources.USER),t.format.indent&&this.quill.format("indent",!1,xt.sources.USER)}},"checklist enter":{key:mo.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(e){var t=io(this.quill.getLine(e.index),2),r=t[0],o=t[1],i=l()({},r.formats(),{list:"checked"}),a=(new(n())).retain(e.index).insert("\n",i).retain(r.length()-o-1).retain(1,{list:"unchecked"});this.quill.updateContents(a,xt.sources.USER),this.quill.setSelection(e.index+1,xt.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:mo.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(e,t){var r=io(this.quill.getLine(e.index),2),o=r[0],i=r[1],a=(new(n())).retain(e.index).insert("\n",t.format).retain(o.length()-i-1).retain(1,{header:null});this.quill.updateContents(a,xt.sources.USER),this.quill.setSelection(e.index+1,xt.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(e,t){var r,o=t.prefix.length,i=io(this.quill.getLine(e.index),2),a=i[0],s=i[1];if(s>o)return!0;switch(t.prefix.trim()){case"[]":case"[ ]":r="unchecked";break;case"[x]":r="checked";break;case"-":case"*":r="bullet";break;default:r="ordered"}this.quill.insertText(e.index," ",xt.sources.USER),this.quill.history.cutoff();var l=(new(n())).retain(e.index-s).delete(o+1).retain(a.length()-2-s).retain(1,{list:r});this.quill.updateContents(l,xt.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(e.index-o,xt.sources.SILENT)}},"code exit":{key:mo.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(e){var t=io(this.quill.getLine(e.index),2),r=t[0],o=t[1],i=(new(n())).retain(e.index+r.length()-o-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(i,xt.sources.USER)}},"embed left":yo(mo.keys.LEFT,!1),"embed left shift":yo(mo.keys.LEFT,!0),"embed right":yo(mo.keys.RIGHT,!1),"embed right shift":yo(mo.keys.RIGHT,!0)}};var So=function(e,t){return(So=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function ko(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}So(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;var Po,Eo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return ko(n,t),n.create=function(e){var n="disc"===e?"bullet":"ordered",r=t.create.call(this,n);return r.style.listStyleType=e,r},n.formats=function(e){var t;if(null===(t=e.style)||void 0===t?void 0:t.listStyleType)return e.style.listStyleType},n.prototype.optimize=function(e){_t.prototype.optimize.call(this,e);var t=this.next;null!=t&&t.prev===this&&t.statics.blotName===this.statics.blotName&&t.domNode.tagName===this.domNode.tagName&&t.domNode.style.listStyleType===this.domNode.style.listStyleType&&(t.moveChildren(this),t.remove())},n.blotName="list",n.scope=e.c.Scope.BLOCK_BLOT,n.tagName=["OL","UL"],n.defaultChild="list-item",n.allowedChildren=[Gn],n}(Yn),jo=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};!function(e){e[e.None=0]="None",e[e.Redux=1]="Redux",e[e.Comments=2]="Comments"}(Po||(Po={}));var Io=Boolean,wo=function e(t,n,r){var o=function(e,t,n){return new Error(e)}(t);return o.name="StructuredError",o.innerException=r,o.tag=n,Object.setPrototypeOf(o,Object.getPrototypeOf(this)),Error.captureStackTrace&&Error.captureStackTrace(o,e),o};function Ao(e){if(function(e,t){return!(!e||!(e instanceof wo||void 0!==e.isStructuredError))}(e))return e.stringify();if(e instanceof Error){var t=wo.enableUnknownMessageLogging&&e.message?" - ".concat(e.message):"";return"".concat(e.name).concat(t,":\n").concat(wo.enableStackLogging?(n=e.stack,void 0===r&&(r=0),n?n.split("\n").slice(1+r,2+r).join("\n"):"<unable to get stack>"):"")}var n,r;return wo.enableUnknownMessageLogging&&"string"==typeof e?e:"Unknown error"}function Ro(e){return(Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Do(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_o(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function No(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==Ro(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==Ro(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===Ro(o)?o:String(o)),r)}var o}function Mo(){return(Mo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=Bo(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}}).apply(this,arguments)}function Bo(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ho(e)););return e}function Lo(e,t){return(Lo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Fo(e,t){if(t&&("object"===Ro(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ho(e){return(Ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uo(e){return e instanceof q||e instanceof W}wo.enableStackLogging=!1,wo.enableMessageLogging=!1,wo.enableUnknownMessageLogging=!1,wo.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0},stringify:{value:function(){return e=this.tag,t=this.stack,void 0,n=this.innerException,[void 0,"Tag: ".concat(e),wo.enableStackLogging?t:void 0,n?"----------\nInner exception: ".concat(Ao(n)):void 0].filter(Io).join("\n");var e,t,n},enumerable:!1,writable:!0,configurable:!0},isStructuredError:{value:!0,enumerable:!1,writable:!1,configurable:!1}}),Object.setPrototypeOf?Object.setPrototypeOf(wo,Error):wo.__proto__=Error;var zo=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lo(e,t)}(s,t);var n,r,o,i,a=(o=s,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ho(o);if(i){var n=Ho(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Fo(this,e)});function s(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=a.call(this,e)).emitter=t.emitter,Array.isArray(t.whitelist)&&(n.whitelist=t.whitelist.reduce((function(e,t){return e[t]=!0,e}),{})),n.domNode.addEventListener("DOMNodeInserted",(function(){})),n.optimize(),n.enable(),n}return n=s,(r=[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(e,t){var n=Do(this.line(e),2),r=n[0],o=n[1],i=Do(this.line(e+t),1)[0];if(Mo(Ho(s.prototype),"deleteAt",this).call(this,e,t),null!=i&&r!==i&&o>0){if(r instanceof W||i instanceof W)return void this.optimize();if(r instanceof se){var a=r.newlineIndex(r.length(),!0);if(a>-1&&(r=r.split(a+1))===i)return void this.optimize()}else if(i instanceof se){var l=i.newlineIndex(0);l>-1&&i.split(l+1)}var c=i.children.head instanceof g?null:i.children.head;r.moveChildren(i,c),r.remove()}this.optimize()}},{key:"enable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.domNode.setAttribute("contenteditable",e)}},{key:"formatAt",value:function(e,t,n,r){(null==this.whitelist||this.whitelist[n])&&(Mo(Ho(s.prototype),"formatAt",this).call(this,e,t,n,r),this.optimize())}},{key:"insertAt",value:function(t,n,r){if(null==r||null==this.whitelist||this.whitelist[n]){if(t>=this.length())if(null==r||null==e.c.query(n,e.c.Scope.BLOCK)){var o=e.c.create(this.statics.defaultChild);this.appendChild(o),null==r&&n.endsWith("\n")&&(n=n.slice(0,-1)),o.insertAt(0,n,r)}else{var i=e.c.create(n,r);this.appendChild(i)}else Mo(Ho(s.prototype),"insertAt",this).call(this,t,n,r);this.optimize()}}},{key:"insertBefore",value:function(t,n){if(t.statics.scope===e.c.Scope.INLINE_BLOT){var r=e.c.create(this.statics.defaultChild);r.appendChild(t),t=r}Mo(Ho(s.prototype),"insertBefore",this).call(this,t,n)}},{key:"leaf",value:function(e){return this.path(e).pop()||[null,-1]}},{key:"line",value:function(e){return e===this.length()?this.line(e-1):this.descendant(Uo,e)}},{key:"lines",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE,r=function t(n,r,o){var i=[],a=o;return n.children.forEachAt(r,o,(function(n,r,o){Uo(n)?i.push(n):n instanceof e.c.Container&&(i=i.concat(t(n,r,a))),a-=o})),i};return r(this,t,n)}},{key:"optimize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!0!==this.batch&&(Mo(Ho(s.prototype),"optimize",this).call(this,e,t),e.length>0&&this.emitter.emit(qe.events.SCROLL_OPTIMIZE,e,t))}},{key:"path",value:function(e){return Mo(Ho(s.prototype),"path",this).call(this,e).slice(1)}},{key:"update",value:function(e){if(!0!==this.batch){var t=qe.sources.USER;"string"==typeof e&&(t=e),Array.isArray(e)||(e=this.observer.takeRecords()),e.length>0&&this.emitter.emit(qe.events.SCROLL_BEFORE_UPDATE,t,e),Mo(Ho(s.prototype),"update",this).call(this,e.concat([])),e.length>0&&this.emitter.emit(qe.events.SCROLL_UPDATE,t,e)}}}])&&No(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),s}(e.c.Scroll);zo.blotName="scroll",zo.className="ql-editor",zo.tagName="DIV",zo.defaultChild="block",zo.allowedChildren=[q,W,_t];var Ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ko(t,e),t.create=function(t){e.create.call(this,t)},t.prototype.deleteAt=function(t,n){var r;try{e.prototype.deleteAt.call(this,t,n)}catch(e){jo(null!==(r=null==e?void 0:e.message)&&void 0!==r?r:Ao(e))}},t.prototype.formatAt=function(t,n,r,o){var i;try{e.prototype.formatAt.call(this,t,n,r,o)}catch(e){jo(null!==(i=null==e?void 0:e.message)&&void 0!==i?i:Ao(e))}},t.prototype.update=function(t,n){var r;try{e.prototype.update.call(this,t,n)}catch(e){jo(null!==(r=null==e?void 0:e.message)&&void 0!==r?r:Ao(e))}},t}(zo);xt.register({"blots/block":q,"blots/block/embed":W,"blots/break":g,"blots/container":_t,"blots/cursor":be,"blots/embed":zt,"blots/inline":_,"blots/scroll":Ko,"blots/text":S,"formats/link":Mn,"formats/list":Eo,"formats/list/item":Gn,"formats/color":Xt,"formats/font":Cn,"formats/size":ar,"formats/background":Zt,"formats/bold":pn,"formats/italic":En,"formats/underline":Cr,"formats/strike":fr,"formats/script":ir,"modules/clipboard":zr,"modules/history":no,"modules/keyboard":mo}),e.c.register(q,g,be,_,Ko,S);const Vo=xt})(),o})(),e.exports=n()}).call(this,n(2122).Buffer)},2744:function(e,t,n){var r=n(1);function o(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},[r.createElement("rect",{id:"path-1",x:"2",y:"1",width:"270",height:"60",key:0}),r.createElement("filter",{x:"-1.3%",y:"-4.2%",width:"102.6%",height:"111.7%",filterUnits:"objectBoundingBox",id:"filter-2",key:1},[r.createElement("feOffset",{dx:"0",dy:"1",in:"SourceAlpha",result:"shadowOffsetOuter1",key:0}),r.createElement("feGaussianBlur",{stdDeviation:"1",in:"shadowOffsetOuter1",result:"shadowBlurOuter1",key:1}),r.createElement("feComposite",{in:"shadowBlurOuter1",in2:"SourceAlpha",operator:"out",result:"shadowBlurOuter1",key:2}),r.createElement("feColorMatrix",{values:"0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.1 0",type:"matrix",in:"shadowBlurOuter1",key:3})])]),r.createElement("g",{id:"Redlines",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",opacity:"0.718693388",key:1},r.createElement("g",{id:"GhostCard_52px"},[r.createElement("g",{id:"Rectangle-2",key:0},[r.createElement("use",{fill:"black",fillOpacity:"1",filter:"url(#filter-2)",xlinkHref:"#path-1",key:0}),r.createElement("use",{fill:"#FFFFFF",fillRule:"evenodd",xlinkHref:"#path-1",key:1}),r.createElement("rect",{stroke:"#EAEAEA",strokeWidth:"1",x:"2.5",y:"1.5",width:"269",height:"59",key:2})]),r.createElement("circle",{id:"Oval-8",fill:"#EAEAEA",cx:"27",cy:"28",r:"14",key:1}),r.createElement("rect",{id:"Rectangle1",fill:"#EAEAEA",x:"55",y:"16",width:"92",height:"11",rx:"5.5",key:2}),r.createElement("rect",{id:"Rectangle2",fill:"#EAEAEA",x:"55",y:"34",width:"204",height:"11",rx:"5.5",key:3})]))])}o.defaultProps={width:"274px",height:"52px",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 274 52",focusable:"false",version:"1.1"},e.exports=o,o.default=o},2979:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3);function o(e){return null==e?"9FA40DC1-775B-46F7-B124-3E10E131B835":e}function i(e,t,n){void 0===t&&(t=100);var i=new Map,a=0;return function(){for(var s,l,c=[],p=0;p<arguments.length;p++)c[p]=arguments[p];if(0===c.length){var u=e.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(c),!1));return u}a>t&&(i.clear(),a=0,null==n||n());var d=o(c[0]),f=null!==(s=i.get(d))&&void 0!==s?s:{nextArgMap:new Map};i.has(d)||i.set(d,f);for(var h=1;h<c.length;h++){var m=o(c[h]),y=null!==(l=f.nextArgMap.get(m))&&void 0!==l?l:{nextArgMap:new Map};f.nextArgMap.has(y)||f.nextArgMap.set(m,y),f=y}return void 0!==f.value||(a++,f.value={storedResult:e.apply(void 0,Object(r.__spreadArray)([],Object(r.__read)(c),!1))}),f.value.storedResult}}},568:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(3),o=n(1),i=n(518),a=n(798),s=n(351),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){return o.createElement(s.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:i.b}))},Object(r.__decorate)([Object(a.a)("PrimaryButton",["theme","styles"],!0)],t)}(o.Component)}}]);
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/sharedCommentsLazy.min.js.map/65db9d8fee70f9157a6a889fbf5cc74f/sharedCommentsLazy.min.js.map